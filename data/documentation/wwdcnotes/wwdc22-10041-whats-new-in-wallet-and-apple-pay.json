{"kind":"article","variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc22-10041-whats-new-in-wallet-and-apple-pay"]}],"schemaVersion":{"patch":0,"major":0,"minor":3},"sections":[],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22"]]},"sampleCodeDownload":{"kind":"sampleDownload","action":{"type":"reference","overridingTitle":"Watch Video (36 min)","identifier":"https:\/\/developer.apple.com\/wwdc22\/10041","isActive":true}},"metadata":{"roleHeading":"WWDC22","title":"What’s new in Wallet and Apple Pay","role":"sampleCode","modules":[{"name":"WWDC Notes"}]},"abstract":[{"text":"Discover the latest updates to Wallet & Apple Pay. We’ll show you how to support Orders in Wallet for your apps and websites and securely validate someone’s age and identity with the Identity Verification API. We’ll also explore PassKit support for SwiftUI, and discuss how you how you can improve your Apple Pay experience with Automatic Payments.","type":"text"}],"primaryContentSections":[{"kind":"content","content":[{"level":2,"type":"heading","anchor":"Updates","text":"Updates"},{"level":3,"type":"heading","anchor":"Tap-to-pay","text":"Tap to pay"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"from iOS 15.4"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"provides contactless payments support"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"includes Apple Pay, contactless credit and debit cards, and other digital wallets"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"the transaction is completed through a tap to the iPhone"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"no need for additional hardware or payment terminals"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":3,"type":"heading","anchor":"New-Apple-Pay-UX-in-macOS-Ventura","text":"New Apple Pay UX in macOS Ventura"},{"items":[{"content":[{"inlineContent":[{"text":"written in SwiftUI (shared codebase with iOS)","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":3,"type":"heading","anchor":"New-SwiftUI-APIs","text":"New SwiftUI APIs"},{"items":[{"content":[{"inlineContent":[{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/addpasstowalletbutton"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"text":"use ","type":"text"},{"code":".frame(...)","type":"codeVoice"},{"text":" for different sizes","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"supports styling via ","type":"text"},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/AddPassToWalletButtonStyle","isActive":true}]}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/paywithapplepaybutton","isActive":true,"type":"reference"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"use "},{"code":".frame(...)","type":"codeVoice"},{"type":"text","text":" for different sizes"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"supports styling via "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/PayWithApplePayButtonStyle"}]}]}]}]}],"type":"unorderedList"},{"level":2,"type":"heading","anchor":"Multi-merchant-payments","text":"Multi-merchant payments"},{"inlineContent":[{"type":"text","text":"Useful for things like online marketplaces, travel bookings, and ticketing services"}],"type":"paragraph"},{"syntax":"swift","code":["\/\/ Create a payment request","let paymentRequest = PKPaymentRequest()","\/\/ ...","","\/\/ Set total amount","paymentRequest.paymentSummaryItems = [","  PKPaymentSummaryItem(label: \"Total\", amount: 500)","]","","\/\/ Create a multi token context for each additional merchant in the payment","let multiTokenContexts = [","  PKPaymentTokenContext(","    merchantIdentifier: \"com.example.air-travel\",","    externalIdentifier: \"com.example.air-travel\",","    merchantName: \"Air Travel\",","    merchantDomain: \"air-travel.example.com\",","    amount: 150","  ),","  PKPaymentTokenContext(","    merchantIdentifier: \"com.example.hotel\",","    externalIdentifier: \"com.example.hotel\",","    merchantName: \"Hotel\",","    merchantDomain: \"hotel.example.com\",","    amount: 300","  ),","  PKPaymentTokenContext(","    merchantIdentifier: \"com.example.car-rental\",","    externalIdentifier: \"com.example.car-rental\",","    merchantName: \"Car Rental\",","    merchantDomain: \"car-rental.example.com\",","    amount: 50","  )","]","paymentRequest.multiTokenContexts = multiTokenContexts"],"type":"codeListing"},{"level":2,"type":"heading","anchor":"Automatic-payments-including-Subscriptions","text":"Automatic payments (including Subscriptions)"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"two types support:"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"recurring payments"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"automatic reload payments"}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"level":3,"type":"heading","anchor":"Recurring-payments","text":"Recurring payments"},{"items":[{"content":[{"inlineContent":[{"text":"subscriptions, installments, or recurring billing","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"fixed or variable amount charged on a regular schedule","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"end on a specific date or until canceled"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"trial or introductory period","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"syntax":"swift","code":["\/\/ Specify the amount and billing periods","let regularBilling = PKRecurringPaymentSummaryItem(label: \"Membership\", amount: 20)","","let trialBilling = PKRecurringPaymentSummaryItem(label: \"Trial Membership\", amount: 10)","","let trialEndDate = Calendar.current.date(byAdding: .month, value: 1, to: Date.now)","trialBilling.endDate = trialEndDate","regularBilling.startDate = trialEndDate","","\/\/ Create a recurring payment request","let recurringPaymentRequest = PKRecurringPaymentRequest(","  paymentDescription: \"Book Club Membership\",","  regularBilling: regularBilling,","  managementURL: URL(string: \"https:\/\/www.example.com\/managementURL\")!",")","recurringPaymentRequest.trialBilling = trialBilling","","recurringPaymentRequest.billingAgreement = \"\"\"","50% off for the first month. You will be charged $20 every month after that until you cancel. \\ You may cancel at any time to avoid future charges. To cancel, go to your Account and click \\ Cancel Membership.","\"\"\"","","recurringPaymentRequest.tokenNotificationURL = URL(","  string: \"https:\/\/www.example.com\/tokenNotificationURL\"",")!","","\/\/ Update the payment request","let paymentRequest = PKPaymentRequest()","\/\/ ...","paymentRequest.recurringPaymentRequest = recurringPaymentRequest","","\/\/ Include in the summary items","let total = PKRecurringPaymentSummaryItem(label: \"Book Club\", amount: 10)","total.endDate = trialEndDate","paymentRequest.paymentSummaryItems = [trialBilling, regularBilling, total]"],"type":"codeListing"},{"level":3,"type":"heading","anchor":"Automatic-reload-payments","text":"Automatic reload payments"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"e.g., store card balance top-ups, pre-paid accounts top-ups"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Fixed top-up amount payment"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Charged whenever account balance drops below a set threshold amount"}]}]}],"type":"unorderedList"},{"syntax":"swift","code":["\/\/ Specify the reload amount and threshold","let automaticReloadBilling = PKAutomaticReloadPaymentSummaryItem(","  label: \"Coffee Shop Reload\",","  amount: 25",")","reloadItem.thresholdAmount = 5","","\/\/ Create an automatic reload payment request","let automaticReloadPaymentRequest = PKAutomaticReloadPaymentRequest(","  paymentDescription: \"Coffee Shop\",","  automaticReloadBilling: automaticReloadBilling,","  managementURL: URL(string: \"https:\/\/www.example.com\/managementURL\")!",")","","automaticReloadPaymentRequest.billingAgreement = \"\"\"","Coffee Shop will add $25.00 to your card immediately, and will automatically reload your \\","card with $25.00 whenever the balance falls below $5.00. You may cancel at any time to avoid \\ future charges. To cancel, go to your Account and click Cancel Reload.","\"\"\"","","automaticReloadPaymentRequest.tokenNotificationURL = URL(","  string: \"https:\/\/www.example.com\/tokenNotificationURL\"",")!","","\/\/ Update the payment request","let paymentRequest = PKPaymentRequest()","\/\/ ...","paymentRequest.automaticReloadPaymentRequest = automaticReloadPaymentRequest","","\/\/ Include in the summary items","let total = PKAutomaticReloadPaymentSummaryItem(","  label: \"Coffee Shop\",","  amount: 25",")","total.thresholdAmount = 5","paymentRequest.paymentSummaryItems = [total]"],"type":"codeListing"},{"level":2,"type":"heading","anchor":"Identity-verification","text":"Identity verification"},{"inlineContent":[{"type":"text","text":"Refer to "},{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/wallet\/verifying_wallet_identity_requests"},{"type":"text","text":" and "},{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/wallet\/requesting_identity_data_from_a_wallet_pass"},{"type":"text","text":"."}],"type":"paragraph"},{"level":2,"type":"heading","anchor":"Written-By","text":"Written By"},{"columns":[{"size":1,"content":[{"inlineContent":[{"type":"image","identifier":"zntfdr"}],"type":"paragraph"}]},{"size":4,"content":[{"text":"Federico Zanetello","level":3,"anchor":"Federico-Zanetello","type":"heading"},{"inlineContent":[{"type":"reference","overridingTitle":"Contributed Notes","isActive":true,"overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/zntfdr"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"https:\/\/zntfdr.dev"}],"type":"paragraph"}]}],"numberOfColumns":5,"type":"row"},{"inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"type":"reference","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","isActive":true}],"type":"paragraph"},{"level":2,"type":"heading","anchor":"Related-Sessions","text":"Related Sessions"},{"items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10114-Whats-new-in-Wallet-and-Apple-Pay"],"style":"list","type":"links"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Legal Notice"}]}],"type":"small"},{"inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}],"type":"small"}]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-10041-Whats-new-in-Wallet-and-Apple-Pay"},"references":{"WWDC22-Icon.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDC22-Icon.png"}],"alt":null,"type":"image","identifier":"WWDC22-Icon.png"},"https://developer.apple.com/documentation/passkit/PayWithApplePayButtonStyle":{"title":"PayWithApplePayButtonStyle","titleInlineContent":[{"code":"PayWithApplePayButtonStyle","type":"codeVoice"}],"url":"https:\/\/developer.apple.com\/documentation\/passkit\/PayWithApplePayButtonStyle","type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/PayWithApplePayButtonStyle"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10114-Whats-new-in-Wallet-and-Apple-Pay":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10114-Whats-new-in-Wallet-and-Apple-Pay","title":"What’s new in Wallet and Apple Pay","url":"\/documentation\/wwdcnotes\/wwdc23-10114-whats-new-in-wallet-and-apple-pay","kind":"article","role":"sampleCode","type":"topic","abstract":[{"text":"Discover the latest updates to Wallet and Apple Pay. Learn how to take advantage of preauthorized payments, funds transfer, and Apple Pay Later merchandising to create great Apple Pay experiences in your app or for the web. Explore improved support for Mail, Messages, Safari, and third-party apps in Wallet Order Tracking, and find out how you can add more information to an order’s transaction or receipt details. And we’ll introduce you to Tap to Present ID on iPhone (or ID Verifier), a new way to accept IDs in Wallet using iPhone — no additional hardware needed.","type":"text"}]},"https://developer.apple.com/documentation/passkit/wallet/requesting_identity_data_from_a_wallet_pass":{"title":"Requesting identity data from a Wallet pass","titleInlineContent":[{"text":"Requesting identity data from a Wallet pass","type":"text"}],"url":"https:\/\/developer.apple.com\/documentation\/passkit\/wallet\/requesting_identity_data_from_a_wallet_pass","type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/wallet\/requesting_identity_data_from_a_wallet_pass"},"https://developer.apple.com/documentation/passkit/wallet/verifying_wallet_identity_requests":{"title":"Verifying Wallet identity requests","titleInlineContent":[{"text":"Verifying Wallet identity requests","type":"text"}],"url":"https:\/\/developer.apple.com\/documentation\/passkit\/wallet\/verifying_wallet_identity_requests","type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/wallet\/verifying_wallet_identity_requests"},"WWDCNotes.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"alt":null,"type":"image","identifier":"WWDCNotes.png"},"https://developer.apple.com/wwdc22/10041":{"checksum":null,"url":"https:\/\/developer.apple.com\/wwdc22\/10041","type":"download","identifier":"https:\/\/developer.apple.com\/wwdc22\/10041"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"title":"Contributions are welcome!","titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"link","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"doc://WWDCNotes/documentation/WWDCNotes":{"url":"\/documentation\/wwdcnotes","abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"title":"WWDC Notes","type":"topic","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"kind":"symbol","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","role":"collection"},"zntfdr.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}],"alt":null,"type":"image","identifier":"zntfdr.jpeg"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22","title":"WWDC22","images":[{"identifier":"WWDC22-Icon.png","type":"icon"},{"identifier":"WWDC22.jpeg","type":"card"}],"kind":"article","role":"collectionGroup","url":"\/documentation\/wwdcnotes\/wwdc22","type":"topic","abstract":[{"text":"Xcode 14, Swift 5.7, iOS 16, macOS 13 (Ventura), tvOS 16, watchOS 9.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"code":"WeatherKit","type":"codeVoice"},{"text":", ","type":"text"},{"code":"ScreenCaptureKit","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Swift Regex","type":"codeVoice"},{"text":", and more.","type":"text"}]},"https://github.com/zntfdr":{"title":"GitHub","titleInlineContent":[{"text":"GitHub","type":"text"}],"url":"https:\/\/github.com\/zntfdr","type":"link","identifier":"https:\/\/github.com\/zntfdr"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","kind":"article","url":"\/documentation\/wwdcnotes\/zntfdr","images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"role":"sampleCode","title":"Federico Zanetello (332 notes)","type":"topic","abstract":[{"type":"text","text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more."}]},"WWDC22.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDC22.jpeg"}],"alt":null,"type":"image","identifier":"WWDC22.jpeg"},"https://zntfdr.dev":{"title":"Blog","titleInlineContent":[{"text":"Blog","type":"text"}],"url":"https:\/\/zntfdr.dev","type":"link","identifier":"https:\/\/zntfdr.dev"},"zntfdr":{"variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}],"alt":"Profile image of Federico Zanetello","type":"image","identifier":"zntfdr"},"https://developer.apple.com/documentation/passkit/paywithapplepaybutton":{"title":"PayWithApplePayButton","titleInlineContent":[{"code":"PayWithApplePayButton","type":"codeVoice"}],"url":"https:\/\/developer.apple.com\/documentation\/passkit\/paywithapplepaybutton","type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/paywithapplepaybutton"},"https://developer.apple.com/documentation/passkit/AddPassToWalletButtonStyle":{"title":"AddPassToWalletButtonStyle","titleInlineContent":[{"code":"AddPassToWalletButtonStyle","type":"codeVoice"}],"url":"https:\/\/developer.apple.com\/documentation\/passkit\/AddPassToWalletButtonStyle","type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/AddPassToWalletButtonStyle"},"https://developer.apple.com/documentation/passkit/addpasstowalletbutton":{"title":"AddPassToWalletButton","titleInlineContent":[{"code":"AddPassToWalletButton","type":"codeVoice"}],"url":"https:\/\/developer.apple.com\/documentation\/passkit\/addpasstowalletbutton","type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/passkit\/addpasstowalletbutton"}}}