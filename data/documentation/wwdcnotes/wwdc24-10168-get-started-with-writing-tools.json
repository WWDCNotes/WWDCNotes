{"schemaVersion":{"major":0,"minor":3,"patch":0},"metadata":{"modules":[{"name":"WWDC Notes"}],"roleHeading":"WWDC24","title":"Get started with Writing Tools","role":"sampleCode"},"sections":[],"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC24-10168-Get-started-with-Writing-Tools","interfaceLanguage":"swift"},"abstract":[{"text":"Learn how Writing Tools help users proofread, rewrite, and transform text in your app. Get the details on how Writing Tools interact with your app so users can refine what they have written in any text view. Understand how text is retrieved and processed, and how to support Writing Tools in custom text views.","type":"text"}],"primaryContentSections":[{"kind":"content","content":[{"text":"Key takeaways","type":"heading","level":2,"anchor":"Key-takeaways"},{"inlineContent":[{"type":"text","text":"ðŸ“ Writing Tools helps users proofread, rewrite or transform text"}],"type":"paragraph"},{"inlineContent":[{"text":"ðŸ†“ If you use system text views Writing Tools comes for free","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"ðŸ’¥ Custom text views can also get Writing Tools","type":"text"}],"type":"paragraph"},{"text":"Presenters","type":"heading","level":2,"anchor":"Presenters"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Dongyuan Liu, Text Input & Internationalization","type":"text"}]}]}]},{"text":"Introducing Writing Tools","type":"heading","level":2,"anchor":"Introducing-Writing-Tools"},{"inlineContent":[{"text":"Helps users proofread, rewrite or transform text in text views in iOS, iPadOS and macOS.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"On iOS and iPadOS the tools appear on top of the keyboard when selecting a piece of text and in the callout bar next to cut, copy, and paste."}],"type":"paragraph"},{"inlineContent":[{"text":"On macOS the tools are available in the context menu and in the Edit menu.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Also works with non-editable text."}],"type":"paragraph"},{"text":"Transform possibilities","type":"heading","level":3,"anchor":"Transform-possibilities"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Summarize"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Key points"}]}]},{"content":[{"inlineContent":[{"text":"List","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Table","type":"text"}]}]}]},{"text":"Native text views","type":"heading","level":2,"anchor":"Native-text-views"},{"inlineContent":[{"type":"text","text":"Works with "},{"type":"codeVoice","code":"UITextField"},{"type":"text","text":", "},{"type":"codeVoice","code":"NSTextView"},{"type":"text","text":" and "},{"type":"codeVoice","code":"WKWebView"},{"type":"text","text":"."}],"type":"paragraph"},{"inlineContent":[{"code":"UITextField","type":"codeVoice"},{"type":"text","text":" and "},{"code":"NSTextView","type":"codeVoice"},{"type":"text","text":" has to use TextKit 2 to support the full Writing Tools experience."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"There are some new delegate methods for Writing Tools on "},{"type":"codeVoice","code":"UITextView"},{"type":"text","text":" and "},{"type":"codeVoice","code":"NSTextView"},{"type":"text","text":":"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["func textViewWritingToolsWillBegin(_ textView: UITextView) {","    \/\/ Take necessary steps to prepare. For example, disable iCloud sync.","}","","func textViewWritingToolsDidEnd(_ textView: UITextView) {","    \/\/ Take necessary steps to recover. For example, reenable iCloud sync.","}","","if !textView.isWritingToolsActive {","    \/\/ Do work that needs to be avoided when Writing Tools is interacting with text view","    \/\/ For example, in the textViewDidChange callback, app may want to avoid certain things","       when Writing Tools is active","}"]},{"text":"Controlling behavior","type":"heading","level":2,"anchor":"Controlling-behavior"},{"inlineContent":[{"type":"text","text":"It is possible to opt-out of the Writing Tools experience:"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["\/\/ Panel experience","textView.writingToolsBehavior = .limited","\/\/ Completely opt-out","textView.writingToolsBehavior = .none"]},{"inlineContent":[{"text":"With ","type":"text"},{"type":"codeVoice","code":"writingToolsAllowedInputOptions"},{"text":" you can specity if your text view supports rich text or tables. By default it assumes that your text view can render plain text and rich text, but not tables.","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["textView.writingToolsAllowedInputOptions = [.plainText]","textView.writingToolsAllowedInputOptions = [.plainText, .richText, .table]"]},{"inlineContent":[{"type":"text","text":"For "},{"code":"WKWebView","type":"codeVoice"},{"type":"text","text":", the "},{"code":"default","type":"codeVoice"},{"type":"text","text":" behavior is equivalent to "},{"code":".limited","type":"codeVoice"},{"type":"text","text":"."}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["extension WKWebViewConfiguration {","    @available(iOS 18.0, *)","    open var writingToolsBehavior: UIWritingToolsBehavior { get set }","}","","extension WKWebViewConfiguration {","    @available(macOS 15.0, *)","    open var writingToolsBehavior: NSWritingToolsBehavior { get set }","}","","extension WKWebView {","    \/\/\/ @discussion If the Writing Tools behavior on the configuration is `.limited`, this will always be `false`.","    @available(iOS 18.0, macOS 15.0, *)","    open var isWritingToolsActive: Bool { get }","}"]},{"text":"Protecting ranges","type":"heading","level":2,"anchor":"Protecting-ranges"},{"inlineContent":[{"text":"If you have code blocks or quoted content, you may not want Writing Tools to rewrite those ranges. There are delegate methods on ","type":"text"},{"code":"UITextViewDelegate","type":"codeVoice"},{"text":" and ","type":"text"},{"code":"NSTextViewDelegate","type":"codeVoice"},{"text":" to provide the protected ranges:","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["func textView(_ textView: UITextView, writingToolsIgnoredRangesIn","        enclosingRange: NSRange) -> [NSRange] {","    let text = textView.textStorage.attributedSubstring(from: enclosingRange)","    return rangesInappropriateForWritingTools(in: text)","}"]},{"inlineContent":[{"text":"For ","type":"text"},{"code":"WKWebView","type":"codeVoice"},{"text":" tags like <blockquote> and <pre> will be ignored.","type":"text"}],"type":"paragraph"},{"text":"Custom text views","type":"heading","level":2,"anchor":"Custom-text-views"},{"inlineContent":[{"text":"If you have custom text views other than ","type":"text"},{"code":"UITextView","type":"codeVoice"},{"text":" and ","type":"text"},{"code":"NSTextView","type":"codeVoice"},{"text":" you get the basic experience for free. The rewritten text is shown in the panel and can be copied or applied from there.","type":"text"}],"type":"paragraph"},{"text":"iOS and iPadOS","type":"heading","level":3,"anchor":"iOS-and-iPadOS"},{"inlineContent":[{"text":"You get the Writing Tools call out bar or context menu for free, if your custom text view adopts ","type":"text"},{"code":"UITextInteraction","type":"codeVoice"},{"text":". If you canâ€™t use ","type":"text"},{"code":"UITextInteraction","type":"codeVoice"},{"text":", you can also adopt ","type":"text"},{"code":"UITextSelectionDisplayInteraction","type":"codeVoice"},{"text":" with ","type":"text"},{"code":"UIEditMenuInteraction","type":"codeVoice"},{"text":".","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"The tools rely on yhe "},{"type":"codeVoice","code":"UITextInput"},{"type":"text","text":" protocol. For text view that donâ€™t use text interactions, a new optional property "},{"type":"codeVoice","code":"isEditable"},{"type":"text","text":" in "},{"type":"codeVoice","code":"UITextInput"},{"type":"text","text":" protocol is added. Adopt that to indicate if your text view supports editing."}],"type":"paragraph"},{"text":"macOS","type":"heading","level":3,"anchor":"macOS"},{"inlineContent":[{"type":"text","text":"Writing Tools will be shown automatically in the context menu and the Edit menu for custom text views."}],"type":"paragraph"},{"inlineContent":[{"text":"Make sure your text view adopts ","type":"text"},{"code":"NSServicesMenuRequestor","type":"codeVoice"},{"text":" to allow the system to read and write contents from\/back to the view.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Override ","type":"text"},{"code":"validRequestor(forSendType:returnType:)","type":"codeVoice"},{"text":" in ","type":"text"},{"code":"NSResponder","type":"codeVoice"},{"text":". Then, as long as a context menu is added to the view, the Writing Tools menu item will be there for free.","type":"text"}],"type":"paragraph"},{"syntax":"swift","type":"codeListing","code":["class CustomTextView: NSView, NSServicesMenuRequestor {","    override func validRequestor(forSendType sendType: NSPasteboard.PasteboardType?, ","                                 returnType: NSPasteboard.PasteboardType?) -> Any? {","        if sendType == .string || sendType == .rtf {","            return self","        }","        return super.validRequestor(forSendType: sendType, returnType: returnType)","    }","    ","    nonisolated func writeSelection(to pboard: NSPasteboard,","                                    types: [NSPasteboard.PasteboardType]) -> Bool {","        \/\/ Write plain text and\/or rich text to pasteboard","        return true","    }","","    \/\/ Implement readSelection(from pboard: NSPasteboard)","       as well for editable view","}"]},{"text":"Written By","type":"heading","level":2,"anchor":"Written-By"},{"type":"row","columns":[{"content":[{"inlineContent":[{"type":"image","identifier":"MortenGregersen"}],"type":"paragraph"}],"size":1},{"content":[{"text":"Morten Bjerg Gregersen","anchor":"Morten-Bjerg-Gregersen","type":"heading","level":3},{"inlineContent":[{"type":"reference","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/MortenGregersen","overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"isActive":true,"overridingTitle":"Contributed Notes"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","identifier":"https:\/\/github.com\/MortenGregersen","isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","identifier":"http:\/\/atterdagapps.com","isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","identifier":"https:\/\/x.com\/mortengregersen","isActive":true}],"type":"paragraph"}],"size":4}],"numberOfColumns":5},{"type":"thematicBreak"},{"inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"type":"reference","isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"}],"type":"paragraph"},{"text":"Related Sessions","type":"heading","level":2,"anchor":"Related-Sessions"},{"style":"list","type":"links","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-10090-Whats-new-in-TextKit-and-text-views","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10061-Meet-TextKit-2","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-224-Modernizing-Your-UI-for-iOS-13","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10058-Whats-new-with-text-and-text-interactions","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10054-Whats-new-in-AppKit"]},{"inlineContent":[{"inlineContent":[{"text":"Legal Notice","type":"text"}],"type":"strong"}],"type":"small"},{"inlineContent":[{"text":"All content copyright Â© 2012 â€“ 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}],"type":"small"}]}],"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc24-10168-get-started-with-writing-tools"],"traits":[{"interfaceLanguage":"swift"}]}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC24"]]},"sampleCodeDownload":{"kind":"sampleDownload","action":{"type":"reference","identifier":"https:\/\/developer.apple.com\/wwdc24\/10168","overridingTitle":"Watch Video","isActive":true}},"kind":"article","references":{"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-10090-Whats-new-in-TextKit-and-text-views":{"kind":"article","type":"topic","url":"\/documentation\/wwdcnotes\/wwdc22-10090-whats-new-in-textkit-and-text-views","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-10090-Whats-new-in-TextKit-and-text-views","title":"Whatâ€™s new in TextKit and text views","abstract":[{"text":"Discover the latest updates to TextKit and text views in UI frameworks. Explore layout refinements and API enhancements, learn how you can maintain compatibility across multiple OS versions, and find out how to modernize your app with TextKit 2.","type":"text"}],"role":"sampleCode"},"MortenGregersen":{"identifier":"MortenGregersen","alt":"Profile image of Morten Bjerg Gregersen","variants":[{"url":"\/images\/WWDCNotes\/MortenGregersen.jpeg","traits":["1x","light"]}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/MortenGregersen":{"url":"\/documentation\/wwdcnotes\/mortengregersen","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/MortenGregersen","kind":"article","role":"sampleCode","type":"topic","title":"Morten Bjerg Gregersen (21 notes)","abstract":[{"type":"text","text":"Hi ðŸ‘‹ I am Morten - I live in Denmark ðŸ‡©ðŸ‡°"}],"images":[{"type":"card","identifier":"MortenGregersen.jpeg"},{"type":"icon","identifier":"MortenGregersen.jpeg"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10061-Meet-TextKit-2":{"kind":"article","url":"\/documentation\/wwdcnotes\/wwdc21-10061-meet-textkit-2","title":"Meet TextKit 2","type":"topic","role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10061-Meet-TextKit-2","abstract":[{"type":"text","text":"Meet TextKit 2: Appleâ€™s next-generation text engine, redesigned for improved correctness, safety, and performance. Discover how TextKit 2 can help you provide a better text experience for international audiences, create more diverse layouts by mixing text content with visual content, and ensure smooth scrolling performance. Weâ€™ll introduce the latest APIs, dive into some practical examples, and provide guidance for modernizing your apps."}]},"MortenGregersen.jpeg":{"type":"image","alt":null,"identifier":"MortenGregersen.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/MortenGregersen.jpeg"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10054-Whats-new-in-AppKit":{"abstract":[{"text":"Explore the latest advancements in Mac app development with AppKit. Weâ€™ll show how you can enhance your appâ€™s design with new control features and SF Symbols 3, build powerful text experiences using TextKit 2, and harness the latest Swift features in your app.","type":"text"}],"role":"sampleCode","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10054-Whats-new-in-AppKit","title":"Whatâ€™s new in AppKit","kind":"article","url":"\/documentation\/wwdcnotes\/wwdc21-10054-whats-new-in-appkit"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-224-Modernizing-Your-UI-for-iOS-13":{"kind":"article","url":"\/documentation\/wwdcnotes\/wwdc19-224-modernizing-your-ui-for-ios-13","type":"topic","title":"Modernizing Your UI for iOS 13","abstract":[{"text":"iOS 13 combines powerful new multitasking and productivity technologies with a refreshed look and feel for all applications. Familiarize yourself with new requirements to keep your app ready for upcoming versions of iOS. Discover improvements to search fields and a totally new way to present UI. Learn how to adopt new gestures around selection, access peek and pop on all hardware, and how to renew your appâ€™s look for iOS 13.","type":"text"}],"role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-224-Modernizing-Your-UI-for-iOS-13"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"link","title":"Contributions are welcome!","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}]},"https://developer.apple.com/wwdc24/10168":{"identifier":"https:\/\/developer.apple.com\/wwdc24\/10168","type":"download","url":"https:\/\/developer.apple.com\/wwdc24\/10168","checksum":null},"doc://WWDCNotes/documentation/WWDCNotes/WWDC24":{"kind":"article","url":"\/documentation\/wwdcnotes\/wwdc24","role":"collectionGroup","abstract":[{"text":"Xcode 16, Swift 6, iOS 18, macOS 15 (Sequoia), tvOS 18, visionOS 2, watchOS 11.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: Swift Testing, ","type":"text"},{"type":"codeVoice","code":"FinanceKit"},{"text":", ","type":"text"},{"type":"codeVoice","code":"TabletopKit"},{"text":", and more.","type":"text"}],"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC24","title":"WWDC24","images":[{"type":"icon","identifier":"WWDC24-Icon.png"},{"type":"card","identifier":"WWDC24.jpeg"}]},"https://github.com/MortenGregersen":{"type":"link","titleInlineContent":[{"type":"text","text":"GitHub"}],"url":"https:\/\/github.com\/MortenGregersen","title":"GitHub","identifier":"https:\/\/github.com\/MortenGregersen"},"https://x.com/mortengregersen":{"title":"X\/Twitter","identifier":"https:\/\/x.com\/mortengregersen","titleInlineContent":[{"type":"text","text":"X\/Twitter"}],"type":"link","url":"https:\/\/x.com\/mortengregersen"},"http://atterdagapps.com":{"identifier":"http:\/\/atterdagapps.com","url":"http:\/\/atterdagapps.com","type":"link","title":"Blog","titleInlineContent":[{"type":"text","text":"Blog"}]},"WWDC24-Icon.png":{"type":"image","alt":null,"identifier":"WWDC24-Icon.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC24-Icon.png"}]},"doc://WWDCNotes/documentation/WWDCNotes":{"abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"url":"\/documentation\/wwdcnotes","title":"WWDC Notes","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","role":"collection","kind":"symbol","images":[{"type":"icon","identifier":"WWDCNotes.png"}]},"WWDC24.jpeg":{"identifier":"WWDC24.jpeg","alt":null,"variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC24.jpeg"}],"type":"image"},"WWDCNotes.png":{"identifier":"WWDCNotes.png","alt":null,"type":"image","variants":[{"url":"\/images\/WWDCNotes\/WWDCNotes.png","traits":["1x","light"]}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10058-Whats-new-with-text-and-text-interactions":{"title":"Whatâ€™s new with text and text interactions","role":"sampleCode","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10058-Whats-new-with-text-and-text-interactions","kind":"article","url":"\/documentation\/wwdcnotes\/wwdc23-10058-whats-new-with-text-and-text-interactions","abstract":[{"type":"text","text":"Text is an absolutely critical component of every app. Discover the latest features and enhancements for creating rich text experiences on Apple platforms. Weâ€™ll show you how to take advantage of common text elements and create entirely custom interactions for your app. Learn about updates to dictation, text loupe, and text selection, and explore improvements to text clipping, line wrapping, and hyphenation."}]}}}