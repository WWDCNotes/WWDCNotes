{"metadata":{"roleHeading":"WWDC19","role":"sampleCode","modules":[{"name":"WWDC Notes"}],"title":"Advances in macOS Security"},"primaryContentSections":[{"content":[{"level":2,"text":"Overview","type":"heading","anchor":"overview"},{"type":"paragraph","inlineContent":[{"text":"Defense in depth: there isn’t any single layer that can always perfectly protect you, so there are multiple layers of security, so if any single layer fails, that doesn’t defeat the whole security of the system. Layers can delay the advance of the attacker, reduce the attack surface, create “choke points” that are easier to defend.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Gatekeeper: designed to protect users from running malicious software, while allowing them to use the software they choose."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"What does Gatekeeper check:"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"does the app contain any known malicious content?"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"has the software been tampered with since it was signed?","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"does it meet the security policy configured on the computer?"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"first launch prompt ⭢ does the user actually want to run this?","type":"text"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"On Mojave, Gatekeeper runs the check on the 1st launch of quarantined software launched via Launch Services."}]},{"type":"paragraph","inlineContent":[{"text":"Quarantine - a technology on macOS for marking files that arrived from some external source (website, airdrop, iMessage, email)","type":"text"}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"includes metadata about where the file came from"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"opt-in - the app has to opt-in to this, so e.g. when apps download their own updates they are usually not quarantined, except for sandboxed apps"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"text":"Launch Services - a framework for finding and launching apps on macOS, used when launching apps from Finder, ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsworkspace"},{"text":", document handlers etc.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"What does "},{"inlineContent":[{"text":"not","type":"text"}],"type":"emphasis"},{"type":"text","text":" use Launch Services: "},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/nstask","type":"reference"},{"type":"text","text":", "},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/nsbundle","type":"reference"},{"type":"text","text":"\/"},{"code":"dlopen","type":"codeVoice"},{"type":"text","text":", "},{"code":"exec","type":"codeVoice"},{"type":"text","text":"\/"},{"code":"posix_spawn","type":"codeVoice"},{"type":"text","text":"."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In macOS Catalina:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"all new software must be notarized to pass Gatekeeper"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"all software is checked when first launched, even when launching through those non-LaunchServices methods","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"all software (even not quarantined) is checked for malicious content on every launch"}]}]}]},{"name":"Note","type":"aside","style":"note","content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"”","type":"text"},{"inlineContent":[{"type":"text","text":"You can always choose to run any software on your system"}],"type":"emphasis"},{"text":"”","type":"text"}],"type":"emphasis"},{"text":" - there will always be a way to run a specific piece of software that you want to run","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"emphasis","inlineContent":[{"text":"“We want to make macOS just as secure as iOS, while still maintaining the flexibility that you’ve come to expect from your Mac”","type":"text"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Platform security is increasingly reliant on validity of code signatures; that means if code has no signature, it’s impossible to detect tampering."}]},{"type":"paragraph","inlineContent":[{"text":"In a future version of macOS, unsigned code will not load by default, so:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"sign and notarize all software","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"don’t modify signed applications and bundles"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"handle failures when loading libraries","type":"text"}]}]}]},{"type":"heading","text":"Privacy changes:","anchor":"Privacy-changes","level":2},{"type":"paragraph","inlineContent":[{"text":"Requires user confirmation for:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"screen recording","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"keyboard input monitoring","type":"text"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"text":"Requires confirmation for access to:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Desktop, Documents, Downloads","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"iCloud Drive and third-party cloud storage"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Removable and network volumes"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"But:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"*not* required for creating new files, only for reading existing files","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"tries to understand intent, e.g. doesn’t ask if user double-clicked a file in Finder, or drag&dropped it, or used an open\/save panel","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"declare handled ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Reference\/InfoPlistKeyReference\/Articles\/CoreFoundationKeys.html#\/\/apple_ref\/doc\/uid\/20001431-101685"},{"text":" with ","type":"text"},{"type":"codeVoice","code":"NSIsRelatedItemType"},{"text":" to e.g. automatically have access to a subtitles file when opening a movie file","type":"text"}]}]}]},{"type":"paragraph","inlineContent":[{"text":"Purpose strings are accepted, but not required (","type":"text"},{"code":"NSDesktopFolderUsageDescription","type":"codeVoice"},{"text":" etc.).","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Open and save panels always run out of process. Be careful with:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsopensavepaneldelegate\/1524630-panel","type":"reference"}]}]},{"content":[{"inlineContent":[{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsopensavepaneldelegate\/1535141-panel","type":"reference"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsopensavepaneldelegate\/1527117-panel"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"text":"Checking for readability without triggering a consent dialog: ","type":"text"},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/filemanager\/1418292-isreadablefile","type":"reference"},{"text":", ","type":"text"},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/filemanager\/1416680-iswritablefile","type":"reference"},{"text":", ","type":"text"},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/library\/archive\/documentation\/System\/Conceptual\/ManPages_iPhoneOS\/man2\/access.2.html","type":"reference"},{"text":".","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Apps and other binaries that have previously been denied access to some kind of directory now appear automatically in the “Security & Privacy” access list, unchecked."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Full disk access now required for access to Trash (except files that your app has moved there)."}]},{"type":"heading","text":"Written By","anchor":"Written-By","level":2},{"type":"row","numberOfColumns":5,"columns":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"https:\/\/avatars.githubusercontent.com\/u\/28465?v=4","type":"image"}]}],"size":1},{"content":[{"anchor":"Kuba-Suder","type":"heading","level":3,"text":"Kuba Suder"},{"inlineContent":[{"type":"reference","isActive":true,"overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/mackuba","overridingTitle":"Contributed Notes"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/mackuba"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/x.com\/kuba_suder"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/mackuba.eu"}],"type":"paragraph"}],"size":4}]},{"type":"paragraph","inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"identifier":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","isActive":true,"type":"reference"}]},{"type":"heading","text":"Related Sessions","anchor":"Related-Sessions","level":2},{"type":"links","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-703-All-About-Notarization","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-709-Cryptography-and-Your-Apps"],"style":"list"},{"type":"small","inlineContent":[{"inlineContent":[{"type":"text","text":"Legal Notice"}],"type":"strong"}]},{"type":"small","inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}]}],"kind":"content"}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19"]]},"sections":[],"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc19-701-advances-in-macos-security"],"traits":[{"interfaceLanguage":"swift"}]}],"kind":"article","sampleCodeDownload":{"action":{"type":"reference","identifier":"https:\/\/developer.apple.com\/wwdc19\/701","isActive":true,"overridingTitle":"Watch Video (40 min)"},"kind":"sampleDownload"},"schemaVersion":{"minor":3,"major":0,"patch":0},"abstract":[{"text":"We are on a journey to continuously improve macOS security, with a particular focus on preventing malware and protecting user data. Join us on the next step and learn more about what’s new in Gatekeeper—for keeping malware out of macOS—as well as new protections that help keep users’ data and activity under their control.","type":"text"}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-701-Advances-in-macOS-Security"},"references":{"https://mackuba.eu":{"type":"link","url":"https:\/\/mackuba.eu","titleInlineContent":[{"text":"Blog","type":"text"}],"identifier":"https:\/\/mackuba.eu","title":"Blog"},"https://developer.apple.com/documentation/appkit/nsopensavepaneldelegate/1535141-panel":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/appkit\/nsopensavepaneldelegate\/1535141-panel","titleInlineContent":[{"code":"panel(_:validate:)","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsopensavepaneldelegate\/1535141-panel","title":"panel(_:validate:)"},"https://developer.apple.com/documentation/foundation/nstask":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/foundation\/nstask","titleInlineContent":[{"code":"NSTask","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/nstask","title":"NSTask"},"https://developer.apple.com/documentation/appkit/nsopensavepaneldelegate/1527117-panel":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/appkit\/nsopensavepaneldelegate\/1527117-panel","titleInlineContent":[{"code":"panel(_:didChangeToDirectoryURL:)","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsopensavepaneldelegate\/1527117-panel","title":"panel(_:didChangeToDirectoryURL:)"},"https://developer.apple.com/wwdc19/701":{"type":"download","url":"https:\/\/developer.apple.com\/wwdc19\/701","checksum":null,"identifier":"https:\/\/developer.apple.com\/wwdc19\/701"},"https://avatars.githubusercontent.com/u/28465?v=4":{"type":"image","alt":"Profile image of Kuba Suder","variants":[{"traits":["1x","light"],"url":"https:\/\/avatars.githubusercontent.com\/u\/28465?v=4"}],"identifier":"https:\/\/avatars.githubusercontent.com\/u\/28465?v=4"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19":{"type":"topic","url":"\/documentation\/wwdcnotes\/wwdc19","title":"WWDC19","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"role":"collectionGroup","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19","kind":"article","abstract":[{"type":"text","text":"Xcode 11, Swift 5.1, iOS 13, macOS 10.15 (Catalina), tvOS 13, watchOS 6."},{"type":"text","text":" "},{"type":"text","text":"New APIs: "},{"type":"codeVoice","code":"Combine"},{"type":"text","text":", "},{"type":"codeVoice","code":"Core Haptics"},{"type":"text","text":", "},{"type":"codeVoice","code":"Create ML"},{"type":"text","text":", and more."}]},"https://developer.apple.com/library/archive/documentation/General/Reference/InfoPlistKeyReference/Articles/CoreFoundationKeys.html#//apple_ref/doc/uid/20001431-101685":{"type":"link","url":"https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Reference\/InfoPlistKeyReference\/Articles\/CoreFoundationKeys.html#\/\/apple_ref\/doc\/uid\/20001431-101685","titleInlineContent":[{"code":"CFBundleDocumentTypes","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/library\/archive\/documentation\/General\/Reference\/InfoPlistKeyReference\/Articles\/CoreFoundationKeys.html#\/\/apple_ref\/doc\/uid\/20001431-101685","title":"CFBundleDocumentTypes"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-703-All-About-Notarization":{"kind":"article","role":"sampleCode","title":"All About Notarization","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-703-All-About-Notarization","url":"\/documentation\/wwdcnotes\/wwdc19-703-all-about-notarization","abstract":[{"text":"Notarization is all about identifying and blocking malicious Mac software prior to distribution, without requiring App Review or the Mac App Store.  Introduced last year and already widely adopted by Mac app developers, this is your opportunity to take an in depth tour of Notarization workflows and find out what’s new with the Notarization service.","type":"text"}]},"doc://WWDCNotes/documentation/WWDCNotes":{"kind":"symbol","title":"WWDC Notes","url":"\/documentation\/wwdcnotes","type":"topic","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"images":[{"identifier":"WWDCNotes.png","type":"icon"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","role":"collection"},"https://github.com/mackuba":{"type":"link","url":"https:\/\/github.com\/mackuba","titleInlineContent":[{"text":"GitHub","type":"text"}],"identifier":"https:\/\/github.com\/mackuba","title":"GitHub"},"https://developer.apple.com/documentation/appkit/nsopensavepaneldelegate/1524630-panel":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/appkit\/nsopensavepaneldelegate\/1524630-panel","titleInlineContent":[{"code":"panel(_:userEnteredFilename:confirmed:)","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsopensavepaneldelegate\/1524630-panel","title":"panel(_:userEnteredFilename:confirmed:)"},"https://developer.apple.com/documentation/foundation/nsbundle":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/foundation\/nsbundle","titleInlineContent":[{"code":"NSBundle","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/nsbundle","title":"NSBundle"},"https://developer.apple.com/documentation/foundation/filemanager/1418292-isreadablefile":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/foundation\/filemanager\/1418292-isreadablefile","titleInlineContent":[{"code":"isReadableFile","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/filemanager\/1418292-isreadablefile","title":"isReadableFile"},"doc://WWDCNotes/documentation/WWDCNotes/mackuba":{"role":"sampleCode","url":"\/documentation\/wwdcnotes\/mackuba","title":"Kuba Suder (16 notes)","type":"topic","abstract":[{"text":"Independent Mac & iOS developer. Sometimes freelancing, mostly working on my own stuff these days.","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/mackuba","kind":"article"},"https://developer.apple.com/library/archive/documentation/System/Conceptual/ManPages_iPhoneOS/man2/access.2.html":{"type":"link","url":"https:\/\/developer.apple.com\/library\/archive\/documentation\/System\/Conceptual\/ManPages_iPhoneOS\/man2\/access.2.html","titleInlineContent":[{"code":"access()","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/library\/archive\/documentation\/System\/Conceptual\/ManPages_iPhoneOS\/man2\/access.2.html","title":"access()"},"WWDCNotes.png":{"type":"image","alt":null,"variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"identifier":"WWDCNotes.png"},"https://wwdcnotes.github.io/WWDCNotes/documentation/wwdcnotes/contributing":{"type":"link","url":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"identifier":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!"},"https://developer.apple.com/documentation/appkit/nsworkspace":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/appkit\/nsworkspace","titleInlineContent":[{"code":"NSWorkspace","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsworkspace","title":"NSWorkspace"},"https://x.com/kuba_suder":{"type":"link","url":"https:\/\/x.com\/kuba_suder","titleInlineContent":[{"text":"X\/Twitter","type":"text"}],"identifier":"https:\/\/x.com\/kuba_suder","title":"X\/Twitter"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-709-Cryptography-and-Your-Apps":{"url":"\/documentation\/wwdcnotes\/wwdc19-709-cryptography-and-your-apps","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-709-Cryptography-and-Your-Apps","type":"topic","abstract":[{"type":"text","text":"System frameworks encrypt both data at rest and data in transit in a transparent way for you. This functionality is available by simply setting an attribute. However you may want to do more to protect your users’ data. CryptoKit is a new Swift framework that makes it easier and safer than ever to perform cryptographic operations, whether you simply need to compute a hash or are implementing a more advanced authentication protocol."}],"kind":"article","title":"Cryptography and Your Apps","role":"sampleCode"},"https://developer.apple.com/documentation/foundation/filemanager/1416680-iswritablefile":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/foundation\/filemanager\/1416680-iswritablefile","titleInlineContent":[{"code":"isWritableFile","type":"codeVoice"}],"identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/filemanager\/1416680-iswritablefile","title":"isWritableFile"}}}