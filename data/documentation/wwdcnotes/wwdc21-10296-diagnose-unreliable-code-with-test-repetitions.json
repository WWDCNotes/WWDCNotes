{"metadata":{"modules":[{"name":"WWDC Notes"}],"roleHeading":"WWDC21","role":"sampleCode","title":"Diagnose unreliable code with test repetitions"},"abstract":[{"text":"Test repetitions can help you debug even the most unreliable code. Discover how you can use the maximum repetitions, until failure, and retry on failure testing modes within test plans, Xcode, and xcodebuild to track down bugs and crashers and make your app more stable for everyone.","type":"text"}],"sampleCodeDownload":{"action":{"identifier":"https:\/\/developer.apple.com\/wwdc21\/10296","isActive":true,"type":"reference","overridingTitle":"Watch Video (9 min)"},"kind":"sampleDownload"},"primaryContentSections":[{"kind":"content","content":[{"level":2,"type":"heading","text":"Test repetitions","anchor":"Test-repetitions"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"new in Xcode 13","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"allow you to repeat a test up to a specified number of iterations with a stopping condition"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"text":"Three test repetition modes:","type":"text"}]},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Fixed iterations"}]}]}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"will repeat your tests a fixed number of times regardless of the outcome status"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"great for understanding the reliability of your test suite and helping keep it reliable as new tests are introduced over time"}],"type":"paragraph"}]}]},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Until failure"}],"type":"paragraph"}]}],"start":2},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"will repeat a test until it fails","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"useful to reproduce a nondeterministic test failure to catch it in the debugger"}]}]}]},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Retry on failure"}]}]}],"start":3},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"will retry your test until it succeeds up to a specified maximum"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"useful to identify unreliable tests which fail initially but eventually succeed on reattempt"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"text":"To enable, either:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"specify the mode within a test plan"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"control+click on a test diamond in your test file and choose the menu "},{"type":"text","text":"Run “test…()” Repeatedly…"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"on the terminal","type":"text"}],"type":"paragraph"}]}]},{"type":"codeListing","syntax":"shell","code":["xcodebuild test -project ....xcodeproj -scheme ... -destination '...' -test-iterations 100 -run-tests-until-failure"]},{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"code":"xcodebuild","type":"codeVoice"},{"text":" test repetition flags are:","type":"text"}]},{"type":"codeListing","syntax":"shell","code":["-test-iterations <number>","-retry-tests-on-failure","-run-tests-until-failure"]},{"level":2,"type":"heading","text":"Written By","anchor":"Written-By"},{"columns":[{"content":[{"inlineContent":[{"type":"image","identifier":"zntfdr"}],"type":"paragraph"}],"size":1},{"content":[{"level":3,"text":"Federico Zanetello","anchor":"Federico-Zanetello","type":"heading"},{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","type":"reference","overridingTitle":"Contributed Notes","overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/github.com\/zntfdr","type":"reference","isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/zntfdr.dev","type":"reference","isActive":true}]}],"size":4}],"type":"row","numberOfColumns":5},{"type":"thematicBreak"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"type":"reference","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","isActive":true}]},{"level":2,"type":"heading","text":"Related Sessions","anchor":"Related-Sessions"},{"type":"links","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110361-Author-fast-and-reliable-tests-for-Xcode-Cloud","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10132-Meet-asyncawait-in-Swift","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10207-Embrace-Expected-Failures-in-XCTest","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10208-Explore-Digital-Crown-Trackpad-and-iPad-pointer-automation"],"style":"list"},{"type":"small","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Legal Notice"}]}]},{"type":"small","inlineContent":[{"text":"All content copyright © 2012 – 2025 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}]}]}],"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10296-Diagnose-unreliable-code-with-test-repetitions","interfaceLanguage":"swift"},"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc21-10296-diagnose-unreliable-code-with-test-repetitions"],"traits":[{"interfaceLanguage":"swift"}]}],"sections":[],"kind":"article","schemaVersion":{"major":0,"minor":3,"patch":0},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21"]]},"references":{"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10208-Explore-Digital-Crown-Trackpad-and-iPad-pointer-automation":{"title":"Explore Digital Crown, Trackpad, and iPad pointer automation","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10208-Explore-Digital-Crown-Trackpad-and-iPad-pointer-automation","kind":"article","abstract":[{"text":"Learn how you can interact with devices in UI Tests in Xcode 13. Discover newly-automatable input methods including iPadOS pointer, watchOS Digital Crown, and enhanced macOS trackpad scrolling APIs.","type":"text"}],"role":"sampleCode","url":"\/documentation\/wwdcnotes\/wwdc21-10208-explore-digital-crown-trackpad-and-ipad-pointer-automation","type":"topic"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21":{"type":"topic","images":[{"type":"icon","identifier":"WWDC21-Icon.png"},{"type":"card","identifier":"WWDC21.jpeg"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21","role":"collectionGroup","abstract":[{"type":"text","text":"Xcode 13, Swift 5.5, iOS 15, macOS 12 (Monterey), tvOS 15, watchOS 8."},{"type":"text","text":" "},{"type":"text","text":"New APIs: "},{"code":"MusicKit","type":"codeVoice"},{"type":"text","text":", "},{"code":"DocC","type":"codeVoice"},{"text":", ","type":"text"},{"type":"codeVoice","code":"StoreKit 2"},{"text":", and more.","type":"text"}],"title":"WWDC21","url":"\/documentation\/wwdcnotes\/wwdc21","kind":"article"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}],"url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"link","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10132-Meet-asyncawait-in-Swift":{"title":"Meet async\/await in Swift","type":"topic","role":"sampleCode","kind":"article","url":"\/documentation\/wwdcnotes\/wwdc21-10132-meet-asyncawait-in-swift","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10132-Meet-asyncawait-in-Swift","abstract":[{"text":"Swift now supports asynchronous functions — a pattern commonly known as async\/await. Discover how the new syntax can make your code easier to read and understand. Learn what happens when a function suspends, and find out how to adapt existing completion handlers to asynchronous functions.","type":"text"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-110361-Author-fast-and-reliable-tests-for-Xcode-Cloud":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110361-Author-fast-and-reliable-tests-for-Xcode-Cloud","type":"topic","role":"sampleCode","url":"\/documentation\/wwdcnotes\/wwdc22-110361-author-fast-and-reliable-tests-for-xcode-cloud","title":"Author fast and reliable tests for Xcode Cloud","abstract":[{"text":"Discover how you can create effective testing plans for Xcode Cloud, Apple’s continuous integration and continuous delivery service. We’ll show you how testing can be an essential tool to consistently verify your code works correctly. Learn how you can author fast, reliable, and efficient tests for Xcode Cloud, avoid irrelevant failures, and verify your code changes quickly.","type":"text"}],"kind":"article"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"title":"Federico Zanetello (332 notes)","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","abstract":[{"type":"text","text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more."}],"kind":"article","role":"sampleCode","url":"\/documentation\/wwdcnotes\/zntfdr","type":"topic"},"WWDC21-Icon.png":{"identifier":"WWDC21-Icon.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC21-Icon.png"}],"type":"image","alt":null},"WWDCNotes.png":{"variants":[{"url":"\/images\/WWDCNotes\/WWDCNotes.png","traits":["1x","light"]}],"type":"image","identifier":"WWDCNotes.png","alt":null},"doc://WWDCNotes/documentation/WWDCNotes":{"kind":"symbol","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"title":"WWDC Notes","role":"collection","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","type":"topic","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"url":"\/documentation\/wwdcnotes"},"https://developer.apple.com/wwdc21/10296":{"checksum":null,"url":"https:\/\/developer.apple.com\/wwdc21\/10296","type":"download","identifier":"https:\/\/developer.apple.com\/wwdc21\/10296"},"WWDC21.jpeg":{"identifier":"WWDC21.jpeg","variants":[{"url":"\/images\/WWDCNotes\/WWDC21.jpeg","traits":["1x","light"]}],"type":"image","alt":null},"https://github.com/zntfdr":{"titleInlineContent":[{"text":"GitHub","type":"text"}],"url":"https:\/\/github.com\/zntfdr","type":"link","identifier":"https:\/\/github.com\/zntfdr","title":"GitHub"},"zntfdr.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/zntfdr.jpeg"}],"type":"image","identifier":"zntfdr.jpeg","alt":null},"zntfdr":{"identifier":"zntfdr","variants":[{"url":"\/images\/WWDCNotes\/zntfdr.jpeg","traits":["1x","light"]}],"type":"image","alt":"Profile image of Federico Zanetello"},"https://zntfdr.dev":{"titleInlineContent":[{"text":"Blog","type":"text"}],"url":"https:\/\/zntfdr.dev","type":"link","identifier":"https:\/\/zntfdr.dev","title":"Blog"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10207-Embrace-Expected-Failures-in-XCTest":{"kind":"article","abstract":[{"type":"text","text":"Testing is a crucial part of building a great app: Great tests can help you track down important issues before release, improve your workflow, and provide a quality experience upon release. For issues that can’t be immediately resolved, however, XCTest can help provide better context around those problems with XCTExpectFailure. Learn how this API works, its strict behavior, and how to improve the signal-to-noise ratio in your tests to identify new issues more efficiently."}],"title":"Embrace Expected Failures in XCTest","type":"topic","url":"\/documentation\/wwdcnotes\/wwdc21-10207-embrace-expected-failures-in-xctest","role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10207-Embrace-Expected-Failures-in-XCTest"}}}