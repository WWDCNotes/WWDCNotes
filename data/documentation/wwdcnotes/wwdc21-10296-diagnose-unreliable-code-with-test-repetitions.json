{"metadata":{"role":"sampleCode","roleHeading":"WWDC21","title":"Diagnose unreliable code with test repetitions","modules":[{"name":"WWDC Notes"}]},"sections":[],"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10296-Diagnose-unreliable-code-with-test-repetitions","interfaceLanguage":"swift"},"sampleCodeDownload":{"kind":"sampleDownload","action":{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/wwdc21\/10296","overridingTitle":"Watch Video (9 min)"}},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21"]]},"kind":"article","abstract":[{"text":"Test repetitions can help you debug even the most unreliable code. Discover how you can use the maximum repetitions, until failure, and retry on failure testing modes within test plans, Xcode, and xcodebuild to track down bugs and crashers and make your app more stable for everyone.","type":"text"}],"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc21-10296-diagnose-unreliable-code-with-test-repetitions"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"kind":"content","content":[{"type":"heading","text":"Test repetitions","level":2,"anchor":"Test-repetitions"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"new in Xcode 13"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"allow you to repeat a test up to a specified number of iterations with a stopping condition"}]}]}]},{"inlineContent":[{"type":"text","text":"Three test repetition modes:"}],"type":"paragraph"},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"text":"Fixed iterations","type":"text"}],"type":"paragraph"}]}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"will repeat your tests a fixed number of times regardless of the outcome status"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"great for understanding the reliability of your test suite and helping keep it reliable as new tests are introduced over time"}],"type":"paragraph"}]}]},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Until failure"}]}]}],"start":2},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"will repeat a test until it fails"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"useful to reproduce a nondeterministic test failure to catch it in the debugger"}]}]}]},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Retry on failure"}],"type":"paragraph"}]}],"start":3},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"will retry your test until it succeeds up to a specified maximum","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"useful to identify unreliable tests which fail initially but eventually succeed on reattempt"}]}]}]},{"inlineContent":[{"type":"text","text":"To enable, either:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"specify the mode within a test plan","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"control+click on a test diamond in your test file and choose the menu ","type":"text"},{"text":"Run “test…()” Repeatedly…","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"on the terminal","type":"text"}],"type":"paragraph"}]}]},{"code":["xcodebuild test -project ....xcodeproj -scheme ... -destination '...' -test-iterations 100 -run-tests-until-failure"],"type":"codeListing","syntax":"shell"},{"inlineContent":[{"text":"The ","type":"text"},{"code":"xcodebuild","type":"codeVoice"},{"text":" test repetition flags are:","type":"text"}],"type":"paragraph"},{"code":["-test-iterations <number>","-retry-tests-on-failure","-run-tests-until-failure"],"type":"codeListing","syntax":"shell"},{"level":2,"type":"heading","text":"Written By","anchor":"Written-By"},{"columns":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"zntfdr","type":"image"}]}],"size":1},{"content":[{"level":3,"text":"Federico Zanetello","type":"heading","anchor":"Federico-Zanetello"},{"inlineContent":[{"isActive":true,"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"type":"reference","overridingTitle":"Contributed Notes"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"isActive":true,"identifier":"https:\/\/github.com\/zntfdr","type":"reference"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"isActive":true,"identifier":"https:\/\/zntfdr.dev","type":"reference"}],"type":"paragraph"}],"size":4}],"numberOfColumns":5,"type":"row"},{"inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"type":"reference","identifier":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","isActive":true}],"type":"paragraph"},{"level":2,"type":"heading","text":"Related Sessions","anchor":"Related-Sessions"},{"style":"list","type":"links","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110361-Author-fast-and-reliable-tests-for-Xcode-Cloud","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10132-Meet-asyncawait-in-Swift","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10207-Embrace-Expected-Failures-in-XCTest","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10208-Explore-Digital-Crown-Trackpad-and-iPad-pointer-automation"]},{"inlineContent":[{"inlineContent":[{"text":"Legal Notice","type":"text"}],"type":"strong"}],"type":"small"},{"inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}],"type":"small"}]}],"schemaVersion":{"minor":3,"patch":0,"major":0},"references":{"WWDC21-Icon.png":{"type":"image","identifier":"WWDC21-Icon.png","alt":null,"variants":[{"url":"\/images\/WWDC21-Icon.png","traits":["1x","light"]}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-110361-Author-fast-and-reliable-tests-for-Xcode-Cloud":{"kind":"article","type":"topic","title":"Author fast and reliable tests for Xcode Cloud","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110361-Author-fast-and-reliable-tests-for-Xcode-Cloud","url":"\/documentation\/wwdcnotes\/wwdc22-110361-author-fast-and-reliable-tests-for-xcode-cloud","abstract":[{"type":"text","text":"Discover how you can create effective testing plans for Xcode Cloud, Apple’s continuous integration and continuous delivery service. We’ll show you how testing can be an essential tool to consistently verify your code works correctly. Learn how you can author fast, reliable, and efficient tests for Xcode Cloud, avoid irrelevant failures, and verify your code changes quickly."}],"role":"sampleCode"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10132-Meet-asyncawait-in-Swift":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10132-Meet-asyncawait-in-Swift","type":"topic","title":"Meet async\/await in Swift","url":"\/documentation\/wwdcnotes\/wwdc21-10132-meet-asyncawait-in-swift","abstract":[{"type":"text","text":"Swift now supports asynchronous functions — a pattern commonly known as async\/await. Discover how the new syntax can make your code easier to read and understand. Learn what happens when a function suspends, and find out how to adapt existing completion handlers to asynchronous functions."}],"role":"sampleCode","kind":"article"},"https://zntfdr.dev":{"type":"link","title":"Blog","url":"https:\/\/zntfdr.dev","identifier":"https:\/\/zntfdr.dev","titleInlineContent":[{"text":"Blog","type":"text"}]},"doc://WWDCNotes/documentation/WWDCNotes":{"type":"topic","title":"WWDC Notes","images":[{"identifier":"WWDCNotes.png","type":"icon"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"kind":"symbol","url":"\/documentation\/wwdcnotes","role":"collection"},"WWDCNotes.png":{"type":"image","identifier":"WWDCNotes.png","alt":null,"variants":[{"url":"\/images\/WWDCNotes.png","traits":["1x","light"]}]},"https://wwdcnotes.github.io/WWDCNotes/documentation/wwdcnotes/contributing":{"type":"link","title":"Contributions are welcome!","url":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","identifier":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}]},"https://github.com/zntfdr":{"type":"link","title":"GitHub","url":"https:\/\/github.com\/zntfdr","identifier":"https:\/\/github.com\/zntfdr","titleInlineContent":[{"text":"GitHub","type":"text"}]},"zntfdr.jpeg":{"type":"image","identifier":"zntfdr.jpeg","alt":null,"variants":[{"url":"\/images\/zntfdr.jpeg","traits":["1x","light"]}]},"zntfdr":{"type":"image","identifier":"zntfdr","alt":"Profile image of Federico Zanetello","variants":[{"url":"\/images\/zntfdr.jpeg","traits":["1x","light"]}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21":{"type":"topic","role":"collectionGroup","title":"WWDC21","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21","url":"\/documentation\/wwdcnotes\/wwdc21","abstract":[{"type":"text","text":"Xcode 13, Swift 5.5, iOS 15, macOS 12 (Monterey), tvOS 15, watchOS 8."},{"type":"text","text":" "},{"type":"text","text":"New APIs: "},{"type":"codeVoice","code":"MusicKit"},{"type":"text","text":", "},{"type":"codeVoice","code":"DocC"},{"type":"text","text":", "},{"type":"codeVoice","code":"StoreKit 2"},{"type":"text","text":", and more."}],"images":[{"type":"icon","identifier":"WWDC21-Icon.png"},{"type":"card","identifier":"WWDC21.jpeg"}],"kind":"article"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10208-Explore-Digital-Crown-Trackpad-and-iPad-pointer-automation":{"url":"\/documentation\/wwdcnotes\/wwdc21-10208-explore-digital-crown-trackpad-and-ipad-pointer-automation","role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10208-Explore-Digital-Crown-Trackpad-and-iPad-pointer-automation","type":"topic","kind":"article","abstract":[{"type":"text","text":"Learn how you can interact with devices in UI Tests in Xcode 13. Discover newly-automatable input methods including iPadOS pointer, watchOS Digital Crown, and enhanced macOS trackpad scrolling APIs."}],"title":"Explore Digital Crown, Trackpad, and iPad pointer automation"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"type":"topic","role":"sampleCode","title":"Federico Zanetello (332 notes)","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","url":"\/documentation\/wwdcnotes\/zntfdr","abstract":[{"text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more.","type":"text"}],"images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"kind":"article"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10207-Embrace-Expected-Failures-in-XCTest":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10207-Embrace-Expected-Failures-in-XCTest","url":"\/documentation\/wwdcnotes\/wwdc21-10207-embrace-expected-failures-in-xctest","type":"topic","kind":"article","role":"sampleCode","title":"Embrace Expected Failures in XCTest","abstract":[{"type":"text","text":"Testing is a crucial part of building a great app: Great tests can help you track down important issues before release, improve your workflow, and provide a quality experience upon release. For issues that can’t be immediately resolved, however, XCTest can help provide better context around those problems with XCTExpectFailure. Learn how this API works, its strict behavior, and how to improve the signal-to-noise ratio in your tests to identify new issues more efficiently."}]},"https://developer.apple.com/wwdc21/10296":{"type":"download","url":"https:\/\/developer.apple.com\/wwdc21\/10296","identifier":"https:\/\/developer.apple.com\/wwdc21\/10296","checksum":null},"WWDC21.jpeg":{"type":"image","identifier":"WWDC21.jpeg","alt":null,"variants":[{"url":"\/images\/WWDC21.jpeg","traits":["1x","light"]}]}}}