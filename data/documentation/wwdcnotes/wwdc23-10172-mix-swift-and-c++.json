{"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10172-Mix-Swift-and-C++","interfaceLanguage":"swift"},"schemaVersion":{"patch":0,"minor":3,"major":0},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23"]]},"sampleCodeDownload":{"action":{"identifier":"https:\/\/developer.apple.com\/wwdc23\/10172","overridingTitle":"Watch Video (17 min)","isActive":true,"type":"reference"},"kind":"sampleDownload"},"abstract":[{"text":"Learn how you can use Swift in your C++ and Objective-C++ projects to make your code safer, faster, and easier to develop. We’ll show you how to use C++ and Swift APIs to incrementally incorporate Swift into your app.","type":"text"}],"sections":[],"kind":"article","primaryContentSections":[{"kind":"content","content":[{"anchor":"Basics-of-interoperability","type":"heading","level":1,"text":"Basics of interoperability"},{"anchor":"Incremental-adoption","type":"heading","level":2,"text":"Incremental adoption"},{"items":[{"content":[{"inlineContent":[{"text":"Builds on Objective-C interoperability","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Supports incremental Swift adoption"}]}]}],"type":"unorderedList"},{"anchor":"Using-Swift-in-more-places","type":"heading","level":3,"text":"Using Swift in more places"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Adopt Swift in large C++ codebases."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Use C++ libraries in Swift.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Remove Objective-C bridging.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"While using C++ frameworks, Xcode imports C++ APIs automatically and don’t need a bridging header.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Enable C++ interoperability in the build settings."}]}]}],"type":"unorderedList"},{"code":["  \/\/ Calling a C++ method from Swift","  func loadImage(_ image: UIImage) {","  \/\/ Load an image into the shared C++ class.","  CxxImageEngine.shared.pointee.loadImage(image)","}","","  \/\/ importing a C++ framework ","  import CxxImageKit"],"syntax":"swift","type":"codeListing"},{"anchor":"Bidirectional-interoperability","type":"heading","level":2,"text":"Bidirectional interoperability"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Incremental Swift adoption.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Completely automatic integration by the Swift compiler without writting a Bridging layer."}]}]},{"content":[{"inlineContent":[{"text":"Direct calls and no overheads when calling APIs in Swift and vice-versa.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"C++ APIs availablity in Swift:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"can import most C++ collections, both from the standard library and elsewhere","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Collections","type":"text"}]},{"type":"text","text":": "},{"type":"codeVoice","code":"std::vector"},{"type":"text","text":", "},{"type":"codeVoice","code":"std::map"},{"type":"text","text":", User-defined"}]}]}],"type":"unorderedList"}]},{"content":[{"inlineContent":[{"type":"text","text":"handlew function templates and class template specializations"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"supports managing memory using shared pointer and similar user-defined types."}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Smart pointers","type":"text"}],"type":"strong"},{"type":"text","text":": "},{"type":"codeVoice","code":"std::shared_ptr"},{"type":"text","text":", user-defined"}]}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Members"}],"type":"strong"},{"type":"text","text":": methods, properties and intializers"}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Generics"}]},{"type":"text","text":": structs and enums"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"text":"Standard library","type":"text"}]},{"type":"text","text":": "},{"type":"codeVoice","code":"swift::Array"},{"type":"text","text":", "},{"type":"codeVoice","code":"swift::String"},{"type":"text","text":", and "},{"type":"codeVoice","code":"swift::Optional"}]}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"Library evolution","type":"text"}],"type":"strong"},{"text":":  resilient structs and classes","type":"text"}],"type":"paragraph"}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Xcode Compatiblity","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Code completion"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Jump-to-definition"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Global rename","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Debugger support"}],"type":"paragraph"}]}]}]}],"type":"unorderedList"},{"anchor":"Natural-Swift-APIs","type":"heading","level":1,"text":"Natural Swift APIs"},{"items":[{"content":[{"inlineContent":[{"text":"Swift compiler is able to automatically import most C++ APIs and represent them as safe Swift APIs.","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Getters and Setters -> Methods"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Value types -> Structs","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Reference Types -> Pointers","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Operators -> Operators","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Containers -> Swift Collections","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Constructors -> initializers"}],"type":"paragraph"}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Swift compiler allows us to fine-tune how APIs are imported and expose APIs that feel even more natural by providing the compiler with more information about your APIs through the use of annotations.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"structs represent value types and classes represent reference types."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"C++ types will be imported as value types in Swift."}],"type":"paragraph"}]}],"type":"unorderedList"},{"anchor":"Imported-value-types","type":"heading","level":2,"text":"Imported value types"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Short lifetimes and deep copies."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Copy constructor and destructor manage lifetime."}],"type":"paragraph"}]}],"type":"unorderedList"},{"anchor":"Collections","type":"heading","level":2,"text":"Collections"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Imports any type with "},{"type":"codeVoice","code":"begin"},{"type":"text","text":" and "},{"type":"codeVoice","code":"end"},{"type":"text","text":" methods as Swift collection."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Swift Collections can be used in ","type":"text"},{"type":"codeVoice","code":"for-loops"},{"text":", ","type":"text"},{"type":"codeVoice","code":"map"},{"text":", ","type":"text"},{"type":"codeVoice","code":"filter"}]}]}],"type":"unorderedList"},{"anchor":"Swift-Collections-Safety","type":"heading","level":2,"text":"Swift Collections Safety"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"use these Swift Collection APIs rather than C++ iterator APIs which do not fit into Swift’s safety model."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"The Swift compiler will help guide you towards these safer APIs by marking unsafe C++ APIs as unavailable and suggesting a safer alternative.","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"C++ doesn’t have a strong distinction between value types and reference types.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Swift also gives you the option to import some things as reference or class types by adding an annotation to your C++ code.","type":"text"}]}]}],"type":"unorderedList"},{"anchor":"Foreign-reference-types","type":"heading","level":2,"text":"Foreign reference types"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"map ","type":"text"},{"code":"CxxImageEngine","type":"codeVoice"},{"text":" to a Swift class using the ","type":"text"},{"code":"SWIFT_SHARED_REFERENCE","type":"codeVoice"},{"text":" attribute.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Enforces reference sematics."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Removes UnsafePointer indirection."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Manages lifetime with custom retain and release operations."}],"type":"paragraph"}]}],"type":"unorderedList"},{"code":["  \/\/importing swift\/bridging","  #import <swift\/bridging>","","  \/\/Applying SWIFT_SHARED_REFERENCE attribute to CxxImageEngine","  struct SWIFT_SHARED_REFERENCE(IKRetain, IKRelease) CxxImageEngine {","      \/\/ ...","  };"],"syntax":"swift","type":"codeListing"},{"anchor":"Computed-properties","type":"heading","level":3,"text":"Computed properties"},{"inlineContent":[{"type":"codeVoice","code":"SWIFT_COMPUTED_PROPERTY"},{"text":" attribute maps getter and setter to property.","type":"text"}],"type":"paragraph"},{"code":["   \/\/\/ \\returns all images that have been loaded into the engine. Includes any modifications that were","   \/\/\/ applied to the images.","   SWIFT_COMPUTED_PROPERTY","   inline std::vector<Image *_Nonnull> getImages() const;"],"syntax":"swift","type":"codeListing"},{"anchor":"Future-evolution","type":"heading","level":2,"text":"Future evolution"},{"items":[{"content":[{"inlineContent":[{"text":"Evolve based on your feedback.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Opt-in to changes with interoperability versions.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"You can join the workgroup and get involved on the forums. Just head to "},{"type":"reference","identifier":"https:\/\/www.swift.org\/documentation\/cxx-interop\/","isActive":true}]}]}],"type":"unorderedList"},{"anchor":"Written-By","type":"heading","level":2,"text":"Written By"},{"columns":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"RamitSharma991","type":"image"}]}],"size":1},{"content":[{"level":3,"anchor":"Ramit-Sharma","type":"heading","text":"Ramit Sharma"},{"inlineContent":[{"overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}],"overridingTitle":"Contributed Notes","type":"reference","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/RamitSharma991","isActive":true},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","identifier":"https:\/\/github.com\/RamitSharma991","isActive":true},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","identifier":"https:\/\/","isActive":true},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","identifier":"https:\/\/x.com\/iosDev_ramit","isActive":true}],"type":"paragraph"}],"size":4}],"type":"row","numberOfColumns":5},{"inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference"}],"type":"paragraph"},{"anchor":"Related-Sessions","type":"heading","level":2,"text":"Related Sessions"},{"style":"list","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10164-Whats-new-in-Swift"],"type":"links"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Legal Notice"}],"type":"strong"}],"type":"small"},{"inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}],"type":"small"}]}],"metadata":{"roleHeading":"WWDC23","modules":[{"name":"WWDC Notes"}],"title":"Mix Swift and C++","role":"sampleCode"},"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc23-10172-mix-swift-and-c++"],"traits":[{"interfaceLanguage":"swift"}]}],"references":{"https://":{"type":"link","identifier":"https:\/\/","titleInlineContent":[{"text":"Blog","type":"text"}],"title":"Blog","url":"https:\/\/"},"RamitSharma991.jpeg":{"alt":null,"type":"image","identifier":"RamitSharma991.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/RamitSharma991.jpeg"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10164-Whats-new-in-Swift":{"type":"topic","role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10164-Whats-new-in-Swift","kind":"article","url":"\/documentation\/wwdcnotes\/wwdc23-10164-whats-new-in-swift","title":"What’s new in Swift","abstract":[{"type":"text","text":"Join us for an update on Swift. We’ll show you how APIs are becoming more extensible and expressive with features like parameter packs and macros. We’ll also take you through improvements to interoperability and share how we’re expanding Swift’s performance and safety benefits everywhere from Foundation to large-scale distributed programs on the server."}]},"https://www.swift.org/documentation/cxx-interop/":{"type":"link","identifier":"https:\/\/www.swift.org\/documentation\/cxx-interop\/","titleInlineContent":[{"text":"Mixing Swift and C++","type":"text"}],"title":"Mixing Swift and C++","url":"https:\/\/www.swift.org\/documentation\/cxx-interop\/"},"https://x.com/iosDev_ramit":{"url":"https:\/\/x.com\/iosDev_ramit","titleInlineContent":[{"type":"text","text":"X\/Twitter"}],"title":"X\/Twitter","type":"link","identifier":"https:\/\/x.com\/iosDev_ramit"},"https://developer.apple.com/wwdc23/10172":{"type":"download","identifier":"https:\/\/developer.apple.com\/wwdc23\/10172","checksum":null,"url":"https:\/\/developer.apple.com\/wwdc23\/10172"},"WWDC23-Icon.png":{"identifier":"WWDC23-Icon.png","type":"image","alt":null,"variants":[{"url":"\/images\/WWDC23-Icon.png","traits":["1x","light"]}]},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"title":"Contributions are welcome!","type":"link","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"doc://WWDCNotes/documentation/WWDCNotes/RamitSharma991":{"role":"sampleCode","kind":"article","url":"\/documentation\/wwdcnotes\/ramitsharma991","type":"topic","images":[{"identifier":"RamitSharma991.jpeg","type":"card"},{"identifier":"RamitSharma991.jpeg","type":"icon"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/RamitSharma991","abstract":[{"text":"Indie iOS Dev. Swift, SwiftUI, Obj-C, UX and related.","type":"text"}],"title":"Ramit Sharma (15 notes)"},"doc://WWDCNotes/documentation/WWDCNotes":{"kind":"symbol","images":[{"identifier":"WWDCNotes.png","type":"icon"}],"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"url":"\/documentation\/wwdcnotes","role":"collection","title":"WWDC Notes"},"RamitSharma991":{"identifier":"RamitSharma991","type":"image","alt":"Profile image of Ramit Sharma","variants":[{"url":"\/images\/RamitSharma991.jpeg","traits":["1x","light"]}]},"https://github.com/RamitSharma991":{"url":"https:\/\/github.com\/RamitSharma991","titleInlineContent":[{"text":"GitHub","type":"text"}],"title":"GitHub","type":"link","identifier":"https:\/\/github.com\/RamitSharma991"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23":{"title":"WWDC23","role":"collectionGroup","abstract":[{"text":"Xcode 15, Swift 5.9, iOS 17, macOS 14 (Sonoma), tvOS 17, visionOS 1, watchOS 10.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"code":"SwiftData","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Observation","type":"codeVoice"},{"type":"text","text":", "},{"type":"codeVoice","code":"StoreKit"},{"type":"text","text":" views, and more."}],"images":[{"type":"icon","identifier":"WWDC23-Icon.png"},{"type":"card","identifier":"WWDC23.jpeg"}],"url":"\/documentation\/wwdcnotes\/wwdc23","type":"topic","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23"},"WWDCNotes.png":{"identifier":"WWDCNotes.png","type":"image","alt":null,"variants":[{"url":"\/images\/WWDCNotes.png","traits":["1x","light"]}]},"WWDC23.jpeg":{"alt":null,"variants":[{"url":"\/images\/WWDC23.jpeg","traits":["1x","light"]}],"type":"image","identifier":"WWDC23.jpeg"}}}