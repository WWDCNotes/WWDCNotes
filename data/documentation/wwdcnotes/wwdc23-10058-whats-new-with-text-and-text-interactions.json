{"kind":"article","metadata":{"title":"What’s new with text and text interactions","roleHeading":"WWDC23","modules":[{"name":"WWDC Notes"}],"role":"sampleCode"},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10058-Whats-new-with-text-and-text-interactions"},"sections":[],"primaryContentSections":[{"content":[{"type":"heading","text":"Overview","anchor":"overview","level":2},{"type":"paragraph","inlineContent":[{"type":"text","text":"Text plays a crucial role in every application. It’s the primary way to consume information and communicate. Here are the tools to create a powerful text experience in your app:"}]},{"type":"heading","text":"Changes to System selection UI","anchor":"Changes-to-System-selection-UI","level":2},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"a completely redesigned text cursor on all platforms."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"an inline, interactive switcher when changing input languages.","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"more ergonomic selection handles when doing range selection.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"a completely new loupe to make it easier to place the cursor in large bodies of text.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"works with "},{"code":"UITextViews","type":"codeVoice"},{"type":"text","text":" or "},{"code":"UITextFields","type":"codeVoice"},{"type":"text","text":" automatically."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"clients of "},{"type":"codeVoice","code":"UITextInteraction"},{"text":" also gets the new selection UI.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"for a highly customized UI displaying text added ","type":"text"},{"code":"UITextSelectionDisplayInteraction","type":"codeVoice"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"UITextSelectionDisplayInteraction","type":"codeVoice"},{"text":" is a new type of ","type":"text"},{"code":"UIInteraction","type":"codeVoice"},{"text":" that can be installed on any UIView.","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"must adopt ","type":"text"},{"code":"UITextInput","type":"codeVoice"},{"text":" protocol.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"provides the cursor view and cursor accessories and the range highlight and selection handles."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"All of these views are replaceable."}]}]}]}]}],"type":"unorderedList"},{"type":"codeListing","syntax":"swift","code":[" \/\/ Add selection display interaction"," let selectionDisplayInteraction = UITextSelectionDisplayInteraction(textInput: document, delegate: self)"," view.addInteraction(selectionDisplayInteraction)",""," \/\/ call this whenever selection changes in your document"," selectionDisplayInteraction.setNeedsSelectionUpdate()"]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"added a new API for displaying a loupe namely Text loupe.","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"new ","type":"text"},{"code":"UITextLoupeSession","type":"codeVoice"},{"text":" object for displaying loupe.","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"can be used on any view.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"UITextSelectionDisplayInteraction"},{"type":"text","text":" or "},{"type":"codeVoice","code":"UITextInput"},{"type":"text","text":" isn’t required to use it."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"recommended to use a gesture recognizer, such as "},{"type":"codeVoice","code":"UIPanGestureRecognizer"},{"type":"text","text":" to drive the loupe’s updates."}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"type":"heading","text":"Text item actions and menus","anchor":"Text-item-actions-and-menus","level":2},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"much more customizable using new APIs on "},{"type":"codeVoice","code":"UITextViewDelegate"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"makes it possible to modify the primary action for text items."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"New methods on "},{"code":"UITextViewDelegate","type":"codeVoice"}]}]}],"type":"unorderedList"},{"type":"codeListing","syntax":"swift","code":["func textView(_ textView: UITextView, primaryActionFor textItem: UITextItem, defaultAction: UIAction) -> UIAction?","","func textView(_ textView: UITextView, menuConfigurationFor textItem: UITextItem, defaultMenu: UIMenu) -> UITextItem.MenuConfiguration?"]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Text items represent the content that support item interactions.","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"includes text attachments, represented by ","type":"text"},{"code":"NSTextAttachment","type":"codeVoice"},{"text":", and links, represented by ","type":"text"},{"code":"NSLinkAttributeName","type":"codeVoice"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"UITextItem"},{"text":" now also supports tagging custom ranges of text for interaction.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"use the ","type":"text"},{"code":"UITextItemTagAttributeName","type":"codeVoice"},{"text":" on the attributed string representing the range of text you wish to make interactive.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"now possible to change the default tap or menu behavior when a text item is interacted with."}]}]},{"content":[{"inlineContent":[{"text":"redirect known links to existing views within the app or add custom menus to parts of the text.","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"heading","text":"Lists and bullets in TextKit 2","anchor":"Lists-and-bullets-in-TextKit-2","level":2},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Supports several different kinds of bullets."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Automatic numbering of items."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Localized for every language.","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"type":"codeListing","syntax":"swift","code":["let textList = NSTextList(markerFormat: .circle, option: 0)","let mutableParagrapghStyle = NSMutableParagraphStyle()","mutableParagraphStyle.textLists = [textList]","","textStorage.addAttribute(.paragraphStyle, value: mutableParagraphStyle, range: NSRange(location: 0, textStorage.length))"]},{"type":"heading","text":"Dictation on MacOS","anchor":"Dictation-on-MacOS","level":2},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"while scrolling, the indicator next to the cursor will stick to the edge of the scroll view, and offer a button to return to the current position in the document."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"If you’re using a standard text control in AppKit like NSTextView, you’ll get this behavior right out of the box.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"NSTextInsertionIndicator","type":"codeVoice"},{"type":"text","text":" is a new API for macOS that also allows to remain consistent with the system’s selection UI"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"System-provided insertion point"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Customizable","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Follows current accent color"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Supports dictation effects","type":"text"}]}]}]}]}],"type":"unorderedList"},{"type":"codeListing","syntax":"swift","code":["\/\/code example to add NSTextInsertionIndicator","let insertIndicator = NSTextInsertionIndicator(frame: .zero)","documentView.addSubview(insertIndicator)","","\/\/Block to handle effect views added by system","insertionIndicator.effectsViewInserter = { view in","documentView.addSubview(view, positioned: .below, relativeTo: insertionIndicator)","}","","func didLoseFocus() {","\/\/ When resigning first responder, make sure to hide cursor.","insertionIndicator.display = .hidden","}"]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"updates to the frame will automatically be animated with a glow effect."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"to disable the glow effect, remove the "},{"type":"codeVoice","code":"showEffectsView"},{"type":"text","text":" option from "},{"type":"codeVoice","code":"automaticModeOptions"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"after changing input modes, an effect view is displayed beneath the cursor in horizontal text to show the language selection UI.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"to override the placement of this UI, specify "},{"type":"codeVoice","code":"preferredTextAccessoryPlacement"},{"type":"text","text":" in your implementation of "},{"type":"codeVoice","code":"NSTextInputClient"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"adopt ","type":"text"},{"code":"NSTextInputClient","type":"codeVoice"},{"text":" and implement the ","type":"text"},{"code":"selectionRect","type":"codeVoice"},{"text":" and ","type":"text"},{"code":"documentVisibleRect","type":"codeVoice"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Notify the system about scrolling beginning and ending.","type":"text"}]}]}],"type":"unorderedList"},{"type":"heading","text":"Internationalization","anchor":"Internationalization","level":2},{"items":[{"content":[{"inlineContent":[{"text":"Dynamic line-height adjustments","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"automatically adjust the line height in "},{"type":"codeVoice","code":"UILabel"},{"type":"text","text":" or "},{"type":"codeVoice","code":"UITextField"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"depends on preferred languages in Language and region settings.","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"independent of actual language of content.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"only affects text elements that use text styles."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"use "},{"type":"codeVoice","code":"UIFont.preferredFont(forTextStyle:)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"make sure "},{"code":"clipsToBounds = false","type":"codeVoice"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Ascenders and descenders for languages like Thai and Hindi will often protrude beyond the line height bounds.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Respond to changes in vertical.","type":"text"}]}]}],"type":"unorderedList"}]},{"content":[{"inlineContent":[{"text":"Wrapping and hyphenation","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Improved line breaking for Chinese, German, Japanese, and Korean.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Optimized for text style and language."}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Adopt text styles."}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"type":"heading","text":"Written By","anchor":"Written-By","level":2},{"type":"row","columns":[{"size":1,"content":[{"type":"paragraph","inlineContent":[{"identifier":"RamitSharma991","type":"image"}]}]},{"size":4,"content":[{"level":3,"type":"heading","text":"Ramit Sharma","anchor":"Ramit-Sharma"},{"type":"paragraph","inlineContent":[{"type":"reference","overridingTitle":"Contributed Notes","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/RamitSharma991","overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","identifier":"https:\/\/github.com\/RamitSharma991","isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","identifier":"https:\/\/x.com\/iosDev_ramit","isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","identifier":"https:\/\/","isActive":true}]}]}],"numberOfColumns":5},{"type":"paragraph","inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"}]},{"type":"heading","text":"Related Sessions","anchor":"Related-Sessions","level":2},{"items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10055-Whats-new-in-UIKit","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10281-Keep-up-with-the-keyboard"],"type":"links","style":"list"},{"type":"small","inlineContent":[{"type":"strong","inlineContent":[{"text":"Legal Notice","type":"text"}]}]},{"type":"small","inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}]}],"kind":"content"}],"sampleCodeDownload":{"kind":"sampleDownload","action":{"overridingTitle":"Watch Video (15 min)","isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/wwdc23\/10058"}},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc23-10058-whats-new-with-text-and-text-interactions"]}],"schemaVersion":{"minor":3,"patch":0,"major":0},"abstract":[{"text":"Text is an absolutely critical component of every app. Discover the latest features and enhancements for creating rich text experiences on Apple platforms. We’ll show you how to take advantage of common text elements and create entirely custom interactions for your app. Learn about updates to dictation, text loupe, and text selection, and explore improvements to text clipping, line wrapping, and hyphenation.","type":"text"}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23"]]},"references":{"WWDC23-Icon.png":{"identifier":"WWDC23-Icon.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC23-Icon.png"}],"type":"image","alt":null},"https://github.com/RamitSharma991":{"identifier":"https:\/\/github.com\/RamitSharma991","title":"GitHub","titleInlineContent":[{"text":"GitHub","type":"text"}],"type":"link","url":"https:\/\/github.com\/RamitSharma991"},"doc://WWDCNotes/documentation/WWDCNotes/RamitSharma991":{"type":"topic","role":"sampleCode","abstract":[{"type":"text","text":"Indie iOS Dev. Swift, SwiftUI, Obj-C, UX and related."}],"title":"Ramit Sharma (15 notes)","kind":"article","url":"\/documentation\/wwdcnotes\/ramitsharma991","images":[{"identifier":"RamitSharma991.jpeg","type":"card"},{"type":"icon","identifier":"RamitSharma991.jpeg"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/RamitSharma991"},"WWDCNotes.png":{"identifier":"WWDCNotes.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"type":"image","alt":null},"RamitSharma991":{"identifier":"RamitSharma991","variants":[{"url":"\/images\/RamitSharma991.jpeg","traits":["1x","light"]}],"type":"image","alt":"Profile image of Ramit Sharma"},"https://developer.apple.com/wwdc23/10058":{"identifier":"https:\/\/developer.apple.com\/wwdc23\/10058","checksum":null,"type":"download","url":"https:\/\/developer.apple.com\/wwdc23\/10058"},"RamitSharma991.jpeg":{"variants":[{"url":"\/images\/RamitSharma991.jpeg","traits":["1x","light"]}],"alt":null,"identifier":"RamitSharma991.jpeg","type":"image"},"https://":{"url":"https:\/\/","identifier":"https:\/\/","title":"Blog","type":"link","titleInlineContent":[{"type":"text","text":"Blog"}]},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!","type":"link","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10281-Keep-up-with-the-keyboard":{"role":"sampleCode","type":"topic","title":"Keep up with the keyboard","url":"\/documentation\/wwdcnotes\/wwdc23-10281-keep-up-with-the-keyboard","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10281-Keep-up-with-the-keyboard","abstract":[{"text":"Each year, the keyboard evolves to support an increasing range of languages, sizes, and features. Discover how you can design your app to keep up with the keyboard, regardless of how it appears on a device. We’ll show you how to create frictionless text entry and share important architectural changes to help you understand how the keyboard works within the system.","type":"text"}]},"https://x.com/iosDev_ramit":{"url":"https:\/\/x.com\/iosDev_ramit","identifier":"https:\/\/x.com\/iosDev_ramit","title":"X\/Twitter","type":"link","titleInlineContent":[{"type":"text","text":"X\/Twitter"}]},"WWDC23.jpeg":{"variants":[{"url":"\/images\/WWDC23.jpeg","traits":["1x","light"]}],"alt":null,"identifier":"WWDC23.jpeg","type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10055-Whats-new-in-UIKit":{"kind":"article","type":"topic","abstract":[{"type":"text","text":"Explore enhancements and updates to UIKit and learn how to build better iOS, iPadOS, and Mac Catalyst apps. We’ll show you the latest features and improvements in UIKit and share API refinements, performance improvements, and much more."}],"role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10055-Whats-new-in-UIKit","url":"\/documentation\/wwdcnotes\/wwdc23-10055-whats-new-in-uikit","title":"What’s new in UIKit"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23":{"abstract":[{"text":"Xcode 15, Swift 5.9, iOS 17, macOS 14 (Sonoma), tvOS 17, visionOS 1, watchOS 10.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"code":"SwiftData","type":"codeVoice"},{"type":"text","text":", "},{"type":"codeVoice","code":"Observation"},{"type":"text","text":", "},{"type":"codeVoice","code":"StoreKit"},{"type":"text","text":" views, and more."}],"role":"collectionGroup","type":"topic","url":"\/documentation\/wwdcnotes\/wwdc23","title":"WWDC23","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23","images":[{"type":"icon","identifier":"WWDC23-Icon.png"},{"type":"card","identifier":"WWDC23.jpeg"}],"kind":"article"},"doc://WWDCNotes/documentation/WWDCNotes":{"title":"WWDC Notes","url":"\/documentation\/wwdcnotes","images":[{"identifier":"WWDCNotes.png","type":"icon"}],"kind":"symbol","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","role":"collection","type":"topic"}}}