{"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10165-Explore-Nearby-Interaction-with-thirdparty-accessories","interfaceLanguage":"swift"},"primaryContentSections":[{"content":[{"type":"heading","level":2,"anchor":"overview","text":"Overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"The "},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction","isActive":true},{"text":":","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"makes it easy to take advantage of the unique capabilities of U1, Apple’s chip for Ultra-Wideband technology","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"enables creating precise and spatially-aware interactions between nearby devices","type":"text"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"iOS examples:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Find My’s ","type":"text"},{"text":"Precision Finding","type":"text"},{"type":"text","text":" with AirTag"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Handoff gestures between iPhone and HomePod mini","type":"text"}]}]}]},{"level":2,"anchor":"Nearby-Interaction-quick-start","type":"heading","text":"Nearby Interaction quick start"},{"type":"orderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Create a "},{"identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/nisession","type":"reference","isActive":true},{"type":"text","text":" instance - this is the main object through which you’ll configure and run your spatial interactions with nearby devices"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Set the delegate on the "},{"type":"codeVoice","code":"NISession"},{"type":"text","text":" instance, which needs to be an object conforming to "},{"identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/nisessiondelegate","isActive":true,"type":"reference"},{"type":"text","text":" - The delegate will receive updates from the framework"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Create a configuration object (a "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/niconfiguration"},{"type":"text","text":" subclass) - E.g., "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/ninearbypeerconfiguration"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Call run on the ","type":"text"},{"code":"NISession","type":"codeVoice"},{"text":" instance with your configuration","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"The framework will start providing updates to your delegate - most importantly, you will get a stream of ","type":"text"},{"identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/ninearbyobject","type":"reference","isActive":true},{"text":" updates, each containing ","type":"text"},{"type":"codeVoice","code":"distance"},{"type":"text","text":" and, optionally, "},{"type":"codeVoice","code":"direction"},{"type":"text","text":", to nearby devices that are actively participating in the session"}]}]}]},{"level":2,"anchor":"Permission-prompt-updates","type":"heading","text":"Permission prompt updates"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Starting from iOS 15, the permission prompt is similar to other system permissions like user location:"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"the permission prompt will be shown on the first time your app runs an ","type":"text"},{"code":"NISession","type":"codeVoice"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"the permission will only be shown only once per app install"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"the permission can be changed in the Settings.app’s Privacy page under ","type":"text"},{"text":"Nearby Interactions","type":"text"}]}]}]},{"type":"paragraph","inlineContent":[{"text":"Add a ","type":"text"},{"code":"NSNearbyInteractionUsageDescription","type":"codeVoice"},{"text":" entry in your app ","type":"text"},{"text":"Info.plist","type":"text"},{"text":".","type":"text"}]},{"level":2,"anchor":"Third-party-accessory-API","type":"heading","text":"Third-party accessory API"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"U1-compatible development kits","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Sample app code","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/nearby-interaction\/"}],"type":"paragraph"}]}]},{"level":3,"anchor":"Configuring-for-accessory-interaction","type":"heading","text":"Configuring for accessory interaction"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Nearby Interaction expects your app and your accessory to have some sort of capability to exchange data between them - what technology to use to exchange data is entirely up to you (e.g., Bluetooth, LAN, Internet)"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"To start a session with an accessory, you’ll create a "},{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/ninearbyaccessoryconfiguration"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This configuration expects an "},{"type":"text","text":"Accessory Configuration Data"},{"type":"text","text":", which the accessory needs to send to the iDevice via the data channel (before connecting via the Nearby Interaction framework), this data will be known by the accessory manufacturers."}]}]}]},{"type":"codeListing","syntax":"swift","code":["\/\/\/ Handle configuration data from the accessory.","private func setupAccessory(_ configData: Data, name: String) {","  do {","  config = try NINearbyAccessoryConfiguration(data: configData)","  } catch let error {","    print(\"Bad config data from accessory \\(name). Error: \\(error)\")","    return","  }","  \/\/ Cache the token to correlate updates with this accessory.","  cacheToken(config! .accessoryDiscoveryToken, accessoryName: name)","}"]},{"type":"paragraph","inlineContent":[{"text":"Once we have our ","type":"text"},{"code":"NINearbyAccessoryConfiguration","type":"codeVoice"},{"text":" ready, we can start a ","type":"text"},{"code":"NISession","type":"codeVoice"},{"text":" and start the session.","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Similarly to how Nearby Interaction needed configuration data from the accessory, the accessory also needs configuration data from Nearby Interaction in order to know how to configure itself. This data needs to be in a format called ","type":"text"},{"text":"Shareable Configuration Data","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"When you run a session with an accessory configuration, Nearby Interaction will provide the Shareable Configuration Data to your app through a delegate callback"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"You’ll use your data channel to send the shareable configuration data back to the accessory","type":"text"}]}]}]},{"type":"codeListing","syntax":"swift","code":["\/\/\/ Send the Shareable Configuration Data to the accessory.","func session(_ session: NISession, didGenerateShareableConfigurationData: Data, for object: NINearby0bject) {","  \/\/ Get the data link for this accessory from a helper function.","  guard let conn = getConnection(object: object) else { return }","  \/\/ Send shareable configuration data.","  conn.sendShareableConfigurationData(data)","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Once the code running on the accessory receives the data, it needs to provide it as-is, and as quickly as possible, to the Ultra-Wideband hardware on board."}]},{"type":"paragraph","inlineContent":[{"text":"Both the ","type":"text"},{"text":"Sharable COnfiguration Data","type":"text"},{"text":" and ","type":"text"},{"text":"Accessory Configuration Data","type":"text"},{"text":" are part of ","type":"text"},{"overridingTitleInlineContent":[{"type":"text","text":"Apple’s specification"}],"identifier":"https:\/\/developer.apple.com\/nearby-interaction\/","isActive":true,"overridingTitle":"Apple’s specification","type":"reference"},{"text":".","type":"text"},{"text":"\n","type":"text"},{"text":"The document is intended for chipset and module manufactures, and it contains the necessary details for creating Ultra-Wideband solutions that use industry standards to interoperate with U1 in iPhone.","type":"text"}]},{"level":2,"anchor":"Written-By","type":"heading","text":"Written By"},{"type":"row","columns":[{"size":1,"content":[{"inlineContent":[{"type":"image","identifier":"zntfdr"}],"type":"paragraph"}]},{"size":4,"content":[{"type":"heading","level":3,"text":"Federico Zanetello","anchor":"Federico-Zanetello"},{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","type":"reference","isActive":true,"overridingTitle":"Contributed Notes","overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}]},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/github.com\/zntfdr","type":"reference","isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/zntfdr.dev","type":"reference","isActive":true}]}]}],"numberOfColumns":5},{"type":"paragraph","inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"isActive":true,"type":"reference","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"}]},{"level":2,"anchor":"Related-Sessions","type":"heading","text":"Related Sessions"},{"type":"links","style":"list","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-10008-Whats-new-in-Nearby-Interaction","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10245-Design-for-spatial-interaction","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10668-Meet-Nearby-Interaction"]},{"type":"small","inlineContent":[{"inlineContent":[{"type":"text","text":"Legal Notice"}],"type":"strong"}]},{"type":"small","inlineContent":[{"text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}]}],"kind":"content"}],"metadata":{"role":"sampleCode","title":"Explore Nearby Interaction with third-party accessories","roleHeading":"WWDC21","modules":[{"name":"WWDC Notes"}]},"schemaVersion":{"major":0,"minor":3,"patch":0},"sections":[],"kind":"article","hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21"]]},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc21-10165-explore-nearby-interaction-with-thirdparty-accessories"]}],"sampleCodeDownload":{"action":{"overridingTitle":"Watch Video (23 min)","type":"reference","identifier":"https:\/\/developer.apple.com\/wwdc21\/10165","isActive":true},"kind":"sampleDownload"},"abstract":[{"text":"Discover how your app can interact with Ultra Wideband (UWB) third-party accessories when running on a U1-equipped device. We’ll show you how to use the Nearby Interaction framework’s standards-based technology to implement precise and directionally-aware experiences with accessories. Learn about resources for getting started with accessory and app development such as development kits, sample code, and specification documents, along with supported technology providers.","type":"text"}],"references":{"https://zntfdr.dev":{"title":"Blog","url":"https:\/\/zntfdr.dev","identifier":"https:\/\/zntfdr.dev","type":"link","titleInlineContent":[{"text":"Blog","type":"text"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC20-10668-Meet-Nearby-Interaction":{"title":"Meet Nearby Interaction","url":"\/documentation\/wwdcnotes\/wwdc20-10668-meet-nearby-interaction","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10668-Meet-Nearby-Interaction","type":"topic","role":"sampleCode","abstract":[{"text":"The Nearby Interaction framework streams distance and direction between opted-in Apple devices containing the U1 chip. Discover how this powerful combination of hardware and software allow you to create intuitive spatial interactions based on the relative position of two or more devices. We’ll walk you through this session-based API and show you how to deliver entirely new interactive experiences — all with privacy in mind.","type":"text"}]},"zntfdr.jpeg":{"identifier":"zntfdr.jpeg","alt":null,"variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10245-Design-for-spatial-interaction":{"type":"topic","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10245-Design-for-spatial-interaction","title":"Design for spatial interaction","url":"\/documentation\/wwdcnotes\/wwdc21-10245-design-for-spatial-interaction","abstract":[{"type":"text","text":"Discover the principles for creating intuitive physical interactions between two or more devices, as demonstrated by Apple designers who worked on features for iPhone, HomePod mini, and AirTag. Explore how you can apply these patterns to your own app when designing features for Apple platforms, and help people using your app interact more directly with their surroundings."}],"role":"sampleCode"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"url":"\/documentation\/wwdcnotes\/zntfdr","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","title":"Federico Zanetello (332 notes)","kind":"article","images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"role":"sampleCode","abstract":[{"text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more.","type":"text"}],"type":"topic"},"https://developer.apple.com/documentation/nearbyinteraction/nisessiondelegate":{"title":"NISessionDelegate","url":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/nisessiondelegate","identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/nisessiondelegate","type":"link","titleInlineContent":[{"code":"NISessionDelegate","type":"codeVoice"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-10008-Whats-new-in-Nearby-Interaction":{"kind":"article","url":"\/documentation\/wwdcnotes\/wwdc22-10008-whats-new-in-nearby-interaction","abstract":[{"type":"text","text":"Discover how the Nearby Interaction framework can help you easily integrate Ultra Wideband (UWB) into your apps and hardware accessories. Learn how you can combine the visual-spatial power of ARKit with the radio sensitivity of the U1 chip to locate nearby stationary objects with precision. We’ll also show you how you can create background interactions using UWB accessories paired via Bluetooth."}],"role":"sampleCode","type":"topic","title":"What’s new in Nearby Interaction","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-10008-Whats-new-in-Nearby-Interaction"},"https://developer.apple.com/documentation/nearbyinteraction/ninearbyobject":{"title":"NINearbyObject","url":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/ninearbyobject","identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/ninearbyobject","type":"link","titleInlineContent":[{"code":"NINearbyObject","type":"codeVoice"}]},"https://developer.apple.com/documentation/nearbyinteraction/ninearbypeerconfiguration":{"title":"NINearbyPeerConfiguration","url":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/ninearbypeerconfiguration","identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/ninearbypeerconfiguration","type":"link","titleInlineContent":[{"code":"NINearbyPeerConfiguration","type":"codeVoice"}]},"https://developer.apple.com/nearby-interaction/":{"title":"Specifications for accessory makers are available here","url":"https:\/\/developer.apple.com\/nearby-interaction\/","identifier":"https:\/\/developer.apple.com\/nearby-interaction\/","type":"link","titleInlineContent":[{"type":"text","text":"Specifications for accessory makers are available here"}]},"https://developer.apple.com/documentation/nearbyinteraction/nisession":{"title":"NISession ","url":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/nisession","identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/nisession","type":"link","titleInlineContent":[{"code":"NISession","type":"codeVoice"},{"text":" ","type":"text"}]},"https://github.com/zntfdr":{"title":"GitHub","url":"https:\/\/github.com\/zntfdr","identifier":"https:\/\/github.com\/zntfdr","type":"link","titleInlineContent":[{"type":"text","text":"GitHub"}]},"https://developer.apple.com/documentation/nearbyinteraction/niconfiguration":{"title":"NIConfiguration","url":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/niconfiguration","identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/niconfiguration","type":"link","titleInlineContent":[{"code":"NIConfiguration","type":"codeVoice"}]},"https://developer.apple.com/wwdc21/10165":{"url":"https:\/\/developer.apple.com\/wwdc21\/10165","identifier":"https:\/\/developer.apple.com\/wwdc21\/10165","checksum":null,"type":"download"},"doc://WWDCNotes/documentation/WWDCNotes":{"kind":"symbol","type":"topic","title":"WWDC Notes","role":"collection","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","url":"\/documentation\/wwdcnotes"},"https://developer.apple.com/documentation/nearbyinteraction/ninearbyaccessoryconfiguration":{"identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/ninearbyaccessoryconfiguration","title":"NINearbyAccessoryConfiguration","type":"link","url":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction\/ninearbyaccessoryconfiguration","titleInlineContent":[{"code":"NINearbyAccessoryConfiguration","type":"codeVoice"}]},"WWDCNotes.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"identifier":"WWDCNotes.png","alt":null,"type":"image"},"WWDC21.jpeg":{"variants":[{"url":"\/images\/WWDC21.jpeg","traits":["1x","light"]}],"identifier":"WWDC21.jpeg","alt":null,"type":"image"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!","type":"link","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}]},"WWDC21-Icon.png":{"variants":[{"url":"\/images\/WWDC21-Icon.png","traits":["1x","light"]}],"identifier":"WWDC21-Icon.png","alt":null,"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21":{"url":"\/documentation\/wwdcnotes\/wwdc21","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21","title":"WWDC21","kind":"article","images":[{"type":"icon","identifier":"WWDC21-Icon.png"},{"type":"card","identifier":"WWDC21.jpeg"}],"role":"collectionGroup","abstract":[{"text":"Xcode 13, Swift 5.5, iOS 15, macOS 12 (Monterey), tvOS 15, watchOS 8.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"code":"MusicKit","type":"codeVoice"},{"text":", ","type":"text"},{"code":"DocC","type":"codeVoice"},{"text":", ","type":"text"},{"code":"StoreKit 2","type":"codeVoice"},{"type":"text","text":", and more."}],"type":"topic"},"zntfdr":{"variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}],"identifier":"zntfdr","alt":"Profile image of Federico Zanetello","type":"image"},"https://developer.apple.com/documentation/nearbyinteraction":{"identifier":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction","title":"Nearby Interaction framework","type":"link","url":"https:\/\/developer.apple.com\/documentation\/nearbyinteraction","titleInlineContent":[{"text":"Nearby Interaction framework","type":"text"}]}}}