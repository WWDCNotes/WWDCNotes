{"abstract":[{"text":"Testing is an essential tool to consistently verify your code works correctly, but often your code has dependencies that are out of your control. Discover techniques for making hard-to-test code testable on Apple platforms using XCTest. Learn a variety of tips for writing higher-quality tests that run fast and require less maintenance.","type":"text"}],"sampleCodeDownload":{"kind":"sampleDownload","action":{"identifier":"https:\/\/developer.apple.com\/wwdc18\/417","type":"reference","isActive":true,"overridingTitle":"Watch Video (37 min)"}},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC18-417-Testing-Tips-and-Tricks"},"sections":[],"kind":"article","hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC18"]]},"primaryContentSections":[{"content":[{"text":"Overview","anchor":"overview","type":"heading","level":2},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"The usual reminder about the “Pyramid of Tests”, three kinds of tests (from small to big, fast to slow):","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Unit: test specific functions\/methods"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Integration: test classes\/methods interaction","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"End-To-End (System Tests, UI): test the user final experience","type":"text"}]}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"code":"NotificationCenter","type":"codeVoice"},{"text":" can use different environments (kind of like ","type":"text"},{"code":"UserDefaults","type":"codeVoice"},{"text":" have different groups): you should avoid using the default notification center in your tests as this may affect other parts of the code (the test is therefore NOT isolated). To make things testable you should inject the ","type":"text"},{"code":"notificationCenter","type":"codeVoice"},{"text":" in all your methods, going from this:","type":"text"}]}]}]},{"type":"codeListing","syntax":"swift","code":["class Points0fInterestTableViewController { ","  var observer: AnyObject? ","","  init() { ","    let name = CurrentLocationProvider.authChangedNotification","    observer = NotificationCenter.default.addObserver(","      forName: name, ","      object: nil, ","      queue: .main","    ) { [weak self] _ in ","      self?.handleAuthChanged()","    }","  }","","  var didHandleNotification = false ","","  func handleAuthChanged() { ","    didHandleNotification = true ","  }","}"]},{"inlineContent":[{"text":"To this:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["class Points0fInterestTableViewController { ","  let notificationCenter: NotificationCenter","  var observer: AnyObject? ","  ","  init(notificationCenter: NotificationCenter) {","    self.notificationCenter = notificationCenter","    let name = CurrentLocationProvider.authChangedNotification","    observer = notificationCenter.addObserver(","      forName:name, ","      object: nil, ","      queue: .main","    ) { [weak self] _ in ","      self?.handleAuthChanged() ","    }","  }","","  var didHandleNotification = false ","","  func handleAuthChanged() { ","    didHandleNotification = true ","  }","}"]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"You can also add a default value so you need to change the parameter only in the tests:"}]}]}]},{"type":"codeListing","syntax":"swift","code":["class PointsofInterestTableViewController {","  let notificationCenter: NotificationCenter ","  var observer: AnyObject? ","","  init(notificationCenter: NotificationCenter = .default) { ","    self.notificationCenter = notificationCenter","    let name = CurrentLocationProvider.authChangedNotification","    observer = notificationCenter.addObserver(","      forName: name,","      object: nil,","      queue: .main","    ) { [weak self] _ in","      self?.handleAuthChanged() ","    }","  }","","  var didHandleNotification = false ","","  func handleAuthChanged() { ","    didHandleNotification = true ","  }","}"]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"When creating mocks, beside relying as much as possible on protocols, another neat thing your mock classes\/struct should have is the possibility to overwrite some of their methods, so every test can change the behaviour of the mock accordingly on what you’re trying to test","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"To make tests run even faster, you can try to skip some setups in your app launch by adding an environment variable or a launch argument in your schema:","type":"text"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"WWDC18-417-setup1"}]},{"type":"paragraph","inlineContent":[{"text":"And then use it in your app:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["func application (_ application: UIApplication, didFinishLaunchingWithOptions opts: ...) -> Bool {","  let isUnitTesting = ProcessInfo.processInfo.environment[\"IS_UNIT_TESTING\"] == \"1\"","","  if isUnitTesting == false { ","    \/\/ Do UI-related setup, which can be skipped when testing ","  }","","  return true","}"]},{"type":"heading","text":"Written By","level":2,"anchor":"Written-By"},{"type":"row","columns":[{"content":[{"type":"paragraph","inlineContent":[{"type":"image","identifier":"zntfdr"}]}],"size":1},{"content":[{"text":"Federico Zanetello","level":3,"anchor":"Federico-Zanetello","type":"heading"},{"inlineContent":[{"isActive":true,"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","type":"reference","overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"overridingTitle":"Contributed Notes"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"isActive":true,"identifier":"https:\/\/github.com\/zntfdr","type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/zntfdr.dev","type":"reference","isActive":true}],"type":"paragraph"}],"size":4}],"numberOfColumns":5},{"type":"paragraph","inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference","isActive":true}]},{"type":"heading","text":"Related Sessions","level":2,"anchor":"Related-Sessions"},{"type":"links","style":"list","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110361-Author-fast-and-reliable-tests-for-Xcode-Cloud","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10142-Build-scalable-enterprise-app-suites","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC18-403-Whats-New-in-Testing","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC18-407-Practical-Approaches-to-Great-App-Performance","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC17-414-Engineering-for-Testability","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC15-406-UI-Testing-in-Xcode"]},{"type":"small","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Legal Notice"}]}]},{"type":"small","inlineContent":[{"text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}]}],"kind":"content"}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc18-417-testing-tips-and-tricks"]}],"schemaVersion":{"major":0,"patch":0,"minor":3},"metadata":{"modules":[{"name":"WWDC Notes"}],"title":"Testing Tips & Tricks","roleHeading":"WWDC18","role":"sampleCode"},"references":{"doc://WWDCNotes/documentation/WWDCNotes/WWDC18-407-Practical-Approaches-to-Great-App-Performance":{"type":"topic","title":"Practical Approaches to Great App Performance","kind":"article","role":"sampleCode","abstract":[{"text":"All apps benefit from a focus on performance and an increase in overall responsiveness. This information packed session gives you strategies for fixing performance problems using Instruments and other tools. Additionally, get practical advice based on experience in tuning Apple’s own apps including Xcode and Photos on iOS.","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC18-407-Practical-Approaches-to-Great-App-Performance","url":"\/documentation\/wwdcnotes\/wwdc18-407-practical-approaches-to-great-app-performance"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC17-414-Engineering-for-Testability":{"type":"topic","title":"Engineering for Testability","abstract":[{"text":"Unit testing is an essential tool to consistently verify your code works correctly. Discover techniques for designing the code of your app so that it can be easily tested. Find out the best practices for developing a test suite that evolves with your app and scales as your app grows.","type":"text"}],"role":"sampleCode","kind":"article","url":"\/documentation\/wwdcnotes\/wwdc17-414-engineering-for-testability","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC17-414-Engineering-for-Testability"},"https://developer.apple.com/wwdc18/417":{"identifier":"https:\/\/developer.apple.com\/wwdc18\/417","checksum":null,"type":"download","url":"https:\/\/developer.apple.com\/wwdc18\/417"},"WWDC18.jpeg":{"identifier":"WWDC18.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC18.jpeg"}],"type":"image","alt":null},"doc://WWDCNotes/documentation/WWDCNotes/WWDC15-406-UI-Testing-in-Xcode":{"abstract":[{"text":"Xcode 7 introduces new UI testing features fully integrated into the IDE. Learn about the new APIs and how UI testing fits in with existing testing features in Xcode. See how to get started by recording your app, and how to efficiently craft and maintain UI tests.","type":"text"}],"kind":"article","role":"sampleCode","type":"topic","url":"\/documentation\/wwdcnotes\/wwdc15-406-ui-testing-in-xcode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC15-406-UI-Testing-in-Xcode","title":"UI Testing in Xcode"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC18-403-Whats-New-in-Testing":{"abstract":[{"type":"text","text":"Hear about exciting improvements to code coverage, including how you can build your own automation on top of Xcode’s coverage reports. Learn how to dramatically speed up the execution of your tests by leveraging distributed parallel testing, new in Xcode 10."}],"url":"\/documentation\/wwdcnotes\/wwdc18-403-whats-new-in-testing","role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC18-403-Whats-New-in-Testing","kind":"article","title":"What’s New in Testing","type":"topic"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC20-10142-Build-scalable-enterprise-app-suites":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10142-Build-scalable-enterprise-app-suites","title":"Build scalable enterprise app suites","type":"topic","kind":"article","url":"\/documentation\/wwdcnotes\/wwdc20-10142-build-scalable-enterprise-app-suites","abstract":[{"type":"text","text":"Learn how to build focused enterprise apps that work well together. In this session, we’ll introduce you to Apple Retail’s suite of enterprise apps, which help employees interact with customers, track operations, manage stores, and stay connected. Discover how Apple Retail created a unified set of apps by adopting Swift Packages and testing for app scalability. And explore how managing apps in production with configurations can help tailor app suites to different regions and locations."}],"role":"sampleCode"},"https://github.com/zntfdr":{"titleInlineContent":[{"text":"GitHub","type":"text"}],"identifier":"https:\/\/github.com\/zntfdr","type":"link","title":"GitHub","url":"https:\/\/github.com\/zntfdr"},"zntfdr.jpeg":{"identifier":"zntfdr.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}],"type":"image","alt":null},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","kind":"article","url":"\/documentation\/wwdcnotes\/zntfdr","abstract":[{"text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more.","type":"text"}],"title":"Federico Zanetello (332 notes)","images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"role":"sampleCode"},"WWDC18-417-setup1":{"identifier":"WWDC18-417-setup1","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC18-417-setup1.png"}],"type":"image","alt":null},"WWDC18-Icon.png":{"identifier":"WWDC18-Icon.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC18-Icon.png"}],"type":"image","alt":null},"https://zntfdr.dev":{"titleInlineContent":[{"text":"Blog","type":"text"}],"identifier":"https:\/\/zntfdr.dev","type":"link","title":"Blog","url":"https:\/\/zntfdr.dev"},"WWDCNotes.png":{"identifier":"WWDCNotes.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"type":"image","alt":null},"doc://WWDCNotes/documentation/WWDCNotes":{"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","kind":"symbol","url":"\/documentation\/wwdcnotes","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"title":"WWDC Notes","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"role":"collection"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"link","title":"Contributions are welcome!","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-110361-Author-fast-and-reliable-tests-for-Xcode-Cloud":{"kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110361-Author-fast-and-reliable-tests-for-Xcode-Cloud","url":"\/documentation\/wwdcnotes\/wwdc22-110361-author-fast-and-reliable-tests-for-xcode-cloud","title":"Author fast and reliable tests for Xcode Cloud","type":"topic","role":"sampleCode","abstract":[{"text":"Discover how you can create effective testing plans for Xcode Cloud, Apple’s continuous integration and continuous delivery service. We’ll show you how testing can be an essential tool to consistently verify your code works correctly. Learn how you can author fast, reliable, and efficient tests for Xcode Cloud, avoid irrelevant failures, and verify your code changes quickly.","type":"text"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC18":{"url":"\/documentation\/wwdcnotes\/wwdc18","title":"WWDC18","abstract":[{"text":"Xcode 10, Swift 4.2, iOS 12, macOS 10.14 (Mojave), tvOS 12, watchOS 5.","type":"text"}],"images":[{"identifier":"WWDC18-Icon.png","type":"icon"},{"identifier":"WWDC18.jpeg","type":"card"}],"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC18","kind":"article","role":"collectionGroup"},"zntfdr":{"identifier":"zntfdr","variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}],"type":"image","alt":"Profile image of Federico Zanetello"}}}