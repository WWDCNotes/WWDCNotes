{"metadata":{"roleHeading":"WWDC21","title":"Your guide to keyboard layout","modules":[{"name":"WWDC Notes"}],"role":"sampleCode"},"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10259-Your-guide-to-keyboard-layout","interfaceLanguage":"swift"},"sampleCodeDownload":{"action":{"overridingTitle":"Watch Video (14 min)","type":"reference","identifier":"https:\/\/developer.apple.com\/wwdc21\/10259","isActive":true},"kind":"sampleDownload"},"sections":[],"schemaVersion":{"major":0,"patch":0,"minor":3},"primaryContentSections":[{"kind":"content","content":[{"anchor":"UIKeyboardLayoutGuide","type":"heading","level":2,"text":"UIKeyboardLayoutGuide"},{"type":"paragraph","inlineContent":[{"text":"Here is the old way of listening for keyboard notifications and adjusting your layout:","type":"text"}]},{"code":["    \/\/...","    keyboardGuide.bottomAnchor.constraint(","        equalTo: view.bottomAnchor","    ).isActive = true","    keyboardGuide.topAnchor.constraint(","        equalTo: textView.bottomAnchor","    ).isActive = true","    keyboardHeight = keyboardGuide.heightAnchor.constraint(","        equalToConstant: view.safeAreaInsets.bottom","    )","    NotificationCenter.default.addObserver(","        self,","        selector: #selector(respondToKeyboard),","        name: UIResponder.keyboardWillShowNotification,","        object: nil","    )","}","","@objc func respondToKeyboard(notification: Notification) {","    let info = notification.userInfo","    if let endRect = info?[.keyboardFrameEndUserInfoKey] as? CGRect {","        var offset = view.bounds.size.height - endRect.origin.y","        if offset == 0.0 {","            offset = view.safeAreaInsets.bottom","        }","        let duration = info?[.keyboardAnimationDurationUserInfoKey] as? TimeInterval ?? 2.0","        UIView.animate(","            withDuration: duration,","            animations: {","                self.keyboardHeight.constant = offset","                self.view.layoutIfNeeded()","            }","        )","    }","}"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"type":"text","text":"New in iOS15. Here is the suggested new way using UIKeyboardLayoutGuide:"}]},{"code":["view.keyboardLayoutGuide.topAnchor.constraint(","    equalToSystemSpacingBelow: textView.bottomAnchor,","    multiplier: 1.0",").isActive = true"],"type":"codeListing","syntax":"swift"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Use view.keyboardLayoutGuide"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"For most common use cases, simply update to use .topAnchor"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Matches keyboard animations like bring up and dismiss"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Follows height changes as the keyboard can be taller or shorter based on content (showing emojis, etc)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"When the keyboard is undocked the guide will drop to the bottom of the screen and be the width of your window"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Anything you’ve tied to the top anchor will follow","type":"text"}]}]}]}]},{"content":[{"inlineContent":[{"text":"It accounts for safe-area insets","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"anchor":"Why-did-Apple-create-a-new-custom-layout-guide-vs-a-generic-layout-guide","type":"heading","level":3,"text":"Why did Apple create a new custom layout guide vs a generic layout guide?"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Answer: giving the developer more control over how their layout responds to keyboards"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"You have the ability to fully follow the keyboard in all its incarnations, if you so choose, by using a new property: "},{"type":"codeVoice","code":".followsUndockedKeyboard"},{"type":"text","text":"."}]},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"If you set it to true, the guide will follow the keyboard when it’s undocked or floating, giving you a lot of control over how your layout responds to wherever the keyboard may be."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"No more automatic drop-to-bottom. No listening for hide keyboard notifications when undocking. The layout guide is where the keyboard is."}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"anchor":"UITrackingLayoutGuide","type":"heading","level":2,"text":"UITrackingLayoutGuide"},{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"UIKeyboardLayoutGuide"},{"type":"text","text":" is a subclass of the new "},{"type":"codeVoice","code":"UITrackingLayoutGuide"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Tracks the constraints you want to change when it moves around the screen."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"You can give it an array of constraints that activate when near a specific edge, and deactivate when leaving it"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"You can give it an array that activates when specifically away from an edge, and deactivates when near it.","type":"text"}]}]}],"type":"unorderedList"},{"anchor":"Example-Code","type":"heading","level":3,"text":"Example Code"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Default keyboard with custom top actions:"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"WWDC21-10259-10259-example-default-keyboard-with-top-actions"}]},{"anchor":"Example-1","type":"heading","level":4,"text":"Example 1"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Moving keyboard up causes top actions to shift to bottom:"}]},{"type":"paragraph","inlineContent":[{"identifier":"WWDC21-10259-10259-top-actions-move-to-bottom","type":"image"}]},{"code":["let awayFromTopConstraints = [","    view.keyboardLayoutGuide.topAnchor.constraint(","        equalTo: editView.bottomAnchor","    )","]","view.keyboardLayoutGuide.setConstraints(","    awayFromTopConstraints,","    activeWhenAwayFrom: .top",")"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"Code specifies that the constraint that anchors custom keyboard actions to the top of the keyboard is only active when keyboard is away from the top","type":"text"}]},{"code":["let nearTopConstraints = [","    view.safeAreaLayoutGuide.bottomAnchor.constraint(","        equalTo: editView.bottomAnchor","    )","]","view.keyboardLayoutGuide.setConstraints(","    nearTopConstraints,","    activeWhenNearEdge: .top",")"],"type":"codeListing","syntax":"swift"},{"type":"paragraph","inlineContent":[{"text":"Code specifies that the constraint that will anchor custom keyboard actions to bottom safe area of the view is only active when keyboard is near the top edge","type":"text"}]},{"anchor":"Example-2","type":"heading","level":4,"text":"Example 2"},{"type":"paragraph","inlineContent":[{"text":"Moving keyboard to the right or left edge causes underlying content to shift into open area","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"WWDC21-10259-10259-content-shifts-left"}]},{"code":["\/\/set default behavior","let awayFromSides = [","    imageView.centerXAnchor.constraint(","        equalTo: view.centerXAnchor","    )","]","view.keyboardLayoutGuide.setConstraints(","    awayFromSides,","    activeWhenAwayFrom: [","        .leading,","        .trailing","    ]",")","","\/\/when nearing sides, shift imageView appropriately","let nearTrailingConstraints = [","    imageView.leadingAnchor.constraint(","        equalToSystemSpacingAfter: view.safeAreaLayoutGuide.leadingAnchor,","        multiplier: 1.0","    )","]","view.keyboardLayoutGuide.setConstraints(","    nearTrailingConstraints,","    activeWhenNearEdge: .trailing",")","","let nearLeadingConstraints = [","    view.safeAreaLayoutGuide.trailingAnchor.constraint(","        equalToSystemSpacingAfter: imageView.trailingAnchor, ","        multiplier: 1.0","    )","]","view.keyboardLayoutGuide.setConstraints(","    nearLeadingConstraints,","    activeWhenNearEdge: .leading",")"],"type":"codeListing","syntax":"swift"},{"anchor":"What-is-near-and-awayFrom","type":"heading","level":3,"text":"What is .near and .awayFrom?"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"A docked keyboard is considered to be near the bottom and awayFrom the other edges","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Undocked and split keyboards can be awayFrom all edges, or they can get near the top edge."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"When it’s the floating keyboard, it can be near or awayFrom any edge, and it can even be near two adjacent edges at the same time.","type":"text"}]}]}],"type":"unorderedList"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Above only applies when you set followsUndockedKeyboard to true."}]},{"anchor":"Things-to-Know","type":"heading","level":2,"text":"Things to Know"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Camera text input can be launched by most keyboards. This camera UI can be full screen and it’s behaviour conforms to "},{"type":"codeVoice","code":"UIKeyboardLayoutGuide"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"New in iOS15, the shortcuts bar that shown at the bottom while a hardware keyboard is attached is no longer full width. Now it’s size adapts to language and how many buttons are present."}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"If you’re following the undocked keyboard, you can actually use the real leading and trailing edges of the bar"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This is always "},{"type":"codeVoice","code":".near"},{"type":"text","text":" the bottom and, in its normal position, it’s "},{"type":"codeVoice","code":".awayFrom"},{"type":"text","text":" the other three edges."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"If you collapse it into a small launch button, it can be moved around so it can be "},{"code":".near","type":"codeVoice"},{"type":"text","text":" the leading or trailing edge."}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"anchor":"Written-By","type":"heading","level":2,"text":"Written By"},{"type":"row","columns":[{"size":1,"content":[{"type":"paragraph","inlineContent":[{"identifier":"trav-ma","type":"image"}]}]},{"size":4,"content":[{"text":"Travis Ma","type":"heading","level":3,"anchor":"Travis-Ma"},{"type":"paragraph","inlineContent":[{"type":"reference","overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}],"overridingTitle":"Contributed Notes","isActive":true,"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/trav-ma"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/trav-ma"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"https:\/\/www.travisma.me"}]}]}],"numberOfColumns":5},{"type":"thematicBreak"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference","isActive":true}]},{"anchor":"Related-Sessions","type":"heading","level":2,"text":"Related Sessions"},{"items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10281-Keep-up-with-the-keyboard","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10276-Use-the-camera-for-keyboard-input-in-your-app"],"type":"links","style":"list"},{"type":"small","inlineContent":[{"type":"strong","inlineContent":[{"text":"Legal Notice","type":"text"}]}]},{"type":"small","inlineContent":[{"text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}]}]}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc21-10259-your-guide-to-keyboard-layout"]}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21"]]},"kind":"article","abstract":[{"type":"text","text":"Discover how you can use the Keyboard Layout Guide to manage how keyboards work within your iOS or iPadOS app. Learn how you can avoid writing lengthy code blocks when you use UIKeyboardLayoutGuide and UITrackingLayoutGuide to integrate the keyboard into your interface, helping people have a smoother, more enjoyable experience whenever they use the on-screen keyboard within your app."}],"references":{"trav-ma.jpeg":{"identifier":"trav-ma.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/trav-ma.jpeg"}],"alt":null,"type":"image"},"WWDC21-Icon.png":{"type":"image","identifier":"WWDC21-Icon.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC21-Icon.png"}],"alt":null},"WWDC21-10259-10259-top-actions-move-to-bottom":{"alt":"Moving the keyboard up causes top actions to shift to bottom","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC21-10259-10259-top-actions-move-to-bottom.png"}],"identifier":"WWDC21-10259-10259-top-actions-move-to-bottom","type":"image"},"WWDC21-10259-10259-example-default-keyboard-with-top-actions":{"identifier":"WWDC21-10259-10259-example-default-keyboard-with-top-actions","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC21-10259-10259-example-default-keyboard-with-top-actions.png"}],"alt":"Default keyboard with custom top actions","type":"image"},"WWDCNotes.png":{"type":"image","identifier":"WWDCNotes.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDCNotes.png"}],"alt":null},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21":{"kind":"article","title":"WWDC21","url":"\/documentation\/wwdcnotes\/wwdc21","type":"topic","images":[{"identifier":"WWDC21-Icon.png","type":"icon"},{"identifier":"WWDC21.jpeg","type":"card"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21","role":"collectionGroup","abstract":[{"type":"text","text":"Xcode 13, Swift 5.5, iOS 15, macOS 12 (Monterey), tvOS 15, watchOS 8."},{"type":"text","text":" "},{"type":"text","text":"New APIs: "},{"type":"codeVoice","code":"MusicKit"},{"type":"text","text":", "},{"type":"codeVoice","code":"DocC"},{"type":"text","text":", "},{"type":"codeVoice","code":"StoreKit 2"},{"type":"text","text":", and more."}]},"WWDC21-10259-10259-content-shifts-left":{"alt":"Moving keyboard to the right causes underlying content to shift to left","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC21-10259-10259-content-shifts-left.png"}],"identifier":"WWDC21-10259-10259-content-shifts-left","type":"image"},"WWDC21.jpeg":{"identifier":"WWDC21.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC21.jpeg"}],"alt":null,"type":"image"},"https://github.com/trav-ma":{"type":"link","identifier":"https:\/\/github.com\/trav-ma","title":"GitHub","url":"https:\/\/github.com\/trav-ma","titleInlineContent":[{"text":"GitHub","type":"text"}]},"trav-ma":{"alt":"Profile image of Travis Ma","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/trav-ma.jpeg"}],"identifier":"trav-ma","type":"image"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}],"type":"link"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10281-Keep-up-with-the-keyboard":{"title":"Keep up with the keyboard","url":"\/documentation\/wwdcnotes\/wwdc23-10281-keep-up-with-the-keyboard","role":"sampleCode","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10281-Keep-up-with-the-keyboard","abstract":[{"text":"Each year, the keyboard evolves to support an increasing range of languages, sizes, and features. Discover how you can design your app to keep up with the keyboard, regardless of how it appears on a device. We’ll show you how to create frictionless text entry and share important architectural changes to help you understand how the keyboard works within the system.","type":"text"}],"kind":"article"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10276-Use-the-camera-for-keyboard-input-in-your-app":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10276-Use-the-camera-for-keyboard-input-in-your-app","title":"Use the camera for keyboard input in your app","url":"\/documentation\/wwdcnotes\/wwdc21-10276-use-the-camera-for-keyboard-input-in-your-app","kind":"article","type":"topic","role":"sampleCode","abstract":[{"text":"Learn how you can support Live Text and intelligently pull information from the camera to fill out forms and text fields in your app. We’ll show you how to apply content filtering to capture the correct information when someone uses the camera as keyboard input and apply it to a relevant UITextField, helping your app input data like phone numbers, addresses, and flight information. And we’ll explore how you can create a custom interface, extend other controls like UIImageViews to support this capability, and more.","type":"text"}]},"https://developer.apple.com/wwdc21/10259":{"checksum":null,"type":"download","identifier":"https:\/\/developer.apple.com\/wwdc21\/10259","url":"https:\/\/developer.apple.com\/wwdc21\/10259"},"doc://WWDCNotes/documentation/WWDCNotes":{"url":"\/documentation\/wwdcnotes","abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"role":"collection","kind":"symbol","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","images":[{"identifier":"WWDCNotes.png","type":"icon"}],"title":"WWDC Notes","type":"topic"},"doc://WWDCNotes/documentation/WWDCNotes/trav-ma":{"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/trav-ma","url":"\/documentation\/wwdcnotes\/trav-ma","role":"sampleCode","images":[{"identifier":"trav-ma.jpeg","type":"card"},{"identifier":"trav-ma.jpeg","type":"icon"}],"title":"Travis Ma (5 notes)","kind":"article","abstract":[{"type":"text","text":"Software Development Manager for IQVIA’s Mobile team in Arizona."}]},"https://www.travisma.me":{"title":"Blog","titleInlineContent":[{"type":"text","text":"Blog"}],"identifier":"https:\/\/www.travisma.me","url":"https:\/\/www.travisma.me","type":"link"}}}