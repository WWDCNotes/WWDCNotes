{"sampleCodeDownload":{"action":{"isActive":true,"overridingTitle":"Watch Video (42 min)","type":"reference","identifier":"https:\/\/developer.apple.com\/wwdc19\/420"},"kind":"sampleDownload"},"schemaVersion":{"major":0,"patch":0,"minor":3},"abstract":[{"text":"Apple’s open source toolset, Turi Create, recently added tasks for Core ML model creation including Drawing Classification and One-Shot Object Detection. Learn how to quickly use these capabilities in your apps as well as new techniques for visualizing and evaluating the performance of your custom models.","type":"text"}],"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-420-Drawing-Classification-and-OneShot-Object-Detection-in-Turi-Create","interfaceLanguage":"swift"},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19"]]},"metadata":{"title":"Drawing Classification and One-Shot Object Detection in Turi Create","role":"sampleCode","modules":[{"name":"WWDC Notes"}],"roleHeading":"WWDC19"},"kind":"article","primaryContentSections":[{"content":[{"level":2,"type":"heading","anchor":"Whats-Turi-Create","text":"What’s Turi Create?"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Turi Create is a Python library used for creating Core ML models. It has a simple, easy to use task-oriented API."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Tasks are our term for a collection of complex, machine learning algorithms abstracted away into a simple, easy to use solution for you to build your models."}]},{"type":"paragraph","inlineContent":[{"isActive":true,"identifier":"https:\/\/github.com\/apple\/turicreate","type":"reference"},{"text":".","type":"text"}]},{"level":2,"type":"heading","anchor":"How-to-create-a-CoreML-model","text":"How to create a CoreML model"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Five steps:"}]},{"items":[{"content":[{"inlineContent":[{"text":"Identify the task, aka what problem we’re trying to solve","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Collect data","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Train a model","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Test\/evaluate the model"}]}]},{"content":[{"inlineContent":[{"text":"Deploy the model","type":"text"}],"type":"paragraph"}]}],"type":"orderedList"},{"type":"paragraph","inlineContent":[{"text":"Here’s the code (in python):","type":"text"}]},{"syntax":"python","type":"codeListing","code":["import turicreate ","","\/\/ Load data ","data = turicreate.SFrame(\"ActivityData.sframe\")","train, test = data.random_split (0.8) ","","\/\/ Create a model ","model = turicreate.activity_classifier.create(train, ","","\/\/ Evaluate the model","metrics = model.evaluate(test) ","","\/\/ Export for deployment ","model.export_coreml(\"MyActivityClassifier.mlmodel\") "]},{"level":2,"type":"heading","anchor":"Task-types","text":"Task types"},{"type":"paragraph","inlineContent":[{"text":"| ","type":"text"},{"identifier":"WWDC19-420-oldTasks","type":"image"},{"text":" | ","type":"text"},{"identifier":"WWDC19-420-newTasks","type":"image"},{"text":" |","type":"text"},{"text":" ","type":"text"},{"text":"| Current | New |","type":"text"}]},{"level":2,"type":"heading","anchor":"One-Shot-Object-Detection","text":"One-Shot Object Detection"},{"type":"paragraph","inlineContent":[{"text":"The one-shot object detection is like object detection, but requires much less train data.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Let’s say that we want to detect objects like cards and logos with our camera. These features are 2D features:","type":"text"},{"text":"\n","type":"text"},{"text":"One-Shot Object Detection is able to take advantage of these characteristics of regularity and consistency to dramatically reduce the amount of data needed to build an accurate model.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Object Detection normal approach:"},{"type":"text","text":"\n"},{"type":"text","text":"Take plenty of pictures, annotate all the pics with the object location and tag said object:"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"WWDC19-420-cards"}]},{"type":"paragraph","inlineContent":[{"text":"One-shot approach:","type":"text"},{"text":" ","type":"text"},{"text":"One clear picture per class","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"WWDC19-420-cardsClear"}]},{"type":"paragraph","inlineContent":[{"text":"This works with a process called Synthetic Data Augmentation. Turi Create ships with a collection of images of the real world. The script takes the provided image and overlay onto these real-world images along with various color perturbations and distortions to simulate real world effects. The script also takes care of annotating these images.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"On the session demo the Turi script has created 2000 images per class (and annotate them etc).","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"One-shot vs traditional approach:","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"WWDC19-420-oneVStraditional"}]},{"level":2,"type":"heading","anchor":"Drawing-Classification","text":"Drawing Classification"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Drawing classification lets us use PencilKit input to train our model and recognize gestures."},{"type":"text","text":" "},{"type":"text","text":"In short PencilKit strokes recognition."}]},{"type":"paragraph","inlineContent":[{"text":"The Drawing Classification task can accept bitmap-based drawings, and stroke-based drawings.","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"CoreML has been optimized so that we need as few as 30 drawings per class."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Turi also offers a way to explore all the tests and see the results:"}]},{"type":"paragraph","inlineContent":[{"identifier":"WWDC19-420-results","type":"image"}]},{"type":"paragraph","inlineContent":[{"text":"This window has three sections:","type":"text"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"text":"Overview","type":"text"}],"type":"strong"},{"text":": gives us the overall accuracy of the model as well as the number of iterations in the model that we’ve trained, the Drawing Classifier model.","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Per Class breakdown"}]},{"type":"text","text":": breakdown of the metrics as well as a couple of example images that have been correctly been predicted by the model."}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Error section"}],"type":"strong"},{"text":": shows us all of the errors that the model has made.","type":"text"}]}]}]},{"level":2,"type":"heading","anchor":"Written-By","text":"Written By"},{"columns":[{"size":1,"content":[{"type":"paragraph","inlineContent":[{"identifier":"zntfdr","type":"image"}]}]},{"size":4,"content":[{"type":"heading","text":"Federico Zanetello","level":3,"anchor":"Federico-Zanetello"},{"type":"paragraph","inlineContent":[{"overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"type":"reference","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","isActive":true,"overridingTitle":"Contributed Notes"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","identifier":"https:\/\/github.com\/zntfdr","isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","identifier":"https:\/\/zntfdr.dev","isActive":true}]}]}],"type":"row","numberOfColumns":5},{"type":"paragraph","inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"type":"reference","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","isActive":true}]},{"level":2,"type":"heading","anchor":"Related-Sessions","text":"Related Sessions"},{"type":"links","style":"list","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-209-Whats-New-in-Machine-Learning","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-221-Introducing-PencilKit","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-424-Training-Object-Detection-Models-in-Create-ML","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-704-Core-ML-3-Framework"]},{"type":"small","inlineContent":[{"inlineContent":[{"text":"Legal Notice","type":"text"}],"type":"strong"}]},{"type":"small","inlineContent":[{"text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}]}],"kind":"content"}],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc19-420-drawing-classification-and-oneshot-object-detection-in-turi-create"]}],"sections":[],"references":{"WWDC19-420-oldTasks":{"alt":null,"identifier":"WWDC19-420-oldTasks","type":"image","variants":[{"url":"\/images\/WWDC19-420-oldTasks.png","traits":["1x","light"]}]},"WWDCNotes.png":{"alt":null,"identifier":"WWDCNotes.png","type":"image","variants":[{"url":"\/images\/WWDCNotes.png","traits":["1x","light"]}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-704-Core-ML-3-Framework":{"url":"\/documentation\/wwdcnotes\/wwdc19-704-core-ml-3-framework","abstract":[{"type":"text","text":"Core ML 3 now enables support for advanced model types that were never before available in on-device machine learning. Learn how model personalization brings amazing personalization opportunities to your app. Gain a deeper understanding of strategies for linking models and improvements to Core ML tools used for conversion of existing models."}],"role":"sampleCode","kind":"article","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-704-Core-ML-3-Framework","title":"Core ML 3 Framework"},"WWDC19.jpeg":{"alt":null,"identifier":"WWDC19.jpeg","type":"image","variants":[{"url":"\/images\/WWDC19.jpeg","traits":["1x","light"]}]},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"title":"Contributions are welcome!","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}],"url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"link"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19":{"url":"\/documentation\/wwdcnotes\/wwdc19","abstract":[{"type":"text","text":"Xcode 11, Swift 5.1, iOS 13, macOS 10.15 (Catalina), tvOS 13, watchOS 6."},{"type":"text","text":" "},{"type":"text","text":"New APIs: "},{"type":"codeVoice","code":"Combine"},{"type":"text","text":", "},{"type":"codeVoice","code":"Core Haptics"},{"type":"text","text":", "},{"type":"codeVoice","code":"Create ML"},{"type":"text","text":", and more."}],"role":"collectionGroup","kind":"article","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19","title":"WWDC19","images":[{"identifier":"WWDC19-Icon.png","type":"icon"},{"identifier":"WWDC19.jpeg","type":"card"}]},"WWDC19-420-cardsClear":{"alt":null,"identifier":"WWDC19-420-cardsClear","type":"image","variants":[{"url":"\/images\/WWDC19-420-cardsClear.png","traits":["1x","light"]}]},"WWDC19-420-results":{"alt":null,"identifier":"WWDC19-420-results","type":"image","variants":[{"url":"\/images\/WWDC19-420-results.png","traits":["1x","light"]}]},"WWDC19-420-cards":{"alt":null,"identifier":"WWDC19-420-cards","type":"image","variants":[{"url":"\/images\/WWDC19-420-cards.png","traits":["1x","light"]}]},"WWDC19-420-newTasks":{"alt":null,"identifier":"WWDC19-420-newTasks","type":"image","variants":[{"url":"\/images\/WWDC19-420-newTasks.png","traits":["1x","light"]}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-209-Whats-New-in-Machine-Learning":{"url":"\/documentation\/wwdcnotes\/wwdc19-209-whats-new-in-machine-learning","abstract":[{"type":"text","text":"Core ML 3 has been greatly expanded to enable even more amazing, on-device machine learning capabilities in your app. Learn about the new Create ML app which makes it easy to build Core ML models for many tasks. Get an overview of model personalization; exciting updates in Vision, Natural Language, Sound, and Speech; and added support for cutting-edge model types."}],"role":"sampleCode","kind":"article","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-209-Whats-New-in-Machine-Learning","title":"What’s New in Machine Learning"},"doc://WWDCNotes/documentation/WWDCNotes":{"title":"WWDC Notes","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","type":"topic","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"url":"\/documentation\/wwdcnotes","role":"collection","kind":"symbol","abstract":[{"type":"text","text":"Session notes shared by the community for the community."}]},"zntfdr":{"alt":"Profile image of Federico Zanetello","identifier":"zntfdr","type":"image","variants":[{"url":"\/images\/zntfdr.jpeg","traits":["1x","light"]}]},"https://zntfdr.dev":{"title":"Blog","titleInlineContent":[{"type":"text","text":"Blog"}],"url":"https:\/\/zntfdr.dev","identifier":"https:\/\/zntfdr.dev","type":"link"},"https://developer.apple.com/wwdc19/420":{"checksum":null,"url":"https:\/\/developer.apple.com\/wwdc19\/420","identifier":"https:\/\/developer.apple.com\/wwdc19\/420","type":"download"},"https://github.com/zntfdr":{"title":"GitHub","titleInlineContent":[{"type":"text","text":"GitHub"}],"url":"https:\/\/github.com\/zntfdr","identifier":"https:\/\/github.com\/zntfdr","type":"link"},"WWDC19-420-oneVStraditional":{"alt":null,"identifier":"WWDC19-420-oneVStraditional","type":"image","variants":[{"url":"\/images\/WWDC19-420-oneVStraditional.png","traits":["1x","light"]}]},"zntfdr.jpeg":{"alt":null,"identifier":"zntfdr.jpeg","type":"image","variants":[{"url":"\/images\/zntfdr.jpeg","traits":["1x","light"]}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-424-Training-Object-Detection-Models-in-Create-ML":{"role":"sampleCode","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-424-Training-Object-Detection-Models-in-Create-ML","url":"\/documentation\/wwdcnotes\/wwdc19-424-training-object-detection-models-in-create-ml","kind":"article","abstract":[{"text":"Custom Core ML models for Object Detection offer you an opportunity to add some real magic to your app. Learn how the Create ML app in Xcode makes it easy to train and evaluate these models. See how you can test the model performance directly within the app by taking advantage of Continuity Camera. It’s never been easier to build and deploy great Object Detection models for Core ML.","type":"text"}],"title":"Training Object Detection Models in Create ML"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-221-Introducing-PencilKit":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-221-Introducing-PencilKit","title":"Introducing PencilKit","url":"\/documentation\/wwdcnotes\/wwdc19-221-introducing-pencilkit","role":"sampleCode","kind":"article","abstract":[{"text":"Meet PencilKit, Apple’s feature-rich drawing and annotation framework. With just a few lines of code, you can add a full drawing experience to your app — with access to a canvas, responsive inks, rich tool palette and drawing model. Hear the technical details that make a great Apple Pencil experience. Learn about the new screenshot editor and how you can adopt just a few small APIs to enable your full content to be captured beyond the size of the screen, with or without your app’s user interface.","type":"text"}],"type":"topic"},"WWDC19-Icon.png":{"alt":null,"identifier":"WWDC19-Icon.png","type":"image","variants":[{"url":"\/images\/WWDC19-Icon.png","traits":["1x","light"]}]},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"url":"\/documentation\/wwdcnotes\/zntfdr","abstract":[{"type":"text","text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more."}],"role":"sampleCode","kind":"article","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","title":"Federico Zanetello (332 notes)","images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}]},"https://github.com/apple/turicreate":{"title":"Open source","titleInlineContent":[{"type":"text","text":"Open source"}],"url":"https:\/\/github.com\/apple\/turicreate","identifier":"https:\/\/github.com\/apple\/turicreate","type":"link"}}}