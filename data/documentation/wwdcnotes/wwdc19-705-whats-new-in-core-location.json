{"abstract":[{"text":"Location technologies are core to delivering context-based services within your app. Discover how the latest features in the Core Location Framework lay the groundwork for advanced ranging capabilities and delivers more options for you to clearly communicate your location needs to your users, and allow them to provide more granular access authorization to your app.","type":"text"}],"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc19-705-whats-new-in-core-location"],"traits":[{"interfaceLanguage":"swift"}]}],"schemaVersion":{"patch":0,"minor":3,"major":0},"sections":[],"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-705-Whats-New-in-Core-Location","interfaceLanguage":"swift"},"metadata":{"role":"sampleCode","title":"What’s New in Core Location","modules":[{"name":"WWDC Notes"}],"roleHeading":"WWDC19"},"kind":"article","sampleCodeDownload":{"kind":"sampleDownload","action":{"isActive":true,"overridingTitle":"Watch Video (35 min)","identifier":"https:\/\/developer.apple.com\/wwdc19\/705","type":"reference"}},"primaryContentSections":[{"kind":"content","content":[{"level":2,"anchor":"iOS-13-Authorization-Flow","type":"heading","text":"iOS 13 Authorization Flow"},{"inlineContent":[{"text":"New authorization flow for core location:","type":"text"},{"text":" ","type":"text"},{"text":"If the user presses not allow, that’s it (as before).","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"If we request ","type":"text"},{"inlineContent":[{"type":"text","text":"Always On"}],"type":"emphasis"},{"text":" authorization, ","type":"text"},{"type":"codeVoice","code":"locationManager.requestAlwaysAuthorization()"},{"text":", in iOS 13 the user gets this:","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"WWDC19-705-allowOnce"}],"type":"paragraph"},{"inlineContent":[{"text":"Therefore, regardless if we ask for ","type":"text"},{"type":"emphasis","inlineContent":[{"text":"when in use","type":"text"}]},{"text":" “only” or ","type":"text"},{"type":"emphasis","inlineContent":[{"text":"always","type":"text"}]},{"text":", this is the pop up that the user will get.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"However, if:"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The app has asked for "},{"inlineContent":[{"type":"text","text":"Always On"}],"type":"emphasis"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"The user has granted the most prominent option (","type":"text"},{"inlineContent":[{"text":"Allow While in Use","type":"text"}],"type":"emphasis"},{"text":", as seen in the screenshot above)","type":"text"}]}]}],"type":"unorderedList"},{"inlineContent":[{"type":"text","text":"At this point iOS will grant a provisional “"},{"type":"emphasis","inlineContent":[{"type":"text","text":"Always On"}]},{"type":"text","text":"” authorization to our app, even when the user has tapped "},{"type":"emphasis","inlineContent":[{"type":"text","text":"Allow While in Use"}]},{"type":"text","text":"."}],"type":"paragraph"},{"inlineContent":[{"text":"At this point the app can act as if the real ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"Always On authorization"}]},{"text":" has been granted.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"When something happens that would require the ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"Always On"}]},{"text":" authorization, ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"then and only then"}]},{"text":" iOS will request for that ","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"Always Allow"}]},{"text":" authorization in the app behalf:","type":"text"}],"type":"paragraph"},{"inlineContent":[{"identifier":"WWDC19-705-alwaysAllow","type":"image"}],"type":"paragraph"},{"inlineContent":[{"text":"Then, and only then, both the app and the user will be on the same page.","type":"text"}],"type":"paragraph"},{"level":2,"anchor":"New-in-iOS-13","type":"heading","text":"New in iOS 13"},{"inlineContent":[{"type":"text","text":"All core location APIs are available as long as any authorization is granted."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"From now on, the difference between “"},{"inlineContent":[{"text":"When In Use","type":"text"}],"type":"emphasis"},{"type":"text","text":"” and “"},{"inlineContent":[{"text":"Always","type":"text"}],"type":"emphasis"},{"type":"text","text":"” is that things can be started when the app is not in use if the “"},{"inlineContent":[{"text":"Allow Always","type":"text"}],"type":"emphasis"},{"type":"text","text":"” authorization has been granted."}],"type":"paragraph"},{"level":2,"anchor":"When-is-the-app-in-use","type":"heading","text":"When is the app in use?"},{"items":[{"content":[{"inlineContent":[{"text":"When the app is in the foreground and for a few seconds after it has been put in the background (grace period).","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"If we set to ","type":"text"},{"code":"true","type":"codeVoice"},{"text":" the location manager property ","type":"text"},{"code":"allowsBackgroundLocationUpdates","type":"codeVoice"},{"text":", our app will be considered in use even after the app has been put in the background, and the blue status bar indicator will appear.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Watch complications are considered always in use."}]}]}],"type":"unorderedList"},{"inlineContent":[{"text":"Therefore, from iOS 13, even apps with only “","type":"text"},{"type":"emphasis","inlineContent":[{"type":"text","text":"When In Use"}]},{"text":"” authorization can do background tracking.","type":"text"}],"type":"paragraph"},{"level":2,"anchor":"Allow-Once","type":"heading","text":"Allow Once"},{"inlineContent":[{"type":"text","text":"In iOS 13 ww also have a temporary "},{"inlineContent":[{"type":"text","text":"Allow Once"}],"type":"emphasis"},{"type":"text","text":" authorization:"},{"type":"text","text":"\n"},{"type":"text","text":"from the app point of view, this will become a “"},{"inlineContent":[{"type":"text","text":"When In Use"}],"type":"emphasis"},{"type":"text","text":"” grant until the app is no longer in use, after which the authorization will go back to the “"},{"inlineContent":[{"type":"text","text":"not determined"}],"type":"emphasis"},{"type":"text","text":"” status. After which the app can once again ask for authorization."}],"type":"paragraph"},{"level":2,"anchor":"Written-By","type":"heading","text":"Written By"},{"columns":[{"size":1,"content":[{"type":"paragraph","inlineContent":[{"identifier":"zntfdr","type":"image"}]}]},{"size":4,"content":[{"level":3,"text":"Federico Zanetello","anchor":"Federico-Zanetello","type":"heading"},{"inlineContent":[{"overridingTitle":"Contributed Notes","overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"isActive":true,"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"isActive":true,"identifier":"https:\/\/github.com\/zntfdr","type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"isActive":true,"identifier":"https:\/\/zntfdr.dev","type":"reference"}],"type":"paragraph"}]}],"numberOfColumns":5,"type":"row"},{"inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"type":"reference","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","isActive":true}],"type":"paragraph"},{"level":2,"anchor":"Related-Sessions","type":"heading","text":"Related Sessions"},{"items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10146-Meet-Core-Location-for-spatial-computing","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10140-Build-locationaware-enterprise-apps","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-236-Whats-New-in-MapKit-and-MapKit-JS"],"style":"list","type":"links"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Legal Notice"}],"type":"strong"}],"type":"small"},{"inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}],"type":"small"}]}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19"]]},"references":{"zntfdr.jpeg":{"type":"image","alt":null,"identifier":"zntfdr.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}]},"WWDCNotes.png":{"type":"image","alt":null,"identifier":"WWDCNotes.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19","images":[{"identifier":"WWDC19-Icon.png","type":"icon"},{"identifier":"WWDC19.jpeg","type":"card"}],"url":"\/documentation\/wwdcnotes\/wwdc19","type":"topic","kind":"article","abstract":[{"text":"Xcode 11, Swift 5.1, iOS 13, macOS 10.15 (Catalina), tvOS 13, watchOS 6.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"code":"Combine","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Core Haptics","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Create ML","type":"codeVoice"},{"text":", and more.","type":"text"}],"role":"collectionGroup","title":"WWDC19"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC20-10140-Build-locationaware-enterprise-apps":{"title":"Build location-aware enterprise apps","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10140-Build-locationaware-enterprise-apps","url":"\/documentation\/wwdcnotes\/wwdc20-10140-build-locationaware-enterprise-apps","role":"sampleCode","abstract":[{"type":"text","text":"Develop location-aware enterprise apps for your business and personalize your employee’s everyday experience. Learn how Apple built the Caffe Macs app for its on-campus cafeterias using iBeacons and Location Services and how you can apply these tools and frameworks to your own apps, while preserving employee privacy. From there, discover how you can use localization to deliver a great experience for your international employees."}],"type":"topic"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-236-Whats-New-in-MapKit-and-MapKit-JS":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-236-Whats-New-in-MapKit-and-MapKit-JS","role":"sampleCode","type":"topic","url":"\/documentation\/wwdcnotes\/wwdc19-236-whats-new-in-mapkit-and-mapkit-js","abstract":[{"text":"MapKit and MapKit JS bring fully featured Apple Maps to your app and website. See how the latest features give you more control over the base map presentation, finer-grained search and result filtering of points of interest and address information, and integration with standard data formats for custom overlays and annotations.","type":"text"}],"title":"What’s New in MapKit and MapKit JS","kind":"article"},"WWDC19-Icon.png":{"type":"image","alt":null,"identifier":"WWDC19-Icon.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19-Icon.png"}]},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"type":"link","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}],"title":"Contributions are welcome!"},"https://developer.apple.com/wwdc19/705":{"type":"download","identifier":"https:\/\/developer.apple.com\/wwdc19\/705","checksum":null,"url":"https:\/\/developer.apple.com\/wwdc19\/705"},"zntfdr":{"type":"image","alt":"Profile image of Federico Zanetello","identifier":"zntfdr","variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}]},"WWDC19.jpeg":{"type":"image","alt":null,"identifier":"WWDC19.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19.jpeg"}]},"https://zntfdr.dev":{"type":"link","identifier":"https:\/\/zntfdr.dev","url":"https:\/\/zntfdr.dev","titleInlineContent":[{"type":"text","text":"Blog"}],"title":"Blog"},"doc://WWDCNotes/documentation/WWDCNotes":{"abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"type":"topic","kind":"symbol","images":[{"identifier":"WWDCNotes.png","type":"icon"}],"title":"WWDC Notes","role":"collection","url":"\/documentation\/wwdcnotes","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes"},"WWDC19-705-allowOnce":{"type":"image","alt":null,"identifier":"WWDC19-705-allowOnce","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19-705-allowOnce.png"}]},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"type":"topic","url":"\/documentation\/wwdcnotes\/zntfdr","abstract":[{"type":"text","text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more."}],"kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","title":"Federico Zanetello (332 notes)","role":"sampleCode"},"WWDC19-705-alwaysAllow":{"type":"image","alt":null,"identifier":"WWDC19-705-alwaysAllow","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19-705-alwaysAllow.png"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10146-Meet-Core-Location-for-spatial-computing":{"title":"Meet Core Location for spatial computing","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10146-Meet-Core-Location-for-spatial-computing","url":"\/documentation\/wwdcnotes\/wwdc23-10146-meet-core-location-for-spatial-computing","kind":"article","type":"topic","abstract":[{"type":"text","text":"Discover how Core Location helps your app find its place in the world — literally. We’ll share how you can build a spatial computing app that uses a person’s location while respecting their privacy. You’ll also learn how your app can request location access and how Core Location adapts requests from compatible iPad and iPhone apps."}],"role":"sampleCode"},"https://github.com/zntfdr":{"type":"link","identifier":"https:\/\/github.com\/zntfdr","url":"https:\/\/github.com\/zntfdr","titleInlineContent":[{"type":"text","text":"GitHub"}],"title":"GitHub"}}}