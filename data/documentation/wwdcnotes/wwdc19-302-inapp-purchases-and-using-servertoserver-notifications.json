{"metadata":{"modules":[{"name":"WWDC Notes"}],"title":"In-App Purchases and Using Server-to-Server Notifications","roleHeading":"WWDC19","role":"sampleCode"},"kind":"article","sampleCodeDownload":{"action":{"type":"reference","identifier":"https:\/\/developer.apple.com\/wwdc19\/302","overridingTitle":"Watch Video (50 min)","isActive":true},"kind":"sampleDownload"},"abstract":[{"type":"text","text":"Learn about the latest updates in StoreKit and dive deep into best practices for using server-to-server notifications to manage your subscribers."}],"schemaVersion":{"minor":3,"patch":0,"major":0},"sections":[],"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-302-InApp-Purchases-and-Using-ServertoServer-Notifications","interfaceLanguage":"swift"},"primaryContentSections":[{"content":[{"type":"heading","level":2,"text":"Overview","anchor":"overview"},{"type":"paragraph","inlineContent":[{"text":"New ","type":"text"},{"code":"SKStoreFront","type":"codeVoice"},{"text":", it lets us know what country the user is from, we can use it to sell targeted things to that user.","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["if let sf = SKPaymentQueue.default().storefront { ","  ...","}"]},{"type":"paragraph","inlineContent":[{"text":"It can be nil (the presenter didn’t say how\/why).","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Use this to observe changes (e.g. when the user change store\/account)"}]},{"type":"codeListing","syntax":"swift","code":["\/\/MARK: - SKPaymentTransactionObserver methods ","","func paymentQueueDidChangeStorefront(_ queue: SKPaymentQueue) { ","  ...","}"]},{"type":"heading","level":2,"text":"Written By","anchor":"Written-By"},{"columns":[{"size":1,"content":[{"inlineContent":[{"type":"image","identifier":"zntfdr"}],"type":"paragraph"}]},{"size":4,"content":[{"text":"Federico Zanetello","type":"heading","level":3,"anchor":"Federico-Zanetello"},{"type":"paragraph","inlineContent":[{"isActive":true,"overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","overridingTitle":"Contributed Notes","type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"isActive":true,"identifier":"https:\/\/github.com\/zntfdr","type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"isActive":true,"identifier":"https:\/\/zntfdr.dev","type":"reference"}]}]}],"type":"row","numberOfColumns":5},{"type":"paragraph","inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference","isActive":true}]},{"type":"heading","level":2,"text":"Related Sessions","anchor":"Related-Sessions"},{"type":"links","style":"list","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10114-Meet-StoreKit-2","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10174-Manage-inapp-purchases-on-your-server","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10175-Support-customers-and-handle-refunds","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10661-Whats-new-with-inapp-purchase","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10671-Architecting-for-subscriptions","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-301-Whats-New-in-App-Store-Connect","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-706-Introducing-Sign-In-with-Apple"]},{"type":"small","inlineContent":[{"type":"strong","inlineContent":[{"text":"Legal Notice","type":"text"}]}]},{"type":"small","inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}]}],"kind":"content"}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19"]]},"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc19-302-inapp-purchases-and-using-servertoserver-notifications"],"traits":[{"interfaceLanguage":"swift"}]}],"references":{"https://developer.apple.com/wwdc19/302":{"checksum":null,"type":"download","url":"https:\/\/developer.apple.com\/wwdc19\/302","identifier":"https:\/\/developer.apple.com\/wwdc19\/302"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19":{"type":"topic","url":"\/documentation\/wwdcnotes\/wwdc19","images":[{"identifier":"WWDC19-Icon.png","type":"icon"},{"identifier":"WWDC19.jpeg","type":"card"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19","abstract":[{"text":"Xcode 11, Swift 5.1, iOS 13, macOS 10.15 (Catalina), tvOS 13, watchOS 6.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"code":"Combine","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Core Haptics","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Create ML","type":"codeVoice"},{"text":", and more.","type":"text"}],"title":"WWDC19","kind":"article","role":"collectionGroup"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-706-Introducing-Sign-In-with-Apple":{"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-706-Introducing-Sign-In-with-Apple","abstract":[{"text":"Sign In with Apple is the fast, easy way for people to sign in to apps using the Apple IDs they already have. Learn how easy it is to add a Sign In with Apple button to your app or website to acquire new customers and benefit from the built-in security, antifraud, and privacy that Sign In with Apple provides.","type":"text"}],"kind":"article","title":"Introducing Sign In with Apple","url":"\/documentation\/wwdcnotes\/wwdc19-706-introducing-sign-in-with-apple","role":"sampleCode"},"https://github.com/zntfdr":{"type":"link","url":"https:\/\/github.com\/zntfdr","title":"GitHub","titleInlineContent":[{"type":"text","text":"GitHub"}],"identifier":"https:\/\/github.com\/zntfdr"},"doc://WWDCNotes/documentation/WWDCNotes":{"role":"collection","type":"topic","url":"\/documentation\/wwdcnotes","abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"images":[{"identifier":"WWDCNotes.png","type":"icon"}],"kind":"symbol","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","title":"WWDC Notes"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC20-10671-Architecting-for-subscriptions":{"role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10671-Architecting-for-subscriptions","title":"Architecting for subscriptions","kind":"article","abstract":[{"text":"Learn how you can build simple entitlement logic to enhance the customer experience. We’ll dive deep into key concepts and provide guidance for architecting your systems to accurately entitle service. You’ll learn best practices for subscription features and how to craft the best customer experience throughout the subscription lifecycle.","type":"text"}],"type":"topic","url":"\/documentation\/wwdcnotes\/wwdc20-10671-architecting-for-subscriptions"},"zntfdr.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}],"type":"image","alt":null,"identifier":"zntfdr.jpeg"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"type":"link","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}],"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"WWDC19-Icon.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19-Icon.png"}],"type":"image","alt":null,"identifier":"WWDC19-Icon.png"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"type":"topic","url":"\/documentation\/wwdcnotes\/zntfdr","images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","abstract":[{"text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more.","type":"text"}],"title":"Federico Zanetello (332 notes)","kind":"article","role":"sampleCode"},"WWDC19.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19.jpeg"}],"type":"image","alt":null,"identifier":"WWDC19.jpeg"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10174-Manage-inapp-purchases-on-your-server":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10174-Manage-inapp-purchases-on-your-server","url":"\/documentation\/wwdcnotes\/wwdc21-10174-manage-inapp-purchases-on-your-server","role":"sampleCode","type":"topic","title":"Manage in-app purchases on your server","abstract":[{"type":"text","text":"Discover the latest updates to managing in-app purchases on your server. Explore how you can use servers to track status changes, handle refunds, and manage subscriber status. Learn about App Store server APIs around status and in-app purchase transactions, and find out how App Store server notifications can help you track more customer lifecycle events. We’ll also take you through managing Family Sharing for in-app purchases, and the latest improvements to testing in-app purchases in the sandbox environment."}],"kind":"article"},"https://zntfdr.dev":{"type":"link","url":"https:\/\/zntfdr.dev","title":"Blog","titleInlineContent":[{"type":"text","text":"Blog"}],"identifier":"https:\/\/zntfdr.dev"},"WWDCNotes.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"type":"image","alt":null,"identifier":"WWDCNotes.png"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10175-Support-customers-and-handle-refunds":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10175-Support-customers-and-handle-refunds","role":"sampleCode","kind":"article","url":"\/documentation\/wwdcnotes\/wwdc21-10175-support-customers-and-handle-refunds","type":"topic","abstract":[{"type":"text","text":"Great customer support is critical to running a successful business on the App Store. Discover how you can provide a frictionless support experience to customers who make in-app purchases, including APIs that make it easy for customers to manage or cancel their auto-renewable subscription, or request refunds from directly within your app. We’ll cover best practices for handling refunds, as well as additional APIs that can help you better support your customers."}],"title":"Support customers and handle refunds"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-301-Whats-New-in-App-Store-Connect":{"url":"\/documentation\/wwdcnotes\/wwdc19-301-whats-new-in-app-store-connect","kind":"article","role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-301-Whats-New-in-App-Store-Connect","type":"topic","title":"What’s New in App Store Connect","abstract":[{"text":"App Store Connect continues to improve its role in each step of your app’s lifecycle with new features that make your app submission, management, and distribution experience better than ever. Learn about the latest enhancements and discover new ways to ensure each release of your app is better than the last.","type":"text"}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC20-10661-Whats-new-with-inapp-purchase":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10661-Whats-new-with-inapp-purchase","url":"\/documentation\/wwdcnotes\/wwdc20-10661-whats-new-with-inapp-purchase","role":"sampleCode","type":"topic","title":"What’s new with in-app purchase","abstract":[{"type":"text","text":"Create a great in-app purchase experience for your iPhone, iPad, Mac, and Apple Watch apps. Discover how to handle refunds, integrate new App Store server notifications, and find out how to use receipts and server notifications to manage subscriber status. We’ll also walk you through the latest updates in StoreKit, including in-app purchases on Apple Watch, Family Sharing, SKOverlay, SKAdNetwork, and more."}],"kind":"article"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10114-Meet-StoreKit-2":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10114-Meet-StoreKit-2","url":"\/documentation\/wwdcnotes\/wwdc21-10114-meet-storekit-2","role":"sampleCode","type":"topic","title":"Meet StoreKit 2","abstract":[{"type":"text","text":"StoreKit 2 delivers powerful, Swift-native APIs for in-app purchases and auto-renewable subscriptions. Learn how you can easily implement in-app purchases and subscriptions, and discover APIs for retrieving product information, handling transactions, determining product entitlements and customer status, as well as comprehensive testing support in Xcode."}],"kind":"article"},"zntfdr":{"variants":[{"traits":["1x","light"],"url":"\/images\/zntfdr.jpeg"}],"type":"image","alt":"Profile image of Federico Zanetello","identifier":"zntfdr"}}}