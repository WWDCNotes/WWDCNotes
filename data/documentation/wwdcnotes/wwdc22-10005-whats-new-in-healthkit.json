{"metadata":{"modules":[{"name":"WWDC Notes"}],"roleHeading":"WWDC22","title":"What‚Äôs new in HealthKit","role":"sampleCode"},"sections":[],"abstract":[{"type":"text","text":"Bring the latest HealthKit features to your health & fitness app. We‚Äôll show you how to capture more detailed sleep data through sleep stages, track swim-bike-run and interval workouts with the enhanced Workout API, and save vision prescriptions ‚Äî including an image of the physical prescription ‚Äî directly to HealthKit while preserving privacy."}],"schemaVersion":{"patch":0,"major":0,"minor":3},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc22-10005-whats-new-in-healthkit"]}],"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-10005-Whats-new-in-HealthKit","interfaceLanguage":"swift"},"sampleCodeDownload":{"kind":"sampleDownload","action":{"type":"reference","isActive":true,"overridingTitle":"Watch Video (24 min)","identifier":"https:\/\/developer.apple.com\/wwdc22\/10005"}},"kind":"article","primaryContentSections":[{"kind":"content","content":[{"type":"heading","text":"Sleep analysis","level":2,"anchor":"Sleep-analysis"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Introducing sleep stages"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Apple Watch will automatically track all the different sleep stages you go through when you‚Äôre asleep"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"this data will be accessible from the Health app and saved in HealthKit"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"apps can read\/write sleep analysis data via "},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkcategorytypeidentifier\/1615425-sleepanalysis","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"three sleep stages: REM, core, deep","type":"text"}]}]}]},{"type":"codeListing","syntax":"swift","code":["public enum HKCategoryValueSleepAnalysis: Int {","  case inBed","  case asleep \/\/ ‚ùå removed","  case asleepUnspecified \/\/ üëàüèª Replaces asleep, used when user is asleep but no sleep stage is specified","  case awake","  case asleepCore \/\/ üëàüèª New","  case asleepDeep \/\/ üëàüèª New","  case asleepREM  \/\/ üëàüèª New","}"]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"new predicate ","type":"text"},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkcategoryvaluepredicateproviding","isActive":true},{"text":" to access HealthKit samples, for example:","type":"text"}]}]}]},{"type":"codeListing","syntax":"swift","code":["let stagePredicate = HKCategoryValueSleepAnalysis.predicateForSamples(.equalTo, value: .asleepREM)","let queryPredicate = HKSamplePredicate.sample(type: HKCategoryType(.sleepAnalysis), predicate: stagePredicate)","let sleepQuery = HKSampleQueryDescriptor(predicates: [queryPredicate], sortDescriptors: [])","","\/\/ Run the query","let sleepSamples = try async sleepQuery.result(for: healthStore) \/\/ üëàüèª available since iOS 15.4"]},{"type":"heading","text":"Swift async","level":2,"anchor":"Swift-async"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"available since iOS 15.4"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"see types that conform to the new ","type":"text"},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkasyncquery","isActive":true},{"text":" to see which queries support swift concurrency","type":"text"}]}]}]},{"type":"heading","text":"Workouts","level":2,"anchor":"Workouts"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"new workouts API in iOS 16 and watchOS 9 to make it possible to capture mixed activities workouts like ","type":"text"},{"type":"reference","identifier":"https:\/\/en.wikipedia.org\/wiki\/Triathlon","isActive":true}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"each activity is represented via one "},{"identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutactivity","type":"reference","isActive":true}]}]},{"content":[{"inlineContent":[{"text":"each ","type":"text"},{"code":"HKWorkoutActivity","type":"codeVoice"},{"text":" comes with","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"text":"its own ","type":"text"},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutconfiguration","type":"reference"},{"text":", which includes its activity type","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"an array of ","type":"text"},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutevent","type":"reference"}]}]}],"type":"unorderedList"}]},{"content":[{"inlineContent":[{"type":"text","text":"you can read statistics for each "},{"code":"HKWorkoutActivity","type":"codeVoice"},{"type":"text","text":" separately"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"workout activities are not required to be contiguous"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"between activities you can create a ","type":"text"},{"type":"codeVoice","code":"HKWorkoutActivity"},{"text":" with type ","type":"text"},{"identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutactivitytype\/transition","isActive":true,"type":"reference"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"all activities will be put together under the same "},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkout","isActive":true},{"type":"text","text":" object"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"new predicates for querying only a specific type of activity within workouts, e.g., ","type":"text"},{"identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkquery\/3929715-predicateforworkoutactivities","type":"reference","isActive":true}],"type":"paragraph"}]}]},{"type":"heading","text":"Heart rate recovery","level":3,"anchor":"Heart-rate-recovery"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"new Cardio Recovery data type ","type":"text"},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkquantitytypeidentifier\/3929728-heartraterecoveryoneminute","isActive":true}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"additional context can be added as metadata","type":"text"}]}]}]},{"type":"heading","text":"Vision prescriptions","level":2,"anchor":"Vision-prescriptions"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"from iOS 16, we can save glasses and contacts prescriptions in HealthKit"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkobjecttype\/3916014-visionprescriptiontype","isActive":true}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"optionally we can store digital copy of the physical prescription","type":"text"}]}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"new ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkvisionprescription"},{"text":" class, along with ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkglasseslensspecification"},{"text":" and ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkglassesprescription"},{"text":" specification objects","type":"text"}]}]}]},{"type":"heading","text":"Written By","level":2,"anchor":"Written-By"},{"type":"row","numberOfColumns":5,"columns":[{"size":1,"content":[{"inlineContent":[{"identifier":"zntfdr","type":"image"}],"type":"paragraph"}]},{"size":4,"content":[{"type":"heading","text":"Federico Zanetello","level":3,"anchor":"Federico-Zanetello"},{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"isActive":true,"type":"reference","overridingTitle":"Contributed Notes"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/github.com\/zntfdr","isActive":true,"type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/zntfdr.dev","isActive":true,"type":"reference"}]}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"type":"reference","isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"}]},{"type":"heading","text":"Related Sessions","level":2,"anchor":"Related-Sessions"},{"type":"small","inlineContent":[{"inlineContent":[{"text":"Legal Notice","type":"text"}],"type":"strong"}]},{"type":"small","inlineContent":[{"type":"text","text":"All content copyright ¬© 2012 ‚Äì 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}]}]}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22"]]},"references":{"WWDCNotes.png":{"identifier":"WWDCNotes.png","type":"image","alt":null,"variants":[{"url":"\/images\/WWDCNotes.png","traits":["1x","light"]}]},"https://developer.apple.com/documentation/healthkit/hkworkoutactivitytype/transition":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutactivitytype\/transition","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutactivitytype\/transition","type":"link","titleInlineContent":[{"code":"HKWorkoutActivityType.transition","type":"codeVoice"}],"title":"HKWorkoutActivityType.transition"},"https://github.com/zntfdr":{"url":"https:\/\/github.com\/zntfdr","identifier":"https:\/\/github.com\/zntfdr","type":"link","titleInlineContent":[{"text":"GitHub","type":"text"}],"title":"GitHub"},"zntfdr":{"identifier":"zntfdr","type":"image","alt":"Profile image of Federico Zanetello","variants":[{"url":"\/images\/zntfdr.jpeg","traits":["1x","light"]}]},"https://developer.apple.com/documentation/healthkit/hkworkoutactivity":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutactivity","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutactivity","type":"link","titleInlineContent":[{"code":"HKWorkoutActivity","type":"codeVoice"}],"title":"HKWorkoutActivity"},"https://developer.apple.com/documentation/healthkit/hkasyncquery":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkasyncquery","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkasyncquery","type":"link","titleInlineContent":[{"code":"HKAsyncQuery","type":"codeVoice"}],"title":"HKAsyncQuery"},"WWDC22.jpeg":{"identifier":"WWDC22.jpeg","type":"image","alt":null,"variants":[{"url":"\/images\/WWDC22.jpeg","traits":["1x","light"]}]},"https://developer.apple.com/wwdc22/10005":{"url":"https:\/\/developer.apple.com\/wwdc22\/10005","identifier":"https:\/\/developer.apple.com\/wwdc22\/10005","type":"download","checksum":null},"https://developer.apple.com/documentation/healthkit/hkworkoutevent":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutevent","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutevent","type":"link","titleInlineContent":[{"code":"HKWorkoutEvent","type":"codeVoice"}],"title":"HKWorkoutEvent"},"https://en.wikipedia.org/wiki/Triathlon":{"url":"https:\/\/en.wikipedia.org\/wiki\/Triathlon","identifier":"https:\/\/en.wikipedia.org\/wiki\/Triathlon","type":"link","titleInlineContent":[{"text":"triathlon","type":"text"}],"title":"triathlon"},"https://developer.apple.com/documentation/healthkit/hkworkoutconfiguration":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutconfiguration","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkoutconfiguration","type":"link","titleInlineContent":[{"code":"HKWorkoutConfiguration","type":"codeVoice"}],"title":"HKWorkoutConfiguration"},"https://developer.apple.com/documentation/healthkit/hkcategorytypeidentifier/1615425-sleepanalysis":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkcategorytypeidentifier\/1615425-sleepanalysis","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkcategorytypeidentifier\/1615425-sleepanalysis","type":"link","titleInlineContent":[{"code":"HKCategoryTypeIdentifier.sleepAnalysis","type":"codeVoice"}],"title":"HKCategoryTypeIdentifier.sleepAnalysis"},"https://developer.apple.com/documentation/healthkit/hkvisionprescription":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkvisionprescription","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkvisionprescription","type":"link","titleInlineContent":[{"code":"HKVisionPrescription","type":"codeVoice"}],"title":"HKVisionPrescription"},"https://developer.apple.com/documentation/healthkit/hkquantitytypeidentifier/3929728-heartraterecoveryoneminute":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkquantitytypeidentifier\/3929728-heartraterecoveryoneminute","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkquantitytypeidentifier\/3929728-heartraterecoveryoneminute","type":"link","titleInlineContent":[{"code":"HKQuantityTypeIdentifier.heartRateRecoveryOneMinute","type":"codeVoice"}],"title":"HKQuantityTypeIdentifier.heartRateRecoveryOneMinute"},"https://developer.apple.com/documentation/healthkit/hkobjecttype/3916014-visionprescriptiontype":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkobjecttype\/3916014-visionprescriptiontype","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkobjecttype\/3916014-visionprescriptiontype","type":"link","titleInlineContent":[{"code":"HKObjectType.visionPrescriptionType()","type":"codeVoice"}],"title":"HKObjectType.visionPrescriptionType()"},"doc://WWDCNotes/documentation/WWDCNotes":{"title":"WWDC Notes","url":"\/documentation\/wwdcnotes","images":[{"identifier":"WWDCNotes.png","type":"icon"}],"kind":"symbol","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","role":"collection","type":"topic"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22":{"title":"WWDC22","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22","abstract":[{"type":"text","text":"Xcode 14, Swift 5.7, iOS 16, macOS 13 (Ventura), tvOS 16, watchOS 9."},{"type":"text","text":" "},{"type":"text","text":"New APIs: "},{"type":"codeVoice","code":"WeatherKit"},{"type":"text","text":", "},{"type":"codeVoice","code":"ScreenCaptureKit"},{"type":"text","text":", "},{"type":"codeVoice","code":"Swift Regex"},{"type":"text","text":", and more."}],"kind":"article","url":"\/documentation\/wwdcnotes\/wwdc22","role":"collectionGroup","type":"topic","images":[{"type":"icon","identifier":"WWDC22-Icon.png"},{"type":"card","identifier":"WWDC22.jpeg"}]},"https://developer.apple.com/documentation/healthkit/hkcategoryvaluepredicateproviding":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkcategoryvaluepredicateproviding","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkcategoryvaluepredicateproviding","type":"link","titleInlineContent":[{"code":"HKCategoryValuePredicateProviding","type":"codeVoice"}],"title":"HKCategoryValuePredicateProviding"},"https://zntfdr.dev":{"url":"https:\/\/zntfdr.dev","identifier":"https:\/\/zntfdr.dev","type":"link","titleInlineContent":[{"text":"Blog","type":"text"}],"title":"Blog"},"zntfdr.jpeg":{"identifier":"zntfdr.jpeg","type":"image","alt":null,"variants":[{"url":"\/images\/zntfdr.jpeg","traits":["1x","light"]}]},"https://developer.apple.com/documentation/healthkit/hkquery/3929715-predicateforworkoutactivities":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkquery\/3929715-predicateforworkoutactivities","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkquery\/3929715-predicateforworkoutactivities","type":"link","titleInlineContent":[{"code":"predicateForWorkoutActivities(operatorType:quantityType:averageQuantity:)","type":"codeVoice"}],"title":"predicateForWorkoutActivities(operatorType:quantityType:averageQuantity:)"},"https://developer.apple.com/documentation/healthkit/hkglassesprescription":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkglassesprescription","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkglassesprescription","type":"link","titleInlineContent":[{"code":"HKGlassesPrescription","type":"codeVoice"}],"title":"HKGlassesPrescription"},"https://developer.apple.com/documentation/healthkit/hkglasseslensspecification":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkglasseslensspecification","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkglasseslensspecification","type":"link","titleInlineContent":[{"code":"HKGlassesLensSpecification","type":"codeVoice"}],"title":"HKGlassesLensSpecification"},"https://developer.apple.com/documentation/healthkit/hkworkout":{"url":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkout","identifier":"https:\/\/developer.apple.com\/documentation\/healthkit\/hkworkout","type":"link","titleInlineContent":[{"code":"HKWorkout","type":"codeVoice"}],"title":"HKWorkout"},"WWDC22-Icon.png":{"identifier":"WWDC22-Icon.png","type":"image","alt":null,"variants":[{"url":"\/images\/WWDC22-Icon.png","traits":["1x","light"]}]},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"link","titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"title":"Contributions are welcome!"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"type":"topic","kind":"article","images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"abstract":[{"text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more.","type":"text"}],"role":"sampleCode","title":"Federico Zanetello (332 notes)","url":"\/documentation\/wwdcnotes\/zntfdr","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr"}}}