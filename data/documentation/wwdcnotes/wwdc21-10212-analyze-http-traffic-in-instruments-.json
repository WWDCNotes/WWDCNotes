{"metadata":{"role":"sampleCode","roleHeading":"WWDC21","title":"Analyze HTTP traffic in Instruments","modules":[{"name":"WWDC Notes"}]},"sections":[],"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10212-Analyze-HTTP-traffic-in-Instruments-","interfaceLanguage":"swift"},"sampleCodeDownload":{"kind":"sampleDownload","action":{"identifier":"https:\/\/developer.apple.com\/wwdc21\/10212","overridingTitle":"Watch Video (33 min)","type":"reference","isActive":true}},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21"]]},"kind":"article","abstract":[{"text":"Learn to use the Instruments Network template to record and analyze your app‚Äôs HTTP traffic. We‚Äôll show you how to explore and visualize the behavior of sessions, tasks, and individual HTTP requests to ensure data is transmitted efficiently and respects people‚Äôs privacy.","type":"text"}],"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc21-10212-analyze-http-traffic-in-instruments-"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"kind":"content","content":[{"level":2,"text":"Track hierarchy","anchor":"Track-hierarchy","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"HTTP Traffic instruments"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Number of active tasks"}],"type":"paragraph"}]}]}]},{"content":[{"inlineContent":[{"text":"Process","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Debuggable process and background tasks daemon","type":"text"}]}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Session"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"One track per "},{"type":"codeVoice","code":"URLSession"},{"type":"text","text":" object"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Individual task intervals"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Configurable session name:"}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"code":["let session = URLSession(configuration: .default)","session.sessionDescription = \"Main Session\""],"syntax":"swift","type":"codeListing"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Domain"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Only task that requested in the domain"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"More detail about tasks"}]}]},{"content":[{"inlineContent":[{"text":"Individual transactions","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Transaction states","type":"text"}],"type":"paragraph"}]}]}]}],"type":"unorderedList"},{"level":2,"text":"Task timing","anchor":"Task-timing","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Structural timing from start till the end","type":"text"}]}]}],"type":"unorderedList"},{"code":["let task = session.dataTask(with: url) {","  \/* handle result *\/ \/\/ üëàüèª Complete event triggers here","}","","task.resume() \/\/ üëàüèª Resume event triggers here"],"syntax":null,"type":"codeListing"},{"level":2,"text":"Task Identifier","anchor":"Task-Identifier","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Ability to read the "},{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/nsurlsessiontask\/1411231-taskidentifier"},{"type":"text","text":" for clarity"}]}]}],"type":"unorderedList"},{"code":["let task = session.dataTask(with: url) {","  \/* handle result *\/","}","task.taskDescription = \"Load Thumbnail\"","task.resume()","task.taskIdentifier \/\/ üëàüèª this identifier will be shown in instruments"],"syntax":"swift","type":"codeListing"},{"level":2,"text":"Task Error","anchor":"Task-Error","type":"heading"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Ability to distinguish error and success with color"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":2,"text":"Transactions","anchor":"Transactions","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Request + response pair being handled by the URL Loading system","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Contains all the HTTP Layer information","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"URL, Http version, connection, cache info"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Request + Response header","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Request + Response body","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"And more","type":"text"}]}]}],"type":"unorderedList"},{"level":2,"text":"Transaction states","anchor":"Transaction-states","type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Multiple states to add information for distinction between each block"}]}]}],"type":"unorderedList"},{"inlineContent":[{"identifier":"WWDC21-10212-8","type":"image"}],"type":"paragraph"},{"level":2,"text":"Instrument","type":"heading","anchor":"Instrument"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Focus on the task description"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"type":"image","identifier":"WWDC21-10212-11"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Expand the task description"}]}]}],"type":"unorderedList"},{"inlineContent":[{"type":"image","identifier":"WWDC21-10212-12"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Filter by connection"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"identifier":"WWDC21-10212-13","type":"image"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Identify the http task issues (Ex: Staircase problem)"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"identifier":"WWDC21-10212-14","type":"image"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Identify the request (Ex: wrong expiration date of cookie)"}]}]}],"type":"unorderedList"},{"inlineContent":[{"identifier":"WWDC21-10212-15","type":"image"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Identify the backtrace (Ex: cached response)"}]}]}],"type":"unorderedList"},{"inlineContent":[{"type":"image","identifier":"WWDC21-10212-16"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Filter the session (Ex: Found an issue with the data that sent to server)"}]}]}],"type":"unorderedList"},{"inlineContent":[{"identifier":"WWDC21-10212-17","type":"image"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Export the report to .har extension"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"identifier":"WWDC21-10212-18","type":"image"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Output"}]}]},{"content":[{"inlineContent":[{"text":"Save and export report to .har to analyse issues","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":".har is a JSON structure"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"identifier":"WWDC21-10212-19","type":"image"}],"type":"paragraph"},{"level":2,"text":"Next Steps","type":"heading","anchor":"Next-Steps"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Target app  today to detect problems"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Name your URL Session and URLSessionTask for easier debugging","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Adopt latest networking protocols"}]}]},{"content":[{"inlineContent":[{"text":"Audit your app requests to check if can send less information","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"level":2,"text":"Written By","type":"heading","anchor":"Written-By"},{"columns":[{"content":[{"type":"paragraph","inlineContent":[{"type":"image","identifier":"abadikaka"}]}],"size":1},{"content":[{"anchor":"Michael-Abadi-Santoso","level":3,"type":"heading","text":"Michael Abadi Santoso"},{"inlineContent":[{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/abadikaka","isActive":true,"overridingTitle":"Contributed Notes","type":"reference","overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}]},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/github.com\/abadikaka","isActive":true,"type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/michaelabadi.com","isActive":true,"type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/x.com\/michaelabadiii","isActive":true,"type":"reference"}],"type":"paragraph"}],"size":4}],"type":"row","numberOfColumns":5},{"inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"isActive":true,"identifier":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","type":"reference"}],"type":"paragraph"},{"level":2,"text":"Related Sessions","type":"heading","anchor":"Related-Sessions"},{"style":"list","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10170-Beyond-the-basics-of-structured-concurrency","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10085-Apples-privacy-pillars-in-focus","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10094-Accelerate-networking-with-HTTP3-and-QUIC","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10095-Use-asyncawait-with-URLSession","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10239-Reduce-network-delays-for-your-app","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-411-Getting-Started-with-Instruments"],"type":"links"},{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Legal Notice"}]}],"type":"small"},{"inlineContent":[{"type":"text","text":"All content copyright ¬© 2012 ‚Äì 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}],"type":"small"}]}],"schemaVersion":{"minor":3,"patch":0,"major":0},"references":{"WWDC21.jpeg":{"alt":null,"identifier":"WWDC21.jpeg","variants":[{"url":"\/images\/WWDC21.jpeg","traits":["1x","light"]}],"type":"image"},"WWDC21-10212-13":{"alt":"Filter task","identifier":"WWDC21-10212-13","variants":[{"url":"\/images\/WWDC21-10212-13.png","traits":["1x","light"]}],"type":"image"},"WWDC21-10212-12":{"alt":"Expand task description","identifier":"WWDC21-10212-12","variants":[{"url":"\/images\/WWDC21-10212-12.png","traits":["1x","light"]}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10170-Beyond-the-basics-of-structured-concurrency":{"abstract":[{"text":"It‚Äôs all about the task tree: Find out how structured concurrency can help your apps manage automatic task cancellation, task priority propagation, and useful task-local value patterns. Learn how to manage resources in your app with useful patterns and the latest task group APIs. We‚Äôll show you how you can leverage the power of the task tree and task-local values to gain insight into distributed systems.","type":"text"}],"kind":"article","role":"sampleCode","url":"\/documentation\/wwdcnotes\/wwdc23-10170-beyond-the-basics-of-structured-concurrency","title":"Beyond the basics of structured concurrency","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10170-Beyond-the-basics-of-structured-concurrency","type":"topic"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21":{"type":"topic","role":"collectionGroup","title":"WWDC21","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21","url":"\/documentation\/wwdcnotes\/wwdc21","abstract":[{"type":"text","text":"Xcode 13, Swift 5.5, iOS 15, macOS 12 (Monterey), tvOS 15, watchOS 8."},{"type":"text","text":" "},{"type":"text","text":"New APIs: "},{"type":"codeVoice","code":"MusicKit"},{"type":"text","text":", "},{"type":"codeVoice","code":"DocC"},{"type":"text","text":", "},{"type":"codeVoice","code":"StoreKit 2"},{"type":"text","text":", and more."}],"images":[{"type":"icon","identifier":"WWDC21-Icon.png"},{"type":"card","identifier":"WWDC21.jpeg"}],"kind":"article"},"https://github.com/abadikaka":{"titleInlineContent":[{"type":"text","text":"GitHub"}],"url":"https:\/\/github.com\/abadikaka","title":"GitHub","identifier":"https:\/\/github.com\/abadikaka","type":"link"},"https://x.com/michaelabadiii":{"titleInlineContent":[{"text":"X\/Twitter","type":"text"}],"url":"https:\/\/x.com\/michaelabadiii","title":"X\/Twitter","identifier":"https:\/\/x.com\/michaelabadiii","type":"link"},"WWDC21-Icon.png":{"alt":null,"identifier":"WWDC21-Icon.png","variants":[{"url":"\/images\/WWDC21-Icon.png","traits":["1x","light"]}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes":{"type":"topic","title":"WWDC Notes","images":[{"identifier":"WWDCNotes.png","type":"icon"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"kind":"symbol","url":"\/documentation\/wwdcnotes","role":"collection"},"https://developer.apple.com/documentation/foundation/nsurlsessiontask/1411231-taskidentifier":{"titleInlineContent":[{"text":"task identifier","type":"text"}],"url":"https:\/\/developer.apple.com\/documentation\/foundation\/nsurlsessiontask\/1411231-taskidentifier","title":"task identifier","identifier":"https:\/\/developer.apple.com\/documentation\/foundation\/nsurlsessiontask\/1411231-taskidentifier","type":"link"},"WWDC21-10212-8":{"alt":"States","identifier":"WWDC21-10212-8","variants":[{"url":"\/images\/WWDC21-10212-8.png","traits":["1x","light"]}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10095-Use-asyncawait-with-URLSession":{"kind":"article","title":"Use async\/await with URLSession","abstract":[{"text":"Discover how you can adopt Swift concurrency in URLSession using async\/await and AsyncSequence, and how you can apply Swift concurrency concepts to improve your networking code.","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10095-Use-asyncawait-with-URLSession","url":"\/documentation\/wwdcnotes\/wwdc21-10095-use-asyncawait-with-urlsession","type":"topic","role":"sampleCode"},"WWDCNotes.png":{"alt":null,"identifier":"WWDCNotes.png","variants":[{"url":"\/images\/WWDCNotes.png","traits":["1x","light"]}],"type":"image"},"abadikaka.jpeg":{"alt":null,"identifier":"abadikaka.jpeg","variants":[{"url":"\/images\/abadikaka.jpeg","traits":["1x","light"]}],"type":"image"},"https://wwdcnotes.github.io/WWDCNotes/documentation/wwdcnotes/contributing":{"titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"url":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!","identifier":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","type":"link"},"https://michaelabadi.com":{"titleInlineContent":[{"type":"text","text":"Blog"}],"url":"https:\/\/michaelabadi.com","title":"Blog","identifier":"https:\/\/michaelabadi.com","type":"link"},"abadikaka":{"alt":"Profile image of Michael Abadi Santoso","identifier":"abadikaka","variants":[{"url":"\/images\/abadikaka.jpeg","traits":["1x","light"]}],"type":"image"},"WWDC21-10212-14":{"alt":"Problem","identifier":"WWDC21-10212-14","variants":[{"url":"\/images\/WWDC21-10212-14.png","traits":["1x","light"]}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/abadikaka":{"images":[{"type":"card","identifier":"abadikaka.jpeg"},{"type":"icon","identifier":"abadikaka.jpeg"}],"abstract":[{"type":"text","text":"iOS Engineer"}],"title":"Michael Abadi Santoso (7 notes)","type":"topic","role":"sampleCode","url":"\/documentation\/wwdcnotes\/abadikaka","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/abadikaka","kind":"article"},"WWDC21-10212-15":{"alt":"Problem 1","identifier":"WWDC21-10212-15","variants":[{"url":"\/images\/WWDC21-10212-15.png","traits":["1x","light"]}],"type":"image"},"WWDC21-10212-17":{"alt":"Problem 3","identifier":"WWDC21-10212-17","variants":[{"url":"\/images\/WWDC21-10212-17.png","traits":["1x","light"]}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-411-Getting-Started-with-Instruments":{"title":"Getting Started with Instruments","abstract":[{"text":"The Instruments app in Xcode provides a rich set of tools and templates for profiling your app performance. Learn all about Instruments and gain strategies for identifying bottlenecks in your code. See just how to leverage the power of time profiling and points of interest tracking to make meaningful changes to your code that can dramatically improve app responsiveness.","type":"text"}],"type":"topic","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-411-Getting-Started-with-Instruments","url":"\/documentation\/wwdcnotes\/wwdc19-411-getting-started-with-instruments","role":"sampleCode"},"WWDC21-10212-11":{"alt":"Focus on the task description","identifier":"WWDC21-10212-11","variants":[{"url":"\/images\/WWDC21-10212-11.png","traits":["1x","light"]}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10239-Reduce-network-delays-for-your-app":{"type":"topic","url":"\/documentation\/wwdcnotes\/wwdc21-10239-reduce-network-delays-for-your-app","kind":"article","role":"sampleCode","abstract":[{"type":"text","text":"CPU performance and network throughput rates keep improving, but the speed of light is one limit that isn‚Äôt going any higher. Learn the APIs and best practices to maximize your app‚Äôs responsiveness and efficiency by keeping network round-trip times low and minimizing the number of round trips when performing network operations."}],"title":"Reduce network delays for your app","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10239-Reduce-network-delays-for-your-app"},"WWDC21-10212-16":{"alt":"Problem 2","identifier":"WWDC21-10212-16","variants":[{"url":"\/images\/WWDC21-10212-16.png","traits":["1x","light"]}],"type":"image"},"https://developer.apple.com/wwdc21/10212":{"url":"https:\/\/developer.apple.com\/wwdc21\/10212","identifier":"https:\/\/developer.apple.com\/wwdc21\/10212","checksum":null,"type":"download"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10085-Apples-privacy-pillars-in-focus":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10085-Apples-privacy-pillars-in-focus","type":"topic","title":"Apple‚Äôs privacy pillars in focus","url":"\/documentation\/wwdcnotes\/wwdc21-10085-apples-privacy-pillars-in-focus","abstract":[{"type":"text","text":"At Apple, we believe that privacy is a fundamental human right. Learn about our four pillars of privacy, how we brought these principles together to design iCloud Private Relay, and how you can approach building privacy in your app in line with those fundamentals. Explore how you can build data minimization, on-device processing, transparency and control, and security protections right into your app."}],"role":"sampleCode","kind":"article"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10094-Accelerate-networking-with-HTTP3-and-QUIC":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10094-Accelerate-networking-with-HTTP3-and-QUIC","url":"\/documentation\/wwdcnotes\/wwdc21-10094-accelerate-networking-with-http3-and-quic","title":"Accelerate networking with HTTP\/3 and QUIC","role":"sampleCode","type":"topic","abstract":[{"type":"text","text":"The web is changing, and the next major version of HTTP is here. Learn how HTTP\/3 reduces latency and improves reliability for your app and discover how its underlying transport, QUIC, unlocks new innovations in your own custom protocols using new transport functionality and multi-streaming connection groups."}],"kind":"article"},"WWDC21-10212-19":{"alt":"JSON","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC21-10212-19.png"}],"type":"image","identifier":"WWDC21-10212-19"},"WWDC21-10212-18":{"alt":"Export","variants":[{"url":"\/images\/WWDC21-10212-18.png","traits":["1x","light"]}],"type":"image","identifier":"WWDC21-10212-18"}}}