{"kind":"article","sections":[],"metadata":{"title":"Modernizing Grand Central Dispatch Usage","modules":[{"name":"WWDC Notes"}],"roleHeading":"WWDC17","role":"sampleCode"},"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc17-706-modernizing-grand-central-dispatch-usage"],"traits":[{"interfaceLanguage":"swift"}]}],"abstract":[{"type":"text","text":"macOS 10.13 and iOS 11 have reinvented how Grand Central Dispatch and the Darwin kernel collaborate, enabling your applications to run concurrent workloads more efficiently. Learn how to modernize your code to take advantage of these improvements and make optimal use of hardware resources."}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC17-706-Modernizing-Grand-Central-Dispatch-Usage"},"primaryContentSections":[{"kind":"content","content":[{"type":"heading","level":2,"text":"Overview","anchor":"overview"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Create a small amount of queues. ","type":"text"},{"type":"strong","inlineContent":[{"type":"text","text":"One queue per subsystem is recommended."}]},{"text":" For example, database queue, network queue.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Do not create a large number of queues, use target_queue to set up queue hierarchy instead.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Do not change priority, target_queue nor qos"}]},{"type":"text","text":", after queue is created. It changes queue behavior, which then turn off all optimizations."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Too many work submitted to a concurrent queue, can cause "},{"inlineContent":[{"type":"text","text":"thread explosion"}],"type":"strong"},{"type":"text","text":". Solve this by using a serial queue instead."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Taking advantages of parallelization, divide work into multiple chunks. Too small chunk, more context switching overhead. Too large chunk, less CPU utilization (more cpu idle time). Size your work appropriately."}]}]},{"content":[{"inlineContent":[{"text":"Choose good granularity of concurrency","type":"text"}],"type":"paragraph"}]}]},{"type":"heading","level":2,"text":"Written By","anchor":"Written-By"},{"type":"row","numberOfColumns":5,"columns":[{"size":1,"content":[{"inlineContent":[{"type":"image","identifier":"zntfdr"}],"type":"paragraph"}]},{"size":4,"content":[{"type":"heading","level":3,"text":"Federico Zanetello","anchor":"Federico-Zanetello"},{"inlineContent":[{"type":"reference","isActive":true,"overridingTitle":"Contributed Notes","overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/zntfdr"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"https:\/\/zntfdr.dev"}],"type":"paragraph"}]}]},{"type":"thematicBreak"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"type":"reference","isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"}]},{"type":"heading","level":2,"text":"Related Sessions","anchor":"Related-Sessions"},{"style":"list","type":"links","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10254-Swift-concurrency-Behind-the-scenes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10258-Understand-and-eliminate-hangs-from-your-app","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-221-Introducing-PencilKit"]},{"type":"small","inlineContent":[{"inlineContent":[{"type":"text","text":"Legal Notice"}],"type":"strong"}]},{"type":"small","inlineContent":[{"text":"All content copyright © 2012 – 2025 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}]}]}],"schemaVersion":{"minor":3,"major":0,"patch":0},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC17"]]},"sampleCodeDownload":{"kind":"sampleDownload","action":{"type":"reference","overridingTitle":"Watch Video (54 min)","isActive":true,"identifier":"https:\/\/developer.apple.com\/wwdc17\/706"}},"references":{"https://developer.apple.com/wwdc17/706":{"url":"https:\/\/developer.apple.com\/wwdc17\/706","checksum":null,"type":"download","identifier":"https:\/\/developer.apple.com\/wwdc17\/706"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC17":{"type":"topic","kind":"article","role":"collectionGroup","images":[{"identifier":"WWDC17-Icon.png","type":"icon"},{"identifier":"WWDC17.jpeg","type":"card"}],"title":"WWDC17","url":"\/documentation\/wwdcnotes\/wwdc17","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC17","abstract":[{"text":"Xcode 9, Swift 4.0, iOS 11, macOS 10.13 (High Sierra), tvOS 11, watchOS 4.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"code":"Core NFC","type":"codeVoice"},{"text":" and more.","type":"text"}]},"https://github.com/zntfdr":{"url":"https:\/\/github.com\/zntfdr","title":"GitHub","type":"link","titleInlineContent":[{"text":"GitHub","type":"text"}],"identifier":"https:\/\/github.com\/zntfdr"},"WWDCNotes.png":{"alt":null,"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDCNotes.png"}],"identifier":"WWDCNotes.png"},"WWDC17.jpeg":{"identifier":"WWDC17.jpeg","alt":null,"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC17.jpeg"}]},"WWDC17-Icon.png":{"alt":null,"variants":[{"url":"\/images\/WWDCNotes\/WWDC17-Icon.png","traits":["1x","light"]}],"type":"image","identifier":"WWDC17-Icon.png"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10254-Swift-concurrency-Behind-the-scenes":{"abstract":[{"type":"text","text":"Dive into the details of Swift concurrency and discover how Swift provides greater safety from data races and thread explosion while simultaneously improving performance. We’ll explore how Swift tasks differ from Grand Central Dispatch, how the new cooperative threading model works, and how to ensure the best performance for your apps."}],"title":"Swift concurrency: Behind the scenes","type":"topic","url":"\/documentation\/wwdcnotes\/wwdc21-10254-swift-concurrency-behind-the-scenes","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10254-Swift-concurrency-Behind-the-scenes","role":"sampleCode"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"title":"Contributions are welcome!","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"type":"link","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-221-Introducing-PencilKit":{"title":"Introducing PencilKit","url":"\/documentation\/wwdcnotes\/wwdc19-221-introducing-pencilkit","kind":"article","abstract":[{"text":"Meet PencilKit, Apple’s feature-rich drawing and annotation framework. With just a few lines of code, you can add a full drawing experience to your app — with access to a canvas, responsive inks, rich tool palette and drawing model. Hear the technical details that make a great Apple Pencil experience. Learn about the new screenshot editor and how you can adopt just a few small APIs to enable your full content to be captured beyond the size of the screen, with or without your app’s user interface.","type":"text"}],"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-221-Introducing-PencilKit","role":"sampleCode"},"zntfdr.jpeg":{"identifier":"zntfdr.jpeg","alt":null,"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/zntfdr.jpeg"}]},"doc://WWDCNotes/documentation/WWDCNotes":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","type":"topic","url":"\/documentation\/wwdcnotes","role":"collection","kind":"symbol","abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"title":"WWDC Notes","images":[{"type":"icon","identifier":"WWDCNotes.png"}]},"zntfdr":{"alt":"Profile image of Federico Zanetello","variants":[{"url":"\/images\/WWDCNotes\/zntfdr.jpeg","traits":["1x","light"]}],"type":"image","identifier":"zntfdr"},"https://zntfdr.dev":{"title":"Blog","url":"https:\/\/zntfdr.dev","titleInlineContent":[{"text":"Blog","type":"text"}],"type":"link","identifier":"https:\/\/zntfdr.dev"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"kind":"article","role":"sampleCode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","abstract":[{"text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more.","type":"text"}],"images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"url":"\/documentation\/wwdcnotes\/zntfdr","type":"topic","title":"Federico Zanetello (332 notes)"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC21-10258-Understand-and-eliminate-hangs-from-your-app":{"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC21-10258-Understand-and-eliminate-hangs-from-your-app","abstract":[{"text":"Discover how you can track down hangs and delays in your app. We’ll show you tools and methods to discover hangs and their causes, learn about anti-patterns that can lead to hangs, explore best practices for eliminating hangs like GCD, and provide guidance on when you should consider asynchronous code to improve your app performance.","type":"text"}],"role":"sampleCode","title":"Understand and eliminate hangs from your app","url":"\/documentation\/wwdcnotes\/wwdc21-10258-understand-and-eliminate-hangs-from-your-app","kind":"article"}}}