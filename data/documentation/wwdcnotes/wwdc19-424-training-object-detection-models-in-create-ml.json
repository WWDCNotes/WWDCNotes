{"abstract":[{"text":"Custom Core ML models for Object Detection offer you an opportunity to add some real magic to your app. Learn how the Create ML app in Xcode makes it easy to train and evaluate these models. See how you can test the model performance directly within the app by taking advantage of Continuity Camera. It’s never been easier to build and deploy great Object Detection models for Core ML.","type":"text"}],"schemaVersion":{"patch":0,"minor":3,"major":0},"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc19-424-training-object-detection-models-in-create-ml"],"traits":[{"interfaceLanguage":"swift"}]}],"sections":[],"sampleCodeDownload":{"kind":"sampleDownload","action":{"isActive":true,"identifier":"https:\/\/developer.apple.com\/wwdc19\/424","type":"reference","overridingTitle":"Watch Video (15 min)"}},"kind":"article","hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19"]]},"primaryContentSections":[{"kind":"content","content":[{"level":2,"text":"Image Object Detection","type":"heading","anchor":"Image-Object-Detection"},{"inlineContent":[{"text":"Image object detection enables our applications to identify real-world objects captured by your device’s camera, and respond based on their presence, position, and relationship.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"emphasis","inlineContent":[{"text":"”you can teach your application about the subtle differences between individual animals, hand gestures, street signs, or game tokens.“","type":"text"}]}],"type":"paragraph"},{"inlineContent":[{"type":"emphasis","inlineContent":[{"type":"text","text":"“Image object detection can identify multiple objects within your photograph, and provide the location, size, and label for each one”"}]}],"type":"paragraph"},{"inlineContent":[{"identifier":"WWDC19-424-dog","type":"image"}],"type":"paragraph"},{"level":2,"text":"Training","type":"heading","anchor":"Training"},{"inlineContent":[{"text":"To train an object detector, you need to annotate each image with labeled regions that you would like the model to recognize.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"The bounding box for your annotated objects starting at the center of each object of interest and having a size, height, and width, this is measured in pixels from the top left-hand corner of your image to the center of each object of interest."}],"type":"paragraph"},{"inlineContent":[{"text":"You bundle together all of these annotations, label, position, and size, in a JSON file in a given format.","type":"text"}],"type":"paragraph"},{"content":[{"inlineContent":[{"type":"text","text":"The more training images, the more the training phase will take."},{"type":"text","text":"\n"},{"type":"text","text":"The example in the session had slightly over 1000 images and the speaker said that  "},{"type":"emphasis","inlineContent":[{"text":"“I estimate this is probably going to take an hour or more”","type":"text"}]},{"type":"text","text":". Therefore be warned before doing such GPU-heavy computation on your MacBook on the go."}],"type":"paragraph"}],"type":"aside","name":"Note","style":"note"},{"inlineContent":[{"type":"image","identifier":"WWDC19-424-training"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Looking at the screenshot of Create ML above, we have some numbers in the tabs on the top:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"6","type":"text"}]},{"type":"text","text":": number of different classes in our model"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"inlineContent":[{"text":"92%","type":"text"}],"type":"strong"},{"type":"text","text":": overall performance based on our input."}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"In the training tab we can see our ","type":"text"},{"isActive":true,"identifier":"https:\/\/en.wikipedia.org\/wiki\/Loss_function","type":"reference"},{"text":", ","type":"text"},{"isActive":true,"identifier":"https:\/\/developers.google.com\/machine-learning\/crash-course\/descending-into-ml\/training-and-loss","type":"reference"},{"text":".","type":"text"}]}]}]},{"inlineContent":[{"type":"text","text":"Below the loss chart, we see the accuracy for each class."}],"type":"paragraph"},{"inlineContent":[{"text":"We should strive to have a similar accuracy on all classes.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"inlineContent":[{"text":"“We also want to have a look and check that we have consistent performance across all of the classes”","type":"text"}],"type":"emphasis"}],"type":"paragraph"},{"inlineContent":[{"text":"This is important because it shows that it is performing equally well, for example, in recognizing all six sides of a dice:","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"WWDC19-424-accuracy"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"After training, we can test our model by clicking on the output tab:"}],"type":"paragraph"},{"inlineContent":[{"type":"image","identifier":"WWDC19-424-output"}],"type":"paragraph"},{"inlineContent":[{"text":"We can import an image directly from the iPhone camera, too (for testing).","type":"text"}],"type":"paragraph"},{"level":2,"text":"Training best practices","type":"heading","anchor":"Training-best-practices"},{"level":3,"text":"Balanced","type":"heading","anchor":"Balanced"},{"inlineContent":[{"text":"We should have a balanced number of images with annotations for each class:","type":"text"},{"text":"\n","type":"text"},{"text":"this tells the algorithm that we consider each of these to be equally important, and we can build a model which performs equally well on all of the classes.","type":"text"}],"type":"paragraph"},{"level":3,"text":"Quantity","type":"heading","anchor":"Quantity"},{"inlineContent":[{"text":"We are going to need a bunch of images:","type":"text"},{"text":"\n","type":"text"},{"text":"Apple recommends to start with 30 images with annotations for each class we want the model to recognize, and increase that number if the find performance isn’t good enough, or if the subjects are particularly complicated.","type":"text"}],"type":"paragraph"},{"level":3,"text":"Real World Inputs","type":"heading","anchor":"Real-World-Inputs"},{"inlineContent":[{"type":"text","text":"Use real-world data:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Multiple angles"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Variation of backgrounds"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Different lighting conditions"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Other objects in images","type":"text"}]}]}]},{"level":2,"text":"Written By","type":"heading","anchor":"Written-By"},{"numberOfColumns":5,"columns":[{"size":1,"content":[{"inlineContent":[{"type":"image","identifier":"https:\/\/avatars.githubusercontent.com\/u\/5277837?v=4"}],"type":"paragraph"}]},{"size":4,"content":[{"text":"Federico Zanetello","level":3,"anchor":"Federico-Zanetello","type":"heading"},{"inlineContent":[{"overridingTitle":"Contributed Notes","type":"reference","isActive":true,"overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/zntfdr"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","isActive":true,"identifier":"https:\/\/zntfdr.dev"}],"type":"paragraph"}]}],"type":"row"},{"inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"isActive":true,"identifier":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","type":"reference"}],"type":"paragraph"},{"level":2,"text":"Related Sessions","type":"heading","anchor":"Related-Sessions"},{"type":"links","style":"list","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10096-Explore-Packages-and-Projects-with-Xcode-Playgrounds","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-406-Create-ML-for-Object-Detection-and-Sound-Classification","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-430-Introducing-the-Create-ML-App"]},{"inlineContent":[{"inlineContent":[{"text":"Legal Notice","type":"text"}],"type":"strong"}],"type":"small"},{"inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}],"type":"small"}]}],"metadata":{"modules":[{"name":"WWDC Notes"}],"role":"sampleCode","title":"Training Object Detection Models in Create ML","roleHeading":"WWDC19"},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-424-Training-Object-Detection-Models-in-Create-ML"},"references":{"https://github.com/zntfdr":{"identifier":"https:\/\/github.com\/zntfdr","url":"https:\/\/github.com\/zntfdr","type":"link","titleInlineContent":[{"text":"GitHub","type":"text"}],"title":"GitHub"},"https://zntfdr.dev":{"identifier":"https:\/\/zntfdr.dev","url":"https:\/\/zntfdr.dev","type":"link","titleInlineContent":[{"type":"text","text":"Blog"}],"title":"Blog"},"WWDC19-424-dog":{"identifier":"WWDC19-424-dog","type":"image","variants":[{"url":"\/images\/WWDC19-424-dog.png","traits":["1x","light"]}],"alt":null},"WWDCNotes.png":{"identifier":"WWDCNotes.png","type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"alt":null},"WWDC19-424-output":{"identifier":"WWDC19-424-output","type":"image","variants":[{"url":"\/images\/WWDC19-424-output.png","traits":["1x","light"]}],"alt":null},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-430-Introducing-the-Create-ML-App":{"title":"Introducing the Create ML App","url":"\/documentation\/wwdcnotes\/wwdc19-430-introducing-the-create-ml-app","type":"topic","abstract":[{"type":"text","text":"Bringing the power of Core ML to your app begins with one challenge. How do you create your model? The new Create ML app provides an intuitive workflow for model creation. See how to train, evaluate, test, and preview your models quickly in this easy-to-use tool. Get started with one of the many available templates handling a number of powerful machine learning tasks. Learn more about the many features for continuous model improvement and experimentation."}],"role":"sampleCode","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-430-Introducing-the-Create-ML-App"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC20-10096-Explore-Packages-and-Projects-with-Xcode-Playgrounds":{"kind":"article","title":"Explore Packages and Projects with Xcode Playgrounds","url":"\/documentation\/wwdcnotes\/wwdc20-10096-explore-packages-and-projects-with-xcode-playgrounds","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10096-Explore-Packages-and-Projects-with-Xcode-Playgrounds","role":"sampleCode","abstract":[{"type":"text","text":"Xcode Playgrounds helps developers explore Swift and framework APIs and provides a scratchpad for rapid experimentation. Learn how Xcode Playgrounds utilizes Xcode’s modern build system, provides improved support for resources, and integrates into your projects, frameworks, and Swift packages to improve your documentation and development workflow."}]},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19":{"images":[{"type":"icon","identifier":"WWDCNotes.png"}],"kind":"article","type":"topic","abstract":[{"text":"Xcode 11, Swift 5.1, iOS 13, macOS 10.15 (Catalina), tvOS 13, watchOS 6.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"code":"Combine","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Core Haptics","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Create ML","type":"codeVoice"},{"text":", and more.","type":"text"}],"role":"collectionGroup","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19","title":"WWDC19","url":"\/documentation\/wwdcnotes\/wwdc19"},"https://developers.google.com/machine-learning/crash-course/descending-into-ml/training-and-loss":{"identifier":"https:\/\/developers.google.com\/machine-learning\/crash-course\/descending-into-ml\/training-and-loss","url":"https:\/\/developers.google.com\/machine-learning\/crash-course\/descending-into-ml\/training-and-loss","type":"link","titleInlineContent":[{"type":"text","text":"the lower the better"}],"title":"the lower the better"},"https://en.wikipedia.org/wiki/Loss_function":{"identifier":"https:\/\/en.wikipedia.org\/wiki\/Loss_function","url":"https:\/\/en.wikipedia.org\/wiki\/Loss_function","type":"link","titleInlineContent":[{"text":"loss function","type":"text"}],"title":"loss function"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-406-Create-ML-for-Object-Detection-and-Sound-Classification":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-406-Create-ML-for-Object-Detection-and-Sound-Classification","title":"Create ML for Object Detection and Sound Classification","kind":"article","abstract":[{"text":"Create ML enables you to create, evaluate, and test powerful, production-class Core ML models. See how easy it is to create your own Object Detection and Sound Classification models for use in your apps. Learn strategies for balancing your training data to achieve great model accuracy.","type":"text"}],"role":"sampleCode","type":"topic","url":"\/documentation\/wwdcnotes\/wwdc19-406-create-ml-for-object-detection-and-sound-classification"},"WWDC19-424-training":{"identifier":"WWDC19-424-training","type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19-424-training.png"}],"alt":null},"https://avatars.githubusercontent.com/u/5277837?v=4":{"identifier":"https:\/\/avatars.githubusercontent.com\/u\/5277837?v=4","type":"image","variants":[{"url":"https:\/\/avatars.githubusercontent.com\/u\/5277837?v=4","traits":["1x","light"]}],"alt":"Profile image of Federico Zanetello"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"kind":"article","url":"\/documentation\/wwdcnotes\/zntfdr","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","abstract":[{"type":"text","text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more."}],"type":"topic","title":"Federico Zanetello (332 notes)","role":"sampleCode"},"https://developer.apple.com/wwdc19/424":{"identifier":"https:\/\/developer.apple.com\/wwdc19\/424","url":"https:\/\/developer.apple.com\/wwdc19\/424","checksum":null,"type":"download"},"WWDC19-424-accuracy":{"alt":null,"identifier":"WWDC19-424-accuracy","variants":[{"url":"\/images\/WWDC19-424-accuracy.png","traits":["1x","light"]}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes":{"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","title":"WWDC Notes","url":"\/documentation\/wwdcnotes","kind":"symbol","role":"collection","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"images":[{"identifier":"WWDCNotes.png","type":"icon"}]},"https://wwdcnotes.github.io/WWDCNotes/documentation/wwdcnotes/contributing":{"title":"Contributions are welcome!","url":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","identifier":"https:\/\/wwdcnotes.github.io\/WWDCNotes\/documentation\/wwdcnotes\/contributing","type":"link","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}]}}}