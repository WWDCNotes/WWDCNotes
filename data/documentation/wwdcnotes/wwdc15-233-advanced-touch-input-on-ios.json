{"metadata":{"roleHeading":"WWDC15","role":"sampleCode","title":"Advanced Touch Input on iOS","modules":[{"name":"WWDC Notes"}]},"sections":[],"kind":"article","identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC15-233-Advanced-Touch-Input-on-iOS","interfaceLanguage":"swift"},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC15"]]},"abstract":[{"type":"text","text":"Learn about the touch input and drawing pipelines. Gain specific insights in how best to design your app to minimize latency in receiving touches and maximizing the performance of drawing content on the screen. Explore new API in UIKit and learn best practices for faster and smoother input."}],"sampleCodeDownload":{"action":{"overridingTitle":"Watch Video (38 min)","isActive":true,"identifier":"https:\/\/developer.apple.com\/wwdc15\/233","type":"reference"},"kind":"sampleDownload"},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc15-233-advanced-touch-input-on-ios"]}],"schemaVersion":{"patch":0,"minor":3,"major":0},"primaryContentSections":[{"content":[{"type":"heading","level":2,"text":"Low Latency Core Animation","anchor":"Low-Latency-Core-Animation"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"The Core animation work starts as soon as the app commits, no need to wait for the next frame to come first"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Done automatically from iOS 9, no extra logic necessary"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Disabled for animations (","type":"text"},{"code":"CAAnimation","type":"codeVoice"},{"text":"s and ","type":"text"},{"code":"UIView","type":"codeVoice"},{"text":"’s animations)","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Works also with "},{"identifier":"https:\/\/developer.apple.com\/documentation\/quartzcore\/caeagllayer","isActive":true,"type":"reference"},{"type":"text","text":" and "},{"identifier":"https:\/\/developer.apple.com\/documentation\/quartzcore\/cametallayer","isActive":true,"type":"reference"},{"type":"text","text":", in this case you can use "},{"identifier":"https:\/\/developer.apple.com\/documentation\/quartzcore\/cametallayer\/1478157-presentswithtransaction","isActive":true,"type":"reference"},{"type":"text","text":" to make sure your metal layer is in sync with your Core Animation layer (otherwise it might happen that the metal layer renders before)"}]}]}]},{"type":"heading","level":2,"text":"Touch Coalescing","anchor":"Touch-Coalescing"},{"inlineContent":[{"text":"From the iPad Air 2, iOS devices ship with a 120-hertz touch scan update rate, this means that devices get twice as much touch events for example when dragging\/drawing.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"iOS will still deliver new touch events at the beginning of a new frame, however you will have access to possibly two touch events instead of just one.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"To get those touches, there’s a new API: "},{"type":"codeVoice","code":"UIEvent"},{"type":"text","text":"’s "},{"type":"reference","isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uievent\/1613808-coalescedtouches"},{"type":"text","text":", which returns an array of all the coalesced touches since the last time iOS delivered that touch to your app."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Usage example, from:"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["for touch in touches {","  let line = lineForTouch(touch)","  addTouchSample(touch, toLine: line)","}"]},{"inlineContent":[{"text":"to:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["for touch in touches {","  let line = lineForTouch(touch)","  for coalescedTouch in event.coalescedTouchesForTouch(touch) {","    addTouchSample(coalescedTouch, toLine: line)","  }","}"]},{"type":"heading","level":2,"text":"Touch Prediction","anchor":"Touch-Prediction"},{"inlineContent":[{"text":"Use this API to get even lower latency in your apps.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"How it works:","type":"text"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"iOS looks at the touches that are delivered to your app, and uses a set of highly tuned algorithms to determine where the user’s finger looks like it’s going at this time","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"And as we get new touch samples, we will update our prediction and deliver new predicted touches to your app"}],"type":"paragraph"}]}]},{"inlineContent":[{"type":"text","text":"New "},{"type":"codeVoice","code":"UIEvent"},{"type":"text","text":" API: "},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uievent\/1613814-predictedtouches","isActive":true}],"type":"paragraph"},{"inlineContent":[{"text":"Usage example:","type":"text"}],"type":"paragraph"},{"type":"codeListing","syntax":"swift","code":["for touch in touches {","  \/\/ Like before","  let line = lineForTouch(touch)","  for coalescedTouch in event.coalescedTouchesForTouch(touch) {","    addTouchSample(coalescedTouch, toLine: line)","  }","","  \/\/ Remove old predicted touches","  removePredictedSamplesFromLine(line)","","  \/\/ Add new predicted touches","  for predictedTouch in event.predictedTouchesForTouch(touch) {","    addPredictedTouchSample(predictedTouch, toLine: line)","  }","}"]},{"type":"heading","level":2,"text":"Written By","anchor":"Written-By"},{"numberOfColumns":5,"type":"row","columns":[{"size":1,"content":[{"type":"paragraph","inlineContent":[{"identifier":"zntfdr","type":"image"}]}]},{"size":4,"content":[{"type":"heading","level":3,"text":"Federico Zanetello","anchor":"Federico-Zanetello"},{"type":"paragraph","inlineContent":[{"isActive":true,"overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","overridingTitle":"Contributed Notes","type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"isActive":true,"identifier":"https:\/\/github.com\/zntfdr","type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"isActive":true,"identifier":"https:\/\/zntfdr.dev","type":"reference"}]}]}]},{"type":"thematicBreak"},{"inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference"}],"type":"paragraph"},{"type":"heading","level":2,"text":"Related Sessions","anchor":"Related-Sessions"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Legal Notice"}],"type":"strong"}],"type":"small"},{"inlineContent":[{"text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}],"type":"small"}],"kind":"content"}],"references":{"WWDC15-Icon.png":{"type":"image","alt":null,"variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/WWDC15-Icon.png"}],"identifier":"WWDC15-Icon.png"},"zntfdr":{"type":"image","alt":"Profile image of Federico Zanetello","variants":[{"url":"\/images\/WWDCNotes\/zntfdr.jpeg","traits":["1x","light"]}],"identifier":"zntfdr"},"https://developer.apple.com/documentation/quartzcore/cametallayer":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/quartzcore\/cametallayer","title":"CAMetalLayer","identifier":"https:\/\/developer.apple.com\/documentation\/quartzcore\/cametallayer","titleInlineContent":[{"type":"codeVoice","code":"CAMetalLayer"}]},"https://developer.apple.com/documentation/uikit/uievent/1613814-predictedtouches":{"title":"predictedTouches(for:)","url":"https:\/\/developer.apple.com\/documentation\/uikit\/uievent\/1613814-predictedtouches","type":"link","titleInlineContent":[{"type":"codeVoice","code":"predictedTouches(for:)"}],"identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uievent\/1613814-predictedtouches"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"title":"Federico Zanetello (332 notes)","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","url":"\/documentation\/wwdcnotes\/zntfdr","role":"sampleCode","type":"topic","abstract":[{"type":"text","text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more."}],"images":[{"type":"card","identifier":"zntfdr.jpeg"},{"type":"icon","identifier":"zntfdr.jpeg"}]},"https://developer.apple.com/documentation/uikit/uievent/1613808-coalescedtouches":{"type":"link","title":"coalescedTouches(for:)","titleInlineContent":[{"type":"codeVoice","code":"coalescedTouches(for:)"}],"url":"https:\/\/developer.apple.com\/documentation\/uikit\/uievent\/1613808-coalescedtouches","identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uievent\/1613808-coalescedtouches"},"https://developer.apple.com/documentation/quartzcore/cametallayer/1478157-presentswithtransaction":{"type":"link","url":"https:\/\/developer.apple.com\/documentation\/quartzcore\/cametallayer\/1478157-presentswithtransaction","title":"presentsWithTransaction","identifier":"https:\/\/developer.apple.com\/documentation\/quartzcore\/cametallayer\/1478157-presentswithtransaction","titleInlineContent":[{"type":"codeVoice","code":"presentsWithTransaction"}]},"https://developer.apple.com/documentation/quartzcore/caeagllayer":{"title":"CAEAGLLayer","url":"https:\/\/developer.apple.com\/documentation\/quartzcore\/caeagllayer","type":"link","titleInlineContent":[{"type":"codeVoice","code":"CAEAGLLayer"}],"identifier":"https:\/\/developer.apple.com\/documentation\/quartzcore\/caeagllayer"},"WWDCNotes.png":{"type":"image","alt":null,"variants":[{"url":"\/images\/WWDCNotes\/WWDCNotes.png","traits":["1x","light"]}],"identifier":"WWDCNotes.png"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"type":"link","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}]},"https://developer.apple.com/wwdc15/233":{"checksum":null,"url":"https:\/\/developer.apple.com\/wwdc15\/233","type":"download","identifier":"https:\/\/developer.apple.com\/wwdc15\/233"},"doc://WWDCNotes/documentation/WWDCNotes":{"type":"topic","role":"collection","abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"images":[{"identifier":"WWDCNotes.png","type":"icon"}],"url":"\/documentation\/wwdcnotes","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","title":"WWDC Notes","kind":"symbol"},"WWDC15.jpeg":{"type":"image","alt":null,"variants":[{"url":"\/images\/WWDCNotes\/WWDC15.jpeg","traits":["1x","light"]}],"identifier":"WWDC15.jpeg"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC15":{"type":"topic","kind":"article","title":"WWDC15","images":[{"identifier":"WWDC15-Icon.png","type":"icon"},{"identifier":"WWDC15.jpeg","type":"card"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC15","url":"\/documentation\/wwdcnotes\/wwdc15","abstract":[{"type":"text","text":"Xcode 7, Swift 2.0, iOS 9, macOS 10.11 (El Capitan), watchOS 2."}],"role":"collectionGroup"},"https://github.com/zntfdr":{"title":"GitHub","url":"https:\/\/github.com\/zntfdr","type":"link","titleInlineContent":[{"type":"text","text":"GitHub"}],"identifier":"https:\/\/github.com\/zntfdr"},"zntfdr.jpeg":{"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes\/zntfdr.jpeg"}],"identifier":"zntfdr.jpeg","alt":null},"https://zntfdr.dev":{"type":"link","title":"Blog","titleInlineContent":[{"text":"Blog","type":"text"}],"url":"https:\/\/zntfdr.dev","identifier":"https:\/\/zntfdr.dev"}}}