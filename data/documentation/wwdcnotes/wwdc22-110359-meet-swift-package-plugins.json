{"metadata":{"modules":[{"name":"WWDC Notes"}],"role":"sampleCode","title":"Meet Swift Package plugins","roleHeading":"WWDC22"},"schemaVersion":{"minor":3,"patch":0,"major":0},"kind":"article","identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110359-Meet-Swift-Package-plugins"},"sampleCodeDownload":{"kind":"sampleDownload","action":{"identifier":"https:\/\/developer.apple.com\/wwdc22\/110359","isActive":true,"type":"reference","overridingTitle":"Watch Video (15 min)"}},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc22-110359-meet-swift-package-plugins"]}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22"]]},"abstract":[{"type":"text","text":"Discover how you can perform actions on Swift packages and Xcode projects with Swift package plugins. We‚Äôll go over how these plugins work and explore how you can use them to generate source code and automate your development workflow."}],"primaryContentSections":[{"kind":"content","content":[{"text":"What is a package plugin?","type":"heading","anchor":"What-is-a-package-plugin","level":2},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Swift script that can be run as part of your build"}]}]},{"content":[{"inlineContent":[{"text":"A package could have plugins as extra, or be all about plugins","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Package plugins are available only within package"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"General plugins can be made available to the outside","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Lets you access development tools on your machine","type":"text"}]}]}]},{"text":"Command plugins:","type":"heading","anchor":"Command-plugins","level":3},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"implement custom actions, such as formatters, linters, prepare distribution","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"can ask for permission to modify files in package","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"some might just read to report some data","type":"text"}],"type":"paragraph"}]}]},{"text":"Build tool plugins:","type":"heading","anchor":"Build-tool-plugins","level":3},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"extend the dependency graph"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"applied to each target that needs them"}],"type":"paragraph"}]}]},{"text":"Demo","type":"heading","anchor":"Demo","level":2},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"add plugin like any other package dependency in project, via the "},{"code":"dependencies","type":"codeVoice"},{"type":"text","text":" in your package manifest file:"}],"type":"paragraph"}]}]},{"type":"codeListing","syntax":"swift","code":["let package = Package (","  name: \"CoreLib\",","  products: [","    .library(name:\"CoreLib\", targets: [\"CoreLib\"])","  ],","  dependencies: [","    \/\/ üëáüèª","    .package (url: \"git@example.com:DemoPackages\/SourceCodeUtilityPlugins.git\", branch: \"main\")","  ],","  targets: [","    .target (name: \"CoreLib\"),","    .testTarget(name: \"CoreLibTests\", dependencies: [\"CoreLib\"])","  ]",")"]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"the plugin will be available once downloaded (no need to add it as a dependency on target or similar)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"When running plugins, you choose the target and can pass extra arguments"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Xcode asks permission for plugins that modify your files, has a ","type":"text"},{"text":"show code","type":"text"},{"text":" button","type":"text"}]}]}]},{"text":"How do plugins work?","type":"heading","anchor":"How-do-plugins-work","level":2},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"plugins can create files, read dependencies"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"plugins run in a Sandbox"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"plugin can send results back to Xcode, such as warnings and errors"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"use "},{"code":"import PackagePlugin","type":"codeVoice"},{"text":" to implement one","type":"text"}],"type":"paragraph"}]}]},{"type":"codeListing","syntax":"swift","code":["import PackagePlugin","","@main","struct MyPlugin: ... {","","    \/\/ Entry points specific to plugin capability. These entry points are invoked","    \/\/ when the plugin is applied to a package.","","}","","\/\/ üëáüèª use #if canImport for conditional support for Xcode projects","#if canImport(XcodeProjectPlugin)","import XcodeProjectPlugin","","extension MyPlugin: ... {","","  \/\/ Entry points specific to plugin capability. These entry points are invoked","  \/\/ when the plugin is applied to an Xcode project.","","}","#endif"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Two plugin types:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Command plugins"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Build tool plugins"}],"type":"paragraph"}]}]},{"text":"Command plugins","type":"heading","anchor":"Command-plugins","level":2},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"implement development-time actions"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"Run interactively, not during a build (e.g., manually triggered by the developer)","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Must ask for permission to modify package sources","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Might depend on other tools to do the actual work"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"dependencies on tools plugins can be both binaries or source code","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"run "},{"type":"codeVoice","code":"swift package plugin --list"},{"type":"text","text":" to see which plugins are available"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"run "},{"type":"codeVoice","code":"swift package <plugin_name>"},{"type":"text","text":" to run them in current directory"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"run with ","type":"text"},{"type":"codeVoice","code":"swift package --allow-writing-to-package-directory <plugin_name>"},{"text":" to give write access","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"append "},{"type":"codeVoice","code":"--verbose"},{"type":"text","text":" to see more output from plugin"}]}]}]},{"text":"Build tool plugins","type":"heading","anchor":"Build-tool-plugins","level":2},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"provide commands for the build system, triggered at build time (not manually)","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"can invoke executable provided as binaries or built from source","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"supports build commands and prebuild commands"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"text":"output files are stored with other build artifacts, not among your package source code","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"commands run in a sandbox to prevent changes in package"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Requires conforming to "},{"code":"BuildToolPlugin","type":"codeVoice"},{"type":"text","text":" protocol, return type is "},{"code":"[Command]","type":"codeVoice"}]}]}]},{"type":"codeListing","syntax":"swift","code":["import PackagePlugin","","@main","struct MyPlugin: BuildToolPlugin {","","  \/\/\/ This entry point is called when operating on a Swift package.","  func createBuildCommands(context: PluginContext, target: Target) throws -> [Command]","    debugPrint(context)","    return []","  }","}","","\/\/ üëáüèª use #if canImport for conditional support for Xcode projects","#if canImport(XcodeProjectPlugin)","import XcodeProjectPlugin","","extension MyPlugin: XcodeBuildToolPlugin {","","  \/\/\/ This entry point is called when operating on an Xcode project.","  func createBuildCommands(context: XcodePluginContext, target: XcodeTarget) throws -> [Command]","    debugPrint(context)","    return []","  }","}","#endif"]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"Build commands run as part of the build"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"You specify input and output paths","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"They run only when their output is missing, or when their inputs (e.g. files, assets) has changed (they‚Äôre skipped otherwise)","type":"text"}]}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Prebuild commands run before the build starts"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Add plugins to targets via ","type":"text"},{"code":"plugins","type":"codeVoice"},{"text":" parameter","type":"text"}]}]}]},{"type":"codeListing","syntax":"swift","code":["let package = Package (","  name: \"CoreLib\",","  products: [","    .library(name:\"CoreLib\", targets: [\"CoreLib\"])","  ],","  dependencies: [","    \/\/ üëáüèª","    .package (url: \"git@example.com:DemoPackages\/MySourceGenPlugin.git\", from: \"1.0.0\")","  ],","  targets: [","    .target (","      name: \"CoreLib\",","      plugins: [","        .plugin(name: \"MySourceGenBuildTool\", package: \"MySourceGenPlugin\") \/\/ üëàüèª required!","      ]","    ),","    .testTarget(name: \"CoreLibTests\", dependencies: [\"CoreLib\"])","  ]",")"]},{"text":"Written By","type":"heading","anchor":"Written-By","level":2},{"type":"row","numberOfColumns":5,"columns":[{"content":[{"inlineContent":[{"identifier":"Jeehut","type":"image"}],"type":"paragraph"}],"size":1},{"content":[{"anchor":"Cihat-G√ºnd√ºz","type":"heading","level":3,"text":"Cihat G√ºnd√ºz"},{"type":"paragraph","inlineContent":[{"overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"overridingTitle":"Contributed Notes","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/Jeehut","isActive":true,"type":"reference"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/github.com\/Jeehut","isActive":true,"type":"reference"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/x.com\/Jeehut","isActive":true,"type":"reference"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/fline.dev","isActive":true,"type":"reference"}]}],"size":4}]},{"type":"paragraph","inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference"}]},{"text":"Related Sessions","type":"heading","anchor":"Related-Sessions","level":2},{"type":"links","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10171-Meet-Swift-OpenAPI-Generator","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110354-Whats-new-in-Swift","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110401-Create-Swift-Package-plugins","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110427-Whats-new-in-Xcode","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-408-Adopting-Swift-Packages-in-Xcode"],"style":"list"},{"type":"small","inlineContent":[{"inlineContent":[{"text":"Legal Notice","type":"text"}],"type":"strong"}]},{"type":"small","inlineContent":[{"text":"All content copyright ¬© 2012 ‚Äì 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}]}]}],"sections":[],"references":{"WWDC22-Icon.png":{"identifier":"WWDC22-Icon.png","alt":null,"variants":[{"url":"\/images\/WWDC22-Icon.png","traits":["1x","light"]}],"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/Jeehut":{"images":[{"identifier":"Jeehut.jpeg","type":"card"},{"identifier":"Jeehut.jpeg","type":"icon"}],"title":"Cihat G√ºnd√ºz (58 notes)","url":"\/documentation\/wwdcnotes\/jeehut","kind":"article","role":"sampleCode","type":"topic","abstract":[{"text":"Spatial-first Indie Developer for Ô£ø Platforms. Actively contributing to Open Source since 2011!","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/Jeehut"},"https://developer.apple.com/wwdc22/110359":{"checksum":null,"identifier":"https:\/\/developer.apple.com\/wwdc22\/110359","type":"download","url":"https:\/\/developer.apple.com\/wwdc22\/110359"},"WWDCNotes.png":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"identifier":"WWDCNotes.png","alt":null,"type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-110401-Create-Swift-Package-plugins":{"abstract":[{"text":"Tailor your development workflow and learn how to write your own package plugins in Swift. We‚Äôll show you how you can extend Xcode‚Äôs functionality by using the PackagePlugin API to generate source code or automate release tasks and share best practices for creating great plugins.","type":"text"}],"role":"sampleCode","url":"\/documentation\/wwdcnotes\/wwdc22-110401-create-swift-package-plugins","kind":"article","type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110401-Create-Swift-Package-plugins","title":"Create Swift Package plugins"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!","titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"type":"link"},"Jeehut.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/Jeehut.jpeg"}],"identifier":"Jeehut.jpeg","alt":null,"type":"image"},"https://x.com/Jeehut":{"identifier":"https:\/\/x.com\/Jeehut","url":"https:\/\/x.com\/Jeehut","title":"X\/Twitter","titleInlineContent":[{"text":"X\/Twitter","type":"text"}],"type":"link"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-110427-Whats-new-in-Xcode":{"url":"\/documentation\/wwdcnotes\/wwdc22-110427-whats-new-in-xcode","role":"sampleCode","abstract":[{"text":"Discover the latest productivity and performance advancements in Xcode 14. We‚Äôll introduce you to the fully redesigned SwiftUI canvas experience, explore enhancements to code completion and navigation, and take you through performance improvements we‚Äôve made throughout the entire development process. We‚Äôll also show you how you can now read and respond to feedback on your TestFlight builds without ever leaving Xcode.","type":"text"}],"kind":"article","title":"What‚Äôs new in Xcode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110427-Whats-new-in-Xcode","type":"topic"},"WWDC22.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDC22.jpeg"}],"identifier":"WWDC22.jpeg","alt":null,"type":"image"},"https://github.com/Jeehut":{"identifier":"https:\/\/github.com\/Jeehut","url":"https:\/\/github.com\/Jeehut","title":"GitHub","titleInlineContent":[{"text":"GitHub","type":"text"}],"type":"link"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22":{"role":"collectionGroup","kind":"article","images":[{"type":"icon","identifier":"WWDC22-Icon.png"},{"type":"card","identifier":"WWDC22.jpeg"}],"abstract":[{"text":"Xcode 14, Swift 5.7, iOS 16, macOS 13 (Ventura), tvOS 16, watchOS 9.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"type":"codeVoice","code":"WeatherKit"},{"text":", ","type":"text"},{"type":"codeVoice","code":"ScreenCaptureKit"},{"text":", ","type":"text"},{"type":"codeVoice","code":"Swift Regex"},{"text":", and more.","type":"text"}],"type":"topic","url":"\/documentation\/wwdcnotes\/wwdc22","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22","title":"WWDC22"},"doc://WWDCNotes/documentation/WWDCNotes":{"kind":"symbol","role":"collection","title":"WWDC Notes","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","url":"\/documentation\/wwdcnotes"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-110354-Whats-new-in-Swift":{"url":"\/documentation\/wwdcnotes\/wwdc22-110354-whats-new-in-swift","role":"sampleCode","kind":"article","type":"topic","title":"What‚Äôs new in Swift","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110354-Whats-new-in-Swift","abstract":[{"type":"text","text":"Join us for an update on Swift. We‚Äôll take you through performance improvements, explore more secure and extensible Swift packages, and share advancements in Swift concurrency. We‚Äôll also introduce you to Swift Regex, better generics, and other tools built into the language to help you write more flexible & expressive code."}]},"Jeehut":{"variants":[{"traits":["1x","light"],"url":"\/images\/Jeehut.jpeg"}],"identifier":"Jeehut","alt":"Profile image of Cihat G√ºnd√ºz","type":"image"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10171-Meet-Swift-OpenAPI-Generator":{"role":"sampleCode","url":"\/documentation\/wwdcnotes\/wwdc23-10171-meet-swift-openapi-generator","type":"topic","abstract":[{"type":"text","text":"Discover how Swift OpenAPI Generator can help you work with HTTP server APIs whether you‚Äôre extending an iOS app or writing a server in Swift. We‚Äôll show you how this package plugin can streamline your workflow and simplify your codebase by generating code from an OpenAPI document."}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10171-Meet-Swift-OpenAPI-Generator","title":"Meet Swift OpenAPI Generator","kind":"article"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-408-Adopting-Swift-Packages-in-Xcode":{"kind":"article","abstract":[{"text":"Swift packages are a great way to organize and share code, and are now supported while building apps for all Apple platforms in Xcode 11. Find out how to use community-developed packages in your project, how Swift packages are structured, and how package versioning and dependencies work.","type":"text"}],"type":"topic","title":"Adopting Swift Packages in Xcode","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-408-Adopting-Swift-Packages-in-Xcode","url":"\/documentation\/wwdcnotes\/wwdc19-408-adopting-swift-packages-in-xcode","role":"sampleCode"},"https://fline.dev":{"identifier":"https:\/\/fline.dev","url":"https:\/\/fline.dev","title":"Blog","titleInlineContent":[{"text":"Blog","type":"text"}],"type":"link"}}}