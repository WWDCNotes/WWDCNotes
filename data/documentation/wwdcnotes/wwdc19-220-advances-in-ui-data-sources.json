{"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc19-220-advances-in-ui-data-sources"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"kind":"content","content":[{"type":"heading","level":2,"text":"Overview","anchor":"overview"},{"type":"paragraph","inlineContent":[{"type":"text","text":"All our collection views (both "},{"code":"UITableView","type":"codeVoice"},{"type":"text","text":" and "},{"code":"UICollectionView","type":"codeVoice"},{"type":"text","text":") are getting an overdue refresh this year."}]},{"type":"paragraph","inlineContent":[{"text":"We no longer need to use ","type":"text"},{"type":"codeVoice","code":"IGListKit"},{"text":" and the likes, we no longer need to call ","type":"text"},{"type":"codeVoice","code":".reloadData()"},{"text":" or ","type":"text"},{"type":"codeVoice","code":"performBatchUpdates()"},{"text":".","type":"text"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Introducing:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"isActive":true,"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionviewdiffabledatasource"}]}]},{"content":[{"inlineContent":[{"identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uitableviewdiffabledatasource","type":"reference","isActive":true}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"In short, what we must do now in our collection views is inject one of the two data sources above."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"These new data source types will manage a snapshot of our data state:"}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"You can think of a snapshot as the collection view current state (you can query them the number of sections and rows per section and more).","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"The snapshot has elements, which can be our models instances, or just as an identifier of a model, that helps us identify unequivocally a data element. These elements must conform to Hashable."}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Three steps:"}]},{"type":"orderedList","items":[{"content":[{"inlineContent":[{"text":"create a snapshot (you can start from the current snapshot, or create a new one)","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"configure it","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"apply to our data source","type":"text"}],"type":"paragraph"}]}]},{"type":"paragraph","inlineContent":[{"text":"All is awesome for data sources now, what about our collection views delegates?","type":"text"},{"text":" ","type":"text"},{"text":"No api changes, for them. However, the data source exposes a way to go from an ","type":"text"},{"code":"indexPath","type":"codeVoice"},{"text":" to a ","type":"text"},{"code":"identifier","type":"codeVoice"},{"text":":","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["func collectionView(","  _ collectionView: UICollectionView,","  didSelectItemAt indexPath: IndexPath",") { ","  if let identifier = dataSource.itemIdentifier(for: indexPath) { ","    \/\/ Do something","  }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Therefore we get all the advantages of our new datasource in the delegate as well üëçüèª"},{"type":"text","text":" "},{"type":"text","text":"Note: this indexPath -> identifier\/object is done in constant time."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"We can call "},{"code":"apply()","type":"codeVoice"},{"type":"text","text":" in a background thread."}]},{"name":"Note","style":"note","type":"aside","content":[{"inlineContent":[{"text":"‚ö†Ô∏è We must always call ","type":"text"},{"type":"codeVoice","code":"apply()"},{"text":" from the background queue or the  main queue. No mix!","type":"text"}],"type":"paragraph"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Here‚Äôs an example of how to inject a data source:"}]},{"type":"codeListing","syntax":"swift","code":["func configureDataSource() { ","  dataSource = UICollectionViewDiffableDataSource ","    <Section, MountainsController.Mountain>(collectionView: mountainsCollectionView) { ","      (collectionView: UICollectionView, indexPath: IndexPath, mountain: MountainsController. Mountain) -> UICollectionViewCell? in ","    guard let mountainCell = collectionView.dequeueReusableCell(","      withReuseIdentifier: LabelCell.reuseIdentifier, for: indexPath) as? LabelCell else {","        fatalError(\"Cannot create new cell\")","    } ","    mountainCell.label.text = mountain.name","    return mountainCell","  }","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Note how we also pass the method to set and return a new cell when injecting it, most importantly, note how that method also passes our associated element at that index. We no longer need to do lookups etc."}]},{"type":"paragraph","inlineContent":[{"text":"Lastly, both the new data source types are generic (no objc), therefore we will need two (hashable) types, one for sections (an enum will suffice) and one for the elements (duh).","type":"text"}]},{"type":"heading","level":2,"text":"Written By","anchor":"Written-By"},{"numberOfColumns":5,"columns":[{"size":1,"content":[{"type":"paragraph","inlineContent":[{"identifier":"zntfdr","type":"image"}]}]},{"size":4,"content":[{"level":3,"type":"heading","text":"Federico Zanetello","anchor":"Federico-Zanetello"},{"inlineContent":[{"overridingTitle":"Contributed Notes","overridingTitleInlineContent":[{"type":"text","text":"Contributed Notes"}],"type":"reference","isActive":true,"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"https:\/\/github.com\/zntfdr"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"type":"reference","isActive":true,"identifier":"https:\/\/zntfdr.dev"}],"type":"paragraph"}]}],"type":"row"},{"type":"thematicBreak"},{"type":"paragraph","inlineContent":[{"type":"text","text":"Missing anything? Corrections? "},{"type":"reference","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","isActive":true}]},{"type":"heading","level":2,"text":"Related Sessions","anchor":"Related-Sessions"},{"style":"list","type":"links","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10045-Advances-in-diffable-data-sources","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10097-Advances-in-UICollectionView","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10105-Build-for-iPad","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-210-Whats-New-in-AppKit-for-macOS","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-215-Advances-in-Collection-View-Layout","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-230-Making-Apps-with-Core-Data"]},{"type":"small","inlineContent":[{"type":"strong","inlineContent":[{"text":"Legal Notice","type":"text"}]}]},{"type":"small","inlineContent":[{"type":"text","text":"All content copyright ¬© 2012 ‚Äì 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}]}]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"abstract":[{"text":"Use UI Data Sources to simplify updating your table view and collection view items using automatic diffing. High fidelity, quality animations of set changes are automatic and require no extra code! This improved data source mechanism completely avoids synchronization bugs, exceptions, and crashes! Learn about this simplified data model that uses on identifiers and snapshots so that you can focus on your app‚Äôs dynamic data and content instead of the minutia of UI data synchronization.","type":"text"}],"metadata":{"role":"sampleCode","modules":[{"name":"WWDC Notes"}],"title":"Advances in UI Data Sources","roleHeading":"WWDC19"},"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-220-Advances-in-UI-Data-Sources","interfaceLanguage":"swift"},"kind":"article","sampleCodeDownload":{"kind":"sampleDownload","action":{"overridingTitle":"Watch Video (36 min)","isActive":true,"identifier":"https:\/\/developer.apple.com\/wwdc19\/220","type":"reference"}},"sections":[],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19"]]},"references":{"doc://WWDCNotes/documentation/WWDCNotes/WWDC19":{"url":"\/documentation\/wwdcnotes\/wwdc19","abstract":[{"type":"text","text":"Xcode 11, Swift 5.1, iOS 13, macOS 10.15 (Catalina), tvOS 13, watchOS 6."},{"type":"text","text":" "},{"type":"text","text":"New APIs: "},{"type":"codeVoice","code":"Combine"},{"type":"text","text":", "},{"type":"codeVoice","code":"Core Haptics"},{"type":"text","text":", "},{"type":"codeVoice","code":"Create ML"},{"type":"text","text":", and more."}],"kind":"article","images":[{"type":"icon","identifier":"WWDC19-Icon.png"},{"type":"card","identifier":"WWDC19.jpeg"}],"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19","role":"collectionGroup","title":"WWDC19"},"https://github.com/zntfdr":{"titleInlineContent":[{"text":"GitHub","type":"text"}],"url":"https:\/\/github.com\/zntfdr","identifier":"https:\/\/github.com\/zntfdr","title":"GitHub","type":"link"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-210-Whats-New-in-AppKit-for-macOS":{"title":"What‚Äôs New in AppKit for macOS","url":"\/documentation\/wwdcnotes\/wwdc19-210-whats-new-in-appkit-for-macos","abstract":[{"text":"Learn about the latest APIs in AppKit and associated frameworks. Get an overview of the enhancements coming in macOS Catalina to help you save time, take advantage of the latest hardware, and add polish to your application.","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-210-Whats-New-in-AppKit-for-macOS","kind":"article","type":"topic","role":"sampleCode"},"https://zntfdr.dev":{"titleInlineContent":[{"text":"Blog","type":"text"}],"title":"Blog","url":"https:\/\/zntfdr.dev","type":"link","identifier":"https:\/\/zntfdr.dev"},"doc://WWDCNotes/documentation/WWDCNotes":{"abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"title":"WWDC Notes","type":"topic","kind":"symbol","role":"collection","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"url":"\/documentation\/wwdcnotes","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-230-Making-Apps-with-Core-Data":{"role":"sampleCode","title":"Making Apps with Core Data","url":"\/documentation\/wwdcnotes\/wwdc19-230-making-apps-with-core-data","abstract":[{"type":"text","text":"Core Data helps manage the flow of data throughout your app. Hear about new features in Core Data that make your code simpler and more powerful, including derived attributes, history tracking, change notifications and batch operations. Learn more about using these facilities and the new diffing APIs in UIKit and Foundation to make your apps run more efficiently."}],"type":"topic","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-230-Making-Apps-with-Core-Data"},"zntfdr.jpeg":{"type":"image","identifier":"zntfdr.jpeg","variants":[{"url":"\/images\/WWDCNotes\/zntfdr.jpeg","traits":["1x","light"]}],"alt":null},"https://developer.apple.com/documentation/uikit/uicollectionviewdiffabledatasource":{"titleInlineContent":[{"code":"UICollectionViewDiffableDataSource","type":"codeVoice"}],"url":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionviewdiffabledatasource","identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uicollectionviewdiffabledatasource","title":"UICollectionViewDiffableDataSource","type":"link"},"zntfdr":{"variants":[{"url":"\/images\/WWDCNotes\/zntfdr.jpeg","traits":["1x","light"]}],"alt":"Profile image of Federico Zanetello","type":"image","identifier":"zntfdr"},"WWDC19-Icon.png":{"type":"image","identifier":"WWDC19-Icon.png","variants":[{"url":"\/images\/WWDCNotes\/WWDC19-Icon.png","traits":["1x","light"]}],"alt":null},"WWDC19.jpeg":{"variants":[{"url":"\/images\/WWDCNotes\/WWDC19.jpeg","traits":["1x","light"]}],"identifier":"WWDC19.jpeg","type":"image","alt":null},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"title":"Contributions are welcome!","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"link","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC20-10045-Advances-in-diffable-data-sources":{"role":"sampleCode","title":"Advances in diffable data sources","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10045-Advances-in-diffable-data-sources","type":"topic","abstract":[{"type":"text","text":"Diffable data sources dramatically simplify the work involved in managing and updating collection and table views to create dynamic and responsive experiences in your apps. Discover how you can use section snapshots to efficiently build lists and outline collection views for iOS and iPadOS and provide support for implementing the sidebar in an iPad app. We‚Äôll also show you how to simplify cell reordering using UICollectionViewDiffableDataSource to help you streamline your code and build app interfaces more quickly."}],"url":"\/documentation\/wwdcnotes\/wwdc20-10045-advances-in-diffable-data-sources"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19-215-Advances-in-Collection-View-Layout":{"title":"Advances in Collection View Layout","url":"\/documentation\/wwdcnotes\/wwdc19-215-advances-in-collection-view-layout","abstract":[{"type":"text","text":"Collection View Layouts make it easy to build rich interactive collections. Learn how to make dynamic and responsive layouts that range in complexity from basic lists to an advanced, multi-dimensional browsing experience."}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-215-Advances-in-Collection-View-Layout","kind":"article","type":"topic","role":"sampleCode"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC20-10097-Advances-in-UICollectionView":{"url":"\/documentation\/wwdcnotes\/wwdc20-10097-advances-in-uicollectionview","kind":"article","role":"sampleCode","abstract":[{"type":"text","text":"Learn about new features of UICollectionView that make it easier to use and unlock powerful new functionality. We‚Äôll show you how to use section snapshots with your diffable data source to create outlines that can expand and collapse, and introduce you to building lists with compositional layout to create UITableView-like interfaces with a collection view. And discover modern techniques for dequeuing cells and configuring their content and styling."}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10097-Advances-in-UICollectionView","type":"topic","title":"Advances in UICollectionView"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC20-10105-Build-for-iPad":{"abstract":[{"text":"Learn how to improve iPad apps to leverage the increased screen size and additional features of iPadOS, and help people accomplish more with their devices. Discover how you can build detailed multi-column layouts and integrate lists into your app with little adjustment to your existing code. We‚Äôll also explore reducing modality within your views to make it easier to navigate your interface with fewer taps and touches.","type":"text"}],"url":"\/documentation\/wwdcnotes\/wwdc20-10105-build-for-ipad","role":"sampleCode","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC20-10105-Build-for-iPad","type":"topic","title":"Build for iPad"},"https://developer.apple.com/documentation/uikit/uitableviewdiffabledatasource":{"title":"UITableViewDiffableDataSource","type":"link","identifier":"https:\/\/developer.apple.com\/documentation\/uikit\/uitableviewdiffabledatasource","titleInlineContent":[{"code":"UITableViewDiffableDataSource","type":"codeVoice"}],"url":"https:\/\/developer.apple.com\/documentation\/uikit\/uitableviewdiffabledatasource"},"WWDCNotes.png":{"variants":[{"url":"\/images\/WWDCNotes\/WWDCNotes.png","traits":["1x","light"]}],"identifier":"WWDCNotes.png","type":"image","alt":null},"https://developer.apple.com/wwdc19/220":{"checksum":null,"url":"https:\/\/developer.apple.com\/wwdc19\/220","type":"download","identifier":"https:\/\/developer.apple.com\/wwdc19\/220"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"abstract":[{"text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more.","type":"text"}],"title":"Federico Zanetello (332 notes)","type":"topic","kind":"article","role":"sampleCode","images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","url":"\/documentation\/wwdcnotes\/zntfdr"}}}