{"schemaVersion":{"patch":0,"major":0,"minor":3},"sections":[],"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc23-10168-generalize-apis-with-parameter-packs"]}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23"]]},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10168-Generalize-APIs-with-parameter-packs"},"primaryContentSections":[{"kind":"content","content":[{"text":"Overview","anchor":"overview","level":2,"type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"This is an advanced talk. Deep understanding of Swift Generics and Variadics is required."}]}]},{"content":[{"inlineContent":[{"text":"Feature introduced in Swift 5.9, Xcode 15.","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"text":"What Parameter Packs Solves","anchor":"What-Parameter-Packs-Solves","level":2,"type":"heading"},{"inlineContent":[{"type":"text","text":"You can use variadics to pass a variable number of arguments to a function, but all arguments must be of the same type."}],"type":"paragraph"},{"inlineContent":[{"text":"Problem 1: you can’t pass a variable number of arguments of different types without using type erasure.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Problem 2: let’s say you want the return value of said function to be a tuple with the number of elements depending on the number of arguments that was passed in. You can’t do that either.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"What we lack with the generics system and variadic parameters is the ability to both preserve type information and vary the number of arguments. The only way to do this today is with overloading, which forces you to choose an upper bound of the number of arguments you support.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"tl;dr: remember ","type":"text"},{"code":"zip3(…)","type":"codeVoice"},{"text":", ","type":"text"},{"code":"zip4(…)","type":"codeVoice"},{"text":", ","type":"text"},{"code":"zip5(…)","type":"codeVoice"},{"text":", ","type":"text"},{"code":"zip6(…)","type":"codeVoice"},{"text":"…? Parameter packs solve that.","type":"text"}],"type":"paragraph"},{"text":"How to Read Parameter Packs (Introducing The New Syntax)","anchor":"How-to-Read-Parameter-Packs-Introducing-The-New-Syntax","level":2,"type":"heading"},{"inlineContent":[{"type":"text","text":"A type pack is a list of types. A value pack is a list of values."}],"type":"paragraph"},{"syntax":"swift","code":["func query<each Payload> \/\/ Example of a type parameter pack"],"type":"codeListing"},{"inlineContent":[{"text":"Naming convention: use the singular form after the keyword ","type":"text"},{"type":"codeVoice","code":"each"},{"text":", e.g. ","type":"text"},{"type":"codeVoice","code":"each Payload"},{"text":", instead of ","type":"text"},{"type":"codeVoice","code":"each Payloads"},{"text":".","type":"text"}],"type":"paragraph"},{"content":[{"inlineContent":[{"type":"text","text":"45 to 08:27 to visualize the animated code examples, it’s worth it."}],"type":"paragraph"}],"style":"note","name":"For the remaining of this section, I’ll paraphrase the presenter and their code examples, because the session video was spot on. If you have the chance, watch the session video from 06","type":"aside"},{"inlineContent":[{"text":"Generic code that uses parameter packs can operate on each Payload individually using repetition patterns. A repetition pattern is expressed using the ‘repeat’ keyword, followed by a type called the pattern type. The pattern will contain one or more references to pack elements. ‘repeat’ indicates that the pattern type will be repeated for every element in the given argument pack. ‘each’ acts as a placeholder that is replaced with individual pack elements at every iteration:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["repeat Request<each Payload>"],"type":"codeListing"},{"inlineContent":[{"text":"Let’s see how this replacement works with a concrete type pack containing Bool, Int, and String. The pattern will be repeated three times and the placeholder ‘each Payload’ is replaced with the concrete type in the pack during each repetition:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["","Request<each Payload>, Request<each Payload>, Request<each Payload>","","        Bool                   Int                    String"],"type":"codeListing"},{"inlineContent":[{"text":"The result is a comma-separated list of types: Request of Bool, Request of Int, and Request of String:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["Request<Bool>, Request<Int>, Request<String>"],"type":"codeListing"},{"inlineContent":[{"text":"Because repetition patterns produce comma-separated lists of types, they can only be used in positions that naturally accept comma-separated lists. This includes types wrapped in parentheses, which are either a tuple type or a single type:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["(repeat Request<each Payload>)","(Request<Bool>, Request<Int>, Request<String>)"],"type":"codeListing"},{"inlineContent":[{"text":"Repetition patterns can be used in generic argument lists:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["Generic<repeat Request<each Payload>>","Generic<Request<Bool>, Request<Int>, Request<String>>"],"type":"codeListing"},{"inlineContent":[{"text":"They can also be used in function parameter lists:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["(_ item: repeat Request<each Payload>) -> Bool"],"type":"codeListing"},{"inlineContent":[{"text":"Basically, when using this with function parameter, it’s the equivalent of variadic parameters, but with type information preserved.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Thus, this mess:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["func query<Payload>(","  _ item: Request<Payload>",") -> Payload","","func query<Payload1, Payload2>(","  _ item1: Request<Payload1>,","  _ item2: Request<Payload2>",") -> (Payload1, Payload2)","","func query<Payload1, Payload2, Payload3>(","  _ item1: Request<Payload1>,","  _ item2: Request<Payload2>,","  _ item3: Request<Payload3>",") -> (Payload1, Payload2, Payload3)","","func query<Payload1, Payload2, Payload3, Payload4>(","  _ item1: Request<Payload1>,","  _ item2: Request<Payload2>,","  _ item3: Request<Payload3>,","  _ item4: Request<Payload4>",") -> (Payload1, Payload2, Payload3, Payload4)"],"type":"codeListing"},{"inlineContent":[{"text":"Becomes this one-liner, for any number of arguments:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["func query<each Payload>(_ item: repeat Request<each Payload>) -> (repeat each Payload)"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Note that the number of elements returned in the return value will match the number of elements passed in the argument pack."}],"type":"paragraph"},{"inlineContent":[{"text":"You can make your generic ","type":"text"},{"code":"Payload","type":"codeVoice"},{"text":" conform to protocols like usual, e.g.:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["func query<each Payload: Equatable>(_ item: repeat Request<each Payload>) -> (repeat each Payload)","","\/\/ Or","","func query<each Payload>(_ item: repeat Request<each Payload>) -> (repeat each Payload) where repeat each Payload: Equatable"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Implementing a function with a minimum of 1 argument:"}],"type":"paragraph"},{"syntax":"swift","code":["func query<FirstPayload, each Payload>(","  _ first: Request<FirstPayload>, _ item: repeat Request<each Payload>",") -> (FirstPayload, repeat each Payload)","  where FirstPayload: Equatable, repeat each Payload: Equatable"],"type":"codeListing"},{"text":"Using Parameter Packs","anchor":"Using-Parameter-Packs","level":2,"type":"heading"},{"inlineContent":[{"text":"Use this syntax to iterate over the elements of a pack:","type":"text"}],"type":"paragraph"},{"syntax":"swift","code":["struct Request<Payload> {","  func evaluate() -> Payload","}","","func query<each Payload>(_ item: repeat Request<each Payload>) -> (repeat each Payload) {","  return (repeat (each item).evaluate())","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"The parenthesis around the "},{"type":"codeVoice","code":"repeat (each item).evaluate()"},{"type":"text","text":" make the return value return a tuple. Note that it’s clever enough so that, if the parameter pack only has one element, it will return a single value instead of a tuple."}],"type":"paragraph"},{"text":"Related Sessions","anchor":"Related-Sessions","level":1,"type":"heading"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"reference","identifier":"https:\/\/wwdcnotes.com\/notes\/wwdc22\/110352\/","isActive":true}]}]},{"content":[{"inlineContent":[{"type":"reference","isActive":true,"identifier":"https:\/\/wwdcnotes.com\/notes\/wwdc22\/110353\/"}],"type":"paragraph"}]}],"type":"unorderedList"},{"text":"Written By","anchor":"Written-By","level":2,"type":"heading"},{"columns":[{"size":1,"content":[{"type":"paragraph","inlineContent":[{"identifier":"rogerluan","type":"image"}]}]},{"size":4,"content":[{"anchor":"Roger-Oba","type":"heading","level":3,"text":"Roger Oba"},{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/rogerluan","isActive":true,"type":"reference","overridingTitle":"Contributed Notes","overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}]},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/github.com\/rogerluan","isActive":true,"type":"reference"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/www.roger.ml","isActive":true,"type":"reference"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/x.com\/rogerluan_","isActive":true,"type":"reference"}]}]}],"numberOfColumns":5,"type":"row"},{"inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference"}],"type":"paragraph"},{"text":"Related Sessions","anchor":"Related-Sessions","level":2,"type":"heading"},{"items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10164-Whats-new-in-Swift","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110352-Embrace-Swift-generics","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110353-Design-protocol-interfaces-in-Swift"],"style":"list","type":"links"},{"inlineContent":[{"inlineContent":[{"text":"Legal Notice","type":"text"}],"type":"strong"}],"type":"small"},{"inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}],"type":"small"}]}],"kind":"article","metadata":{"roleHeading":"WWDC23","modules":[{"name":"WWDC Notes"}],"title":"Generalize APIs with parameter packs","role":"sampleCode"},"sampleCodeDownload":{"kind":"sampleDownload","action":{"identifier":"https:\/\/developer.apple.com\/wwdc23\/10168","type":"reference","isActive":true,"overridingTitle":"Watch Video (18 min)"}},"abstract":[{"text":"Swift parameter packs are a powerful tool to expand what is possible in your generic code while also enabling you to simplify common generic patterns. We’ll show you how to abstract over types as well as the number of arguments in generic code and simplify common generic patterns to avoid overloads.","type":"text"}],"references":{"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10164-Whats-new-in-Swift":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10164-Whats-new-in-Swift","role":"sampleCode","title":"What’s new in Swift","abstract":[{"text":"Join us for an update on Swift. We’ll show you how APIs are becoming more extensible and expressive with features like parameter packs and macros. We’ll also take you through improvements to interoperability and share how we’re expanding Swift’s performance and safety benefits everywhere from Foundation to large-scale distributed programs on the server.","type":"text"}],"kind":"article","url":"\/documentation\/wwdcnotes\/wwdc23-10164-whats-new-in-swift","type":"topic"},"WWDCNotes.png":{"type":"image","identifier":"WWDCNotes.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"alt":null},"https://wwdcnotes.com/notes/wwdc22/110352/":{"type":"link","title":"Embrace Swift Generics - WWDC22","url":"https:\/\/wwdcnotes.com\/notes\/wwdc22\/110352\/","titleInlineContent":[{"type":"text","text":"Embrace Swift Generics - WWDC22"}],"identifier":"https:\/\/wwdcnotes.com\/notes\/wwdc22\/110352\/"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-110352-Embrace-Swift-generics":{"type":"topic","title":"Embrace Swift generics","url":"\/documentation\/wwdcnotes\/wwdc22-110352-embrace-swift-generics","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110352-Embrace-Swift-generics","abstract":[{"type":"text","text":"Generics are a fundamental tool for writing abstract code in Swift. Learn how you can identify opportunities for abstraction as your code evolves, evaluate strategies for writing one piece of code with many behaviors, and discover language features in Swift 5.7 that can help you make generic code easier to write and understand."}],"kind":"article","role":"sampleCode"},"rogerluan":{"type":"image","identifier":"rogerluan","variants":[{"traits":["1x","light"],"url":"\/images\/rogerluan.jpeg"}],"alt":"Profile image of Roger Oba"},"doc://WWDCNotes/documentation/WWDCNotes/rogerluan":{"type":"topic","title":"Roger Oba (7 notes)","url":"\/documentation\/wwdcnotes\/rogerluan","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/rogerluan","abstract":[{"type":"text","text":"Core contributor @fastlane 🚀"}],"kind":"article","role":"sampleCode","images":[{"type":"card","identifier":"rogerluan.jpeg"},{"type":"icon","identifier":"rogerluan.jpeg"}]},"rogerluan.jpeg":{"type":"image","identifier":"rogerluan.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/rogerluan.jpeg"}],"alt":null},"WWDC23.jpeg":{"type":"image","identifier":"WWDC23.jpeg","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC23.jpeg"}],"alt":null},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23","role":"collectionGroup","title":"WWDC23","abstract":[{"text":"Xcode 15, Swift 5.9, iOS 17, macOS 14 (Sonoma), tvOS 17, visionOS 1, watchOS 10.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"type":"codeVoice","code":"SwiftData"},{"text":", ","type":"text"},{"type":"codeVoice","code":"Observation"},{"text":", ","type":"text"},{"type":"codeVoice","code":"StoreKit"},{"text":" views, and more.","type":"text"}],"kind":"article","url":"\/documentation\/wwdcnotes\/wwdc23","images":[{"identifier":"WWDC23-Icon.png","type":"icon"},{"identifier":"WWDC23.jpeg","type":"card"}],"type":"topic"},"WWDC23-Icon.png":{"type":"image","identifier":"WWDC23-Icon.png","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC23-Icon.png"}],"alt":null},"https://x.com/rogerluan_":{"type":"link","title":"X\/Twitter","url":"https:\/\/x.com\/rogerluan_","titleInlineContent":[{"type":"text","text":"X\/Twitter"}],"identifier":"https:\/\/x.com\/rogerluan_"},"https://www.roger.ml":{"type":"link","title":"Blog","url":"https:\/\/www.roger.ml","titleInlineContent":[{"type":"text","text":"Blog"}],"identifier":"https:\/\/www.roger.ml"},"https://developer.apple.com/wwdc23/10168":{"type":"download","url":"https:\/\/developer.apple.com\/wwdc23\/10168","identifier":"https:\/\/developer.apple.com\/wwdc23\/10168","checksum":null},"doc://WWDCNotes/documentation/WWDCNotes":{"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","kind":"symbol","url":"\/documentation\/wwdcnotes","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"title":"WWDC Notes","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"role":"collection"},"https://wwdcnotes.com/notes/wwdc22/110353/":{"type":"link","title":"Design protocol interfaces in Swift - WWDC22","url":"https:\/\/wwdcnotes.com\/notes\/wwdc22\/110353\/","titleInlineContent":[{"type":"text","text":"Design protocol interfaces in Swift - WWDC22"}],"identifier":"https:\/\/wwdcnotes.com\/notes\/wwdc22\/110353\/"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC22-110353-Design-protocol-interfaces-in-Swift":{"type":"topic","title":"Design protocol interfaces in Swift","url":"\/documentation\/wwdcnotes\/wwdc22-110353-design-protocol-interfaces-in-swift","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC22-110353-Design-protocol-interfaces-in-Swift","abstract":[{"type":"text","text":"Learn how you can use Swift 5.7 to design advanced abstractions using protocols. We’ll show you how to use existential types, explore how you can separate implementation from interface with opaque result types, and share the same-type requirements that can help you identify and guarantee relationships between concrete types."}],"kind":"article","role":"sampleCode"},"https://github.com/rogerluan":{"type":"link","title":"GitHub","url":"https:\/\/github.com\/rogerluan","titleInlineContent":[{"type":"text","text":"GitHub"}],"identifier":"https:\/\/github.com\/rogerluan"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"type":"link","title":"Contributions are welcome!","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}],"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"}}}