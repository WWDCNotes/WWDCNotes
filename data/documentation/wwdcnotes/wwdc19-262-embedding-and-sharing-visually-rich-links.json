{"metadata":{"title":"Embedding and Sharing Visually Rich Links","modules":[{"name":"WWDC Notes"}],"roleHeading":"WWDC19","role":"sampleCode"},"sampleCodeDownload":{"action":{"overridingTitle":"Watch Video (6 min)","isActive":true,"identifier":"https:\/\/developer.apple.com\/wwdc19\/262","type":"reference"},"kind":"sampleDownload"},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19"]]},"sections":[],"kind":"article","schemaVersion":{"minor":3,"patch":0,"major":0},"abstract":[{"type":"text","text":"The new Link Presentation framework enables app developers to easily present URLs in a rich, beautiful, and consistent way. Learn how to use Link Presentation to retrieve metadata from a URL, present the rich link content inside your app, and provide link metadata to the new share sheet experience in iOS."}],"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc19-262-embedding-and-sharing-visually-rich-links"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"kind":"content","content":[{"level":2,"type":"heading","text":"Introduction","anchor":"Introduction"},{"type":"paragraph","inlineContent":[{"type":"text","text":"In iOS 10 and macOS Sierra, Messages got Rich Links to make URLs more beautiful and useful. Rich links were customized for certain types of media, including audio\/video playback, Twitter tweets, Apple Maps links, and more."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"iOS 13 and macOS 10.15 introduce new APIs that allow developers to put Rich Links in their own apps."}]},{"type":"paragraph","inlineContent":[{"text":"The video shows how to turn a table view of recipe links into Rich Links. Our starting point looks like this:","type":"text"}]},{"type":"paragraph","inlineContent":[{"identifier":"WWDC19-262-starting_point","type":"image"}]},{"level":3,"type":"heading","text":"Retrieving metadata","anchor":"Retrieving-metadata"},{"type":"paragraph","inlineContent":[{"identifier":"WWDC19-262-lp_metadata_diagram","type":"image"}]},{"type":"paragraph","inlineContent":[{"text":"The ","type":"text"},{"code":"LPMetadataProvider","type":"codeVoice"},{"text":" class takes a URL and returns an ","type":"text"},{"code":"LPLinkMetadata","type":"codeVoice"},{"text":" object with the title and any available media.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"Let’s assume we’re configuring a ","type":"text"},{"type":"codeVoice","code":"UITableViewCell"},{"text":":","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["let metadataProvider = LPMetadataProvider()","let url = URL(string: \"https:\/\/www.apple.com\/ipad\")!","","metadataProvider.startFetchingMetadata(for: url) { metadata, error in","  if error != nil {","    \/\/ The fetch failed; handle the error.","    \/\/ Examples: server doesn't respond, is too slow, user doesn't have network.","    return","  }","","  \/\/ Make use of the fetched metadata.","}"]},{"level":4,"type":"heading","text":"Things to keep in mind with `LPMetadataProvider` and `LPLinkMetadata`.","anchor":"Things-to-keep-in-mind-with-LPMetadataProvider-and-LPLinkMetadata"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"text":"Title, icon, image, and video are all optional.","type":"text"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"LPLinkMetadata","type":"codeVoice"},{"text":" is serializable with ","type":"text"},{"code":"NSSecureCoding","type":"codeVoice"},{"text":". This means you can and should cache metadata locally as much as possible.","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Can also be used for local file URLs. Quick Look provides the thumbnail for the file if possible.","type":"text"}]}]}]},{"level":3,"type":"heading","text":"Presenting links","anchor":"Presenting-links"},{"type":"paragraph","inlineContent":[{"identifier":"WWDC19-262-lp_link_view","type":"image"}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Continuing the previous example, replace"}]},{"type":"codeListing","syntax":"swift","code":["\/\/ Make use of the fetched metadata"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"with the following"}]},{"type":"codeListing","syntax":"swift","code":["let linkView = LPLinkView(metadata: metadata)","cell.contentView.addSubview(linkView)","linkView.sizeToFit()"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Our app now looks like this:"}]},{"type":"paragraph","inlineContent":[{"identifier":"WWDC19-262-rich_links","type":"image"}]},{"type":"paragraph","inlineContent":[{"text":"Note that ","type":"text"},{"code":"LPLinkView","type":"codeVoice"},{"text":" has an intrinsic size, but it also responds to ","type":"text"},{"code":"sizeThatFits()","type":"codeVoice"},{"text":" for an ideal size given the surrounding constraints, and it will try to present a layout that’s reasonable at any size.","type":"text"}]},{"level":3,"type":"heading","text":"Accelerating the iOS 13 share sheet","anchor":"Accelerating-the-iOS-13-share-sheet"},{"type":"paragraph","inlineContent":[{"type":"text","text":"For existing apps that share URLs, the share sheet will automatically present a preview of the link at the top of the card."}]},{"type":"paragraph","inlineContent":[{"identifier":"WWDC19-262-link_at_top","type":"image"}]},{"type":"paragraph","inlineContent":[{"text":"However, this requires reaching out to the server to retrieve metadata ","type":"text"},{"inlineContent":[{"text":"once the share sheet is presented","type":"text"}],"type":"emphasis"},{"text":", so the title and icon show up asynchronously.","type":"text"}]},{"type":"paragraph","inlineContent":[{"text":"If you already have the metadata, you can send it to the share sheet and the preview will appear instantly:","type":"text"}]},{"type":"codeListing","syntax":"swift","code":["\/\/ Provide prefetched metadata to UIActivityViewController in your implementation","\/\/ of UIActivityItemSource","","func activityViewControllerLinkMetadata(_: UIActivityViewController) -> LPLinkMetadata? {","  return self.metadata","}"]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Also, when the user chooses to pass that metadata on, say by sending a message, that preview appears instantly."}]},{"type":"paragraph","inlineContent":[{"type":"text","text":"Lastly, you can provide custom or missing metadata information inside the "},{"type":"codeVoice","code":"activityViewControllerLinkMetadata(_:)"},{"type":"text","text":" method:"}]},{"type":"codeListing","syntax":"swift","code":["func activityViewControllerLinkMetadata(_: UIActivityViewController) -> LPLinkMetadata? {","  let metadata = LPLinkMetadata()","","  \/\/ `originalURL` and `url` fields are required. Everything else is optional.","  metadata.originalURL = URL(string: \"https:\/\/www.example.com\/apple-pie\")","  metadata.url = metadata.originalURL","  metadata.title = \"The Greatest Apple Pie In The World\"","  metadata.imageProvider = NSItemProvider.init(","    contentsOf: Bundle.main.url(forResource: \"apple-pie\", withExtension: \"jpg\")","  )","  return metadata","}"]},{"level":3,"type":"heading","text":"Summary","anchor":"Summary"},{"type":"paragraph","inlineContent":[{"type":"image","identifier":"WWDC19-262-summary"}]},{"level":2,"type":"heading","text":"Written By","anchor":"Written-By"},{"numberOfColumns":5,"type":"row","columns":[{"content":[{"inlineContent":[{"type":"image","identifier":"skhillon"}],"type":"paragraph"}],"size":1},{"content":[{"text":"Sarthak Khillon","level":3,"anchor":"Sarthak-Khillon","type":"heading"},{"inlineContent":[{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/skhillon","type":"reference","overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}],"overridingTitle":"Contributed Notes","isActive":true},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/github.com\/skhillon","type":"reference","isActive":true},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","identifier":"https:\/\/www.linkedin.com\/in\/sarthakkhillon\/","isActive":true},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"type":"reference","identifier":"https:\/\/x.com\/SarthakKhillon","isActive":true}],"type":"paragraph"}],"size":4}]},{"type":"paragraph","inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference","isActive":true}]},{"level":2,"type":"heading","text":"Related Sessions","anchor":"Related-Sessions"},{"type":"small","inlineContent":[{"inlineContent":[{"text":"Legal Notice","type":"text"}],"type":"strong"}]},{"type":"small","inlineContent":[{"type":"text","text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved."},{"type":"text","text":" "},{"type":"text","text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries."},{"type":"text","text":" "},{"type":"text","text":"This website is not made by, affiliated with, nor endorsed by Apple."}]}]}],"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-262-Embedding-and-Sharing-Visually-Rich-Links"},"references":{"WWDC19-262-lp_metadata_diagram":{"alt":null,"type":"image","identifier":"WWDC19-262-lp_metadata_diagram","variants":[{"url":"\/images\/WWDC19-262-lp_metadata_diagram.png","traits":["1x","light"]}]},"WWDC19-262-link_at_top":{"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19-262-link_at_top.png"}],"alt":null,"identifier":"WWDC19-262-link_at_top"},"https://www.linkedin.com/in/sarthakkhillon/":{"title":"Blog","titleInlineContent":[{"type":"text","text":"Blog"}],"url":"https:\/\/www.linkedin.com\/in\/sarthakkhillon\/","type":"link","identifier":"https:\/\/www.linkedin.com\/in\/sarthakkhillon\/"},"WWDCNotes.png":{"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/WWDCNotes.png"}],"alt":null,"identifier":"WWDCNotes.png"},"WWDC19-262-rich_links":{"alt":null,"type":"image","identifier":"WWDC19-262-rich_links","variants":[{"url":"\/images\/WWDC19-262-rich_links.png","traits":["1x","light"]}]},"https://x.com/SarthakKhillon":{"type":"link","url":"https:\/\/x.com\/SarthakKhillon","identifier":"https:\/\/x.com\/SarthakKhillon","title":"X\/Twitter","titleInlineContent":[{"type":"text","text":"X\/Twitter"}]},"skhillon":{"alt":"Profile image of Sarthak Khillon","type":"image","identifier":"skhillon","variants":[{"url":"\/images\/skhillon.jpeg","traits":["1x","light"]}]},"https://github.com/skhillon":{"type":"link","url":"https:\/\/github.com\/skhillon","identifier":"https:\/\/github.com\/skhillon","title":"GitHub","titleInlineContent":[{"type":"text","text":"GitHub"}]},"WWDC19-262-lp_link_view":{"alt":null,"type":"image","identifier":"WWDC19-262-lp_link_view","variants":[{"url":"\/images\/WWDC19-262-lp_link_view.png","traits":["1x","light"]}]},"https://developer.apple.com/wwdc19/262":{"type":"download","url":"https:\/\/developer.apple.com\/wwdc19\/262","checksum":null,"identifier":"https:\/\/developer.apple.com\/wwdc19\/262"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19":{"images":[{"identifier":"WWDC19-Icon.png","type":"icon"},{"identifier":"WWDC19.jpeg","type":"card"}],"role":"collectionGroup","url":"\/documentation\/wwdcnotes\/wwdc19","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19","abstract":[{"text":"Xcode 11, Swift 5.1, iOS 13, macOS 10.15 (Catalina), tvOS 13, watchOS 6.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"code":"Combine","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Core Haptics","type":"codeVoice"},{"text":", ","type":"text"},{"code":"Create ML","type":"codeVoice"},{"text":", and more.","type":"text"}],"kind":"article","type":"topic","title":"WWDC19"},"WWDC19-262-starting_point":{"type":"image","identifier":"WWDC19-262-starting_point","alt":null,"variants":[{"url":"\/images\/WWDC19-262-starting_point.png","traits":["1x","light"]}]},"WWDC19.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19.jpeg"}],"identifier":"WWDC19.jpeg","type":"image","alt":null},"doc://WWDCNotes/documentation/WWDCNotes/skhillon":{"type":"topic","url":"\/documentation\/wwdcnotes\/skhillon","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/skhillon","kind":"article","abstract":[{"type":"text","text":"No Bio on GitHub"}],"images":[{"identifier":"skhillon.jpeg","type":"card"},{"identifier":"skhillon.jpeg","type":"icon"}],"role":"sampleCode","title":"Sarthak Khillon (19 notes)"},"WWDC19-Icon.png":{"type":"image","identifier":"WWDC19-Icon.png","alt":null,"variants":[{"url":"\/images\/WWDC19-Icon.png","traits":["1x","light"]}]},"skhillon.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/skhillon.jpeg"}],"identifier":"skhillon.jpeg","type":"image","alt":null},"doc://WWDCNotes/documentation/WWDCNotes":{"url":"\/documentation\/wwdcnotes","role":"collection","type":"topic","images":[{"identifier":"WWDCNotes.png","type":"icon"}],"abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","kind":"symbol","title":"WWDC Notes"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"type":"link","titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}],"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"WWDC19-262-summary":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDC19-262-summary.png"}],"identifier":"WWDC19-262-summary","type":"image","alt":null}}}