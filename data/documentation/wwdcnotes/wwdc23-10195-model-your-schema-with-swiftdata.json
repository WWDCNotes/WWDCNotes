{"sections":[],"metadata":{"title":"Model your schema with SwiftData","roleHeading":"WWDC23","modules":[{"name":"WWDC Notes"}],"role":"sampleCode"},"variants":[{"traits":[{"interfaceLanguage":"swift"}],"paths":["\/documentation\/wwdcnotes\/wwdc23-10195-model-your-schema-with-swiftdata"]}],"schemaVersion":{"major":0,"minor":3,"patch":0},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10195-Model-your-schema-with-SwiftData"},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23"]]},"abstract":[{"text":"Learn how to use schema macros and migration plans with SwiftData to build more complex features for your app. We’ll show you how to fine-tune your persistence with @Attribute and @Relationship options. Learn how to exclude properties from your data model with @Transient and migrate from one version of your schema to the next with ease.","type":"text"}],"kind":"article","primaryContentSections":[{"content":[{"text":"Utilizing schema macros","anchor":"Utilizing-schema-macros","type":"heading","level":2},{"items":[{"content":[{"inlineContent":[{"type":"codeVoice","code":"import SwiftData"},{"type":"text","text":" and mark "},{"type":"codeVoice","code":"class"},{"type":"text","text":" with "},{"type":"codeVoice","code":"@Model"},{"type":"text","text":" to create schema"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Use "},{"code":"@Attribute(.unique)","type":"codeVoice"},{"type":"text","text":" to make field unique, if already exists, then “upsert” will happen, updating existing data (insert -> update)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Uniqueness available for primitive value types: Numeric, String, UUID – can also decorate relationships"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Renaming variables without any attributes generates new properties and deletes old"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"To keep data but rename field, specify "},{"type":"codeVoice","code":"@Attribute(originalName: \"oldName\")"},{"type":"text","text":" to map data"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"code":"@Attribute","type":"codeVoice"},{"text":" also supports storing large data externally, supplying support for ","type":"text"},{"code":"Transformable","type":"codeVoice"},{"text":"s, integrate with Spotlight, modify hash","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"SwiftData implicitly discoveres (inverse) relationships between models for fields like "},{"type":"codeVoice","code":"var bucketList: [BucketListItem]? = []"}]}]},{"content":[{"inlineContent":[{"text":"The default deletion strategy for relationships when no annotations provided is “nil out”","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"To delete relationships alongside, specify attribute ","type":"text"},{"code":"@Relationship(.cascade)","type":"codeVoice"},{"text":" explicitly","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"@Relationship"},{"type":"text","text":" modifier also supports "},{"type":"codeVoice","code":"originalName"},{"type":"text","text":" and constraints on "},{"type":"codeVoice","code":"toMany"},{"type":"text","text":" for min\/max count constraints, plus modifying hash"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"To exclude a stored property from the schema, annotate it with ","type":"text"},{"code":"@Transient","type":"codeVoice"},{"text":" – a default value is required","type":"text"}]}]}],"type":"unorderedList"},{"text":"Evolving schemas","anchor":"Evolving-schemas","type":"heading","level":2},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Define an enum conforming to "},{"type":"codeVoice","code":"VersionedSchema"},{"type":"text","text":" and put your models inside the enum (used as a namespace)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Order versions with ","type":"text"},{"code":"SchemaMigrationPlan","type":"codeVoice"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Define migration stage: Lightweight (no code required), Custom (code needed)"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Provide "},{"code":"migrationPlan","type":"codeVoice"},{"type":"text","text":" to "},{"code":"ModelContainer","type":"codeVoice"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"text":"Example for ","type":"text"},{"code":"VersionedSchema","type":"codeVoice"},{"text":":","type":"text"}],"type":"paragraph"},{"syntax":"Swift","code":["enum SampleTripsSchemaV2: VersionedSchema {","  static var models: [any PersistentModel.Type] {","    [Trip.self, BucketListItem.self, LivingAccommodation.self]","  }","  ","  @Model","  final class Trip {","    @Attribute(.unique)","    var name: String","","    var destination: String","    var start_date: Date","    var end_date: Date","    ","    var bucketList: [BucketListItem]? = []","    var livingAccommodation: LivingAccommodation?","  }","  ","  \/\/ other models","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Example for "},{"code":"SchemaMigrationPlan","type":"codeVoice"},{"type":"text","text":":"}],"type":"paragraph"},{"syntax":"Swift","code":["enum SampleTripsMigrationPlan: SchemaMigrationPlan {","  static var schemas: [any VersionedSchema.Type] {","    [SampleTripsSchemaV1.self, SampleTripsSchemaV2.self, SampleTripsSchemaV3.self]","  }","","  static var stages: [MigrationStage] { [migrateV1toV2] }","","  static let migrateVltoV2 = MigrationStage.custom(","    fromVersion: SampleTripsSchemaV1.self, ","    toVersion: SampleTripsSchemaV2.self,","    willMigrate: { context in","      let trips = try? context.fetch(FetchDescriptor<SampleTripsSchemaV1.Trip> ())","      \/\/ De-duplicate Trip instances here..","      try? context.save ()","    },","    didMigrate: nil","  )","}"],"type":"codeListing"},{"inlineContent":[{"type":"text","text":"Example for passing migration plan to model container:"}],"type":"paragraph"},{"syntax":"Swift","code":["struct TripsApp: App {","  let container = ModelContainer(for: Trip.self, migrationPlan: SampleTripsMigrationPlan.self)","    ","  var body: some Scene {","    WindowGroup {","      ContentView()","    }","    .modelContainer(container)","  }","}"],"type":"codeListing"},{"text":"Written By","anchor":"Written-By","type":"heading","level":2},{"columns":[{"size":1,"content":[{"inlineContent":[{"identifier":"Jeehut","type":"image"}],"type":"paragraph"}]},{"size":4,"content":[{"text":"Cihat Gündüz","type":"heading","anchor":"Cihat-Gündüz","level":3},{"type":"paragraph","inlineContent":[{"overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}],"overridingTitle":"Contributed Notes","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/Jeehut","isActive":true,"type":"reference"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/github.com\/Jeehut","isActive":true,"type":"reference"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/x.com\/Jeehut","isActive":true,"type":"reference"},{"type":"text","text":" "},{"type":"text","text":"|"},{"type":"text","text":" "},{"identifier":"https:\/\/fline.dev","isActive":true,"type":"reference"}]}]}],"type":"row","numberOfColumns":5},{"inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference"}],"type":"paragraph"},{"text":"Related Sessions","anchor":"Related-Sessions","type":"heading","level":2},{"style":"list","items":["doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10149-Discover-Observation-in-SwiftUI","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10154-Build-an-app-with-SwiftData","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10187-Meet-SwiftData","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10189-Migrate-to-SwiftData","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10196-Dive-deeper-into-SwiftData"],"type":"links"},{"inlineContent":[{"inlineContent":[{"text":"Legal Notice","type":"text"}],"type":"strong"}],"type":"small"},{"inlineContent":[{"text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}],"type":"small"}],"kind":"content"}],"sampleCodeDownload":{"kind":"sampleDownload","action":{"type":"reference","identifier":"https:\/\/developer.apple.com\/wwdc23\/10195","overridingTitle":"Watch Video (9 min)","isActive":true}},"references":{"doc://WWDCNotes/documentation/WWDCNotes/Jeehut":{"role":"sampleCode","images":[{"type":"card","identifier":"Jeehut.jpeg"},{"type":"icon","identifier":"Jeehut.jpeg"}],"kind":"article","abstract":[{"type":"text","text":"Spatial-first Indie Developer for  Platforms. Actively contributing to Open Source since 2011!"}],"url":"\/documentation\/wwdcnotes\/jeehut","title":"Cihat Gündüz (61 notes)","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/Jeehut","type":"topic"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10187-Meet-SwiftData":{"role":"sampleCode","kind":"article","abstract":[{"type":"text","text":"SwiftData is a powerful and expressive persistence framework built for Swift. We’ll show you how you can model your data directly from Swift code, use SwiftData to work with your models, and integrate with SwiftUI."}],"url":"\/documentation\/wwdcnotes\/wwdc23-10187-meet-swiftdata","title":"Meet SwiftData","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10187-Meet-SwiftData","type":"topic"},"https://fline.dev":{"titleInlineContent":[{"type":"text","text":"Blog"}],"title":"Blog","type":"link","identifier":"https:\/\/fline.dev","url":"https:\/\/fline.dev"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10149-Discover-Observation-in-SwiftUI":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10149-Discover-Observation-in-SwiftUI","role":"sampleCode","title":"Discover Observation in SwiftUI","abstract":[{"text":"Simplify your SwiftUI data models with Observation. We’ll share how the Observable macro can help you simplify models and improve your app’s performance. Get to know Observation, learn the fundamentals of the macro, and find out how to migrate from ObservableObject to Observable.","type":"text"}],"kind":"article","url":"\/documentation\/wwdcnotes\/wwdc23-10149-discover-observation-in-swiftui","type":"topic"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10189-Migrate-to-SwiftData":{"role":"sampleCode","url":"\/documentation\/wwdcnotes\/wwdc23-10189-migrate-to-swiftdata","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10189-Migrate-to-SwiftData","abstract":[{"text":"Discover how you can start using SwiftData in your apps. We’ll show you how to use Xcode to generate model classes from your existing Core Data object models, use SwiftData alongside your previous implementation, or even completely replace your existing solution.","type":"text"}],"type":"topic","title":"Migrate to SwiftData"},"Jeehut":{"alt":"Profile image of Cihat Gündüz","type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/Jeehut.jpeg"}],"identifier":"Jeehut"},"https://x.com/Jeehut":{"titleInlineContent":[{"type":"text","text":"X\/Twitter"}],"title":"X\/Twitter","type":"link","identifier":"https:\/\/x.com\/Jeehut","url":"https:\/\/x.com\/Jeehut"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"title":"Contributions are welcome!","type":"link","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"WWDC23-Icon.png":{"alt":null,"type":"image","variants":[{"url":"\/images\/WWDC23-Icon.png","traits":["1x","light"]}],"identifier":"WWDC23-Icon.png"},"WWDC23.jpeg":{"alt":null,"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/WWDC23.jpeg"}],"identifier":"WWDC23.jpeg"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10196-Dive-deeper-into-SwiftData":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10196-Dive-deeper-into-SwiftData","type":"topic","title":"Dive deeper into SwiftData","url":"\/documentation\/wwdcnotes\/wwdc23-10196-dive-deeper-into-swiftdata","kind":"article","role":"sampleCode","abstract":[{"text":"Learn how you can harness the power of SwiftData in your app. Find out how ModelContext and ModelContainer work together to persist your app’s data. We’ll show you how to track and make your changes manually and use SwiftData at scale with FetchDescriptor, SortDescriptor, and enumerate.","type":"text"}]},"WWDCNotes.png":{"alt":null,"type":"image","variants":[{"url":"\/images\/WWDCNotes.png","traits":["1x","light"]}],"identifier":"WWDCNotes.png"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23-10154-Build-an-app-with-SwiftData":{"role":"sampleCode","kind":"article","abstract":[{"type":"text","text":"Discover how SwiftData can help you persist data in your app. Code along with us as we bring SwiftData to a multi-platform SwiftUI app. Learn how to convert existing model classes into SwiftData models, set up the environment, reflect model layer changes in UI, and build document-based applications backed by SwiftData storage."}],"url":"\/documentation\/wwdcnotes\/wwdc23-10154-build-an-app-with-swiftdata","title":"Build an app with SwiftData","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23-10154-Build-an-app-with-SwiftData","type":"topic"},"Jeehut.jpeg":{"alt":null,"type":"image","variants":[{"traits":["1x","light"],"url":"\/images\/Jeehut.jpeg"}],"identifier":"Jeehut.jpeg"},"https://github.com/Jeehut":{"titleInlineContent":[{"type":"text","text":"GitHub"}],"title":"GitHub","type":"link","identifier":"https:\/\/github.com\/Jeehut","url":"https:\/\/github.com\/Jeehut"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC23":{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC23","role":"collectionGroup","title":"WWDC23","abstract":[{"text":"Xcode 15, Swift 5.9, iOS 17, macOS 14 (Sonoma), tvOS 17, visionOS 1, watchOS 10.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"type":"codeVoice","code":"SwiftData"},{"text":", ","type":"text"},{"type":"codeVoice","code":"Observation"},{"text":", ","type":"text"},{"type":"codeVoice","code":"StoreKit"},{"text":" views, and more.","type":"text"}],"kind":"article","url":"\/documentation\/wwdcnotes\/wwdc23","images":[{"identifier":"WWDC23-Icon.png","type":"icon"},{"identifier":"WWDC23.jpeg","type":"card"}],"type":"topic"},"https://developer.apple.com/wwdc23/10195":{"type":"download","checksum":null,"identifier":"https:\/\/developer.apple.com\/wwdc23\/10195","url":"https:\/\/developer.apple.com\/wwdc23\/10195"},"doc://WWDCNotes/documentation/WWDCNotes":{"type":"topic","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","kind":"symbol","url":"\/documentation\/wwdcnotes","abstract":[{"text":"Session notes shared by the community for the community.","type":"text"}],"title":"WWDC Notes","images":[{"type":"icon","identifier":"WWDCNotes.png"}],"role":"collection"}}}