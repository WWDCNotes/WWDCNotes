{"metadata":{"title":"Sharing code between iOS and OS X","role":"sampleCode","modules":[{"name":"WWDC Notes"}],"roleHeading":"WWDC14"},"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC14"]]},"sections":[],"sampleCodeDownload":{"action":{"identifier":"http:\/\/developer.apple.com\/wwdc14\/233","overridingTitle":"Watch Video","isActive":true,"type":"reference"},"kind":"sampleDownload"},"identifier":{"url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC14-233-Sharing-code-between-iOS-and-OS-X","interfaceLanguage":"swift"},"kind":"article","abstract":[{"type":"text","text":"Learn what the iWork engineers did to ship iWork for iOS and Mac from a single codebase. Explore the patterns for sharing code between desktop and mobile, and see how you can optimize your code and write great apps."}],"primaryContentSections":[{"content":[{"anchor":"What-code-can-we-share","type":"heading","text":"What code can we share?","level":2},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"✅ model code: no conversion nor data loss when shared across platform"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"❌ view code: different gestures, HIG, display size, flows"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"❓ controller code: it depends on the kind of controllers"}]}]}],"type":"unorderedList"},{"anchor":"Why-not-shared-view-code","type":"heading","text":"Why not shared view code","level":3},{"type":"paragraph","inlineContent":[{"type":"text","text":"We could use shimming:"}]},{"syntax":"objc","code":["#if TARGET_OS_IPHONE","@interface MyAwesomeView : UIView","#else","@interface MyAwesomeView : NSView","#endif","{","  ...","} @end"],"type":"codeListing"},{"inlineContent":[{"text":"However ","type":"text"},{"code":"UIView","type":"codeVoice"},{"text":" and ","type":"text"},{"code":"NSView","type":"codeVoice"},{"text":" have many different API and behaviors:","type":"text"}],"type":"paragraph"},{"rows":[[[{"inlineContent":[{"code":"UIView","type":"codeVoice"}],"type":"paragraph"}],[{"inlineContent":[{"type":"codeVoice","code":"NSView"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"Receives and handles events","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Receives and handles events"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"Responsible for drawing"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Responsible for drawing"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"Always backed by Core Animation"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Layer-backed views optional"}],"type":"paragraph"}]],[[{"inlineContent":[{"text":"Layer Origin in top left","type":"text"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Origin in bottom left","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"Subviews can draw outside view bounds"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Subviews clip to view bounds"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"Gesture Recognizers"}],"type":"paragraph"}],[{"inlineContent":[{"text":"Mouse event handling","type":"text"}],"type":"paragraph"}]],[[{"inlineContent":[{"type":"text","text":"Animation APIs"}],"type":"paragraph"}],[{"inlineContent":[{"type":"text","text":"Drag and Drop"}],"type":"paragraph"}]],[[{"inlineContent":[],"type":"paragraph"}],[{"inlineContent":[{"text":"Tooltip support","type":"text"}],"type":"paragraph"}]]],"header":"row","type":"table"},{"inlineContent":[{"type":"text","text":"Cons:"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"text":"Commonly breaks builds","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Hard to target fixes","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Requires ","type":"text"},{"code":"#if TARGET_OS_IPHONE","type":"codeVoice"},{"text":" by design","type":"text"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Hard to read","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Hard to maintain"}],"type":"paragraph"}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"inlineContent":[{"type":"text","text":"Behaviors and UI will take on the look of the original (development) platform by default."}],"type":"paragraph"},{"text":"Why sharing controller code has not a definitive answer","anchor":"Why-sharing-controller-code-has-not-a-definitive-answer","type":"heading","level":3},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Similar to views, we cannot share view controllers that handle user interactions, hotkeys, mouse handling."}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"We can share common controller logic and model controllers:"}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"split the view controller in various components"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"share only what can be shared"}]}]}]}]}],"type":"unorderedList"},{"text":"Using Frameworks to share more code Shared rendering","anchor":"Using-Frameworks-to-share-more-code-Shared-rendering","type":"heading","level":2},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"code":"NSView","type":"codeVoice"},{"type":"text","text":" has a "},{"type":"reference","identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsview\/1483532-isflipped","isActive":true},{"type":"text","text":" property that you can use to have the same core graphics coordinates as in iOS (origin on top left corner)"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Create an image wrapper around ","type":"text"},{"type":"codeVoice","code":"UIImage"},{"text":" and ","type":"text"},{"type":"codeVoice","code":"NSImage"},{"text":" so that you can grab and share the same ","type":"text"},{"text":"CoreGraphics","type":"text"},{"type":"text","text":" image model on both platforms (accessed via "},{"code":"UIImage","type":"codeVoice"},{"type":"text","text":" and "},{"code":"NSImage","type":"codeVoice"},{"type":"text","text":" "},{"isActive":true,"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsbitmapimagerep\/1395506-cgimage","type":"reference"},{"type":"text","text":" property.)"}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Use this kind of wrappers for just simple objects, not view controllers","type":"text"}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"},{"text":"Performance","anchor":"Performance","type":"heading","level":2},{"inlineContent":[{"text":"As different platforms have different resources available, creating a cross-platform app is also a great opportunity for performance improvements.","type":"text"}],"type":"paragraph"},{"inlineContent":[{"text":"Lazily loaded model:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Make sure that sections of model are self-contained","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Only load what the user needs","type":"text"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Load in parallel","type":"text"}]}]}],"type":"unorderedList"},{"inlineContent":[{"text":"This kind of gains results in faster opening of documents that benefit all platforms.","type":"text"}],"type":"paragraph"},{"text":"Data versioning","anchor":"Data-versioning","type":"heading","level":2},{"inlineContent":[{"text":"Users will not update all apps at the same time, make sure old versions of the app can still open data models created in newer versions, and viceversa.","type":"text"}],"type":"paragraph"},{"text":"Cross-platform projects in Xcode","anchor":"Cross-platform-projects-in-Xcode","type":"heading","level":2},{"text":"Targets","anchor":"Targets","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"Create a separate target for each platform."}],"type":"paragraph"},{"inlineContent":[{"text":"A target:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Defines a single product to build"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"Organizes inputs into build system"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Is owned by projects ("},{"type":"text","text":".xcodeproj"},{"type":"text","text":")"}]}]}],"type":"unorderedList"},{"text":"Libraries","anchor":"Libraries","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"Use libraries for shared code."}],"type":"paragraph"},{"inlineContent":[{"type":"text","text":"Static libraries are:"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Built with the project","type":"text"}]}]},{"content":[{"inlineContent":[{"text":"Included as part of the executable","type":"text"}],"type":"paragraph"}]}],"type":"unorderedList"},{"inlineContent":[{"text":"Dynamic libraries are:","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Optionally built with the project (no need to build them again until you change them)"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Excluded from the executable (they’re another mach-O file in your app package)"}]}]}],"type":"unorderedList"},{"text":"Configuration files","anchor":"Configuration-files","type":"heading","level":3},{"inlineContent":[{"type":"text","text":"Use Xcode Configuration Files for different targets. See what you can set here in the "},{"identifier":"https:\/\/developer.apple.com\/library\/archive\/documentation\/DeveloperTools\/Reference\/XcodeBuildSettingRef\/1-Build_Setting_Reference\/build_setting_ref.html","type":"reference","isActive":true},{"type":"text","text":"."}],"type":"paragraph"},{"inlineContent":[{"text":"Used Xcode Configuration inheritance to share common configurations among platforms:","type":"text"}],"type":"paragraph"},{"syntax":null,"code":["\/\/ In the iOS specific .xcconfig","#include \"Common.xcconfig\"","..."],"type":"codeListing"},{"text":"Written By","anchor":"Written-By","type":"heading","level":2},{"columns":[{"size":1,"content":[{"inlineContent":[{"identifier":"zntfdr","type":"image"}],"type":"paragraph"}]},{"size":4,"content":[{"level":3,"anchor":"Federico-Zanetello","type":"heading","text":"Federico Zanetello"},{"type":"paragraph","inlineContent":[{"overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}],"overridingTitle":"Contributed Notes","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","type":"reference","isActive":true},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/github.com\/zntfdr","type":"reference","isActive":true},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/zntfdr.dev","type":"reference","isActive":true}]}]}],"numberOfColumns":5,"type":"row"},{"inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","isActive":true,"type":"reference"}],"type":"paragraph"},{"inlineContent":[{"inlineContent":[{"type":"text","text":"Legal Notice"}],"type":"strong"}],"type":"small"},{"inlineContent":[{"text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}],"type":"small"}],"kind":"content"}],"schemaVersion":{"major":0,"patch":0,"minor":3},"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc14-233-sharing-code-between-ios-and-os-x"],"traits":[{"interfaceLanguage":"swift"}]}],"references":{"https://zntfdr.dev":{"identifier":"https:\/\/zntfdr.dev","url":"https:\/\/zntfdr.dev","type":"link","titleInlineContent":[{"type":"text","text":"Blog"}],"title":"Blog"},"https://developer.apple.com/documentation/appkit/nsbitmapimagerep/1395506-cgimage":{"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsbitmapimagerep\/1395506-cgimage","url":"https:\/\/developer.apple.com\/documentation\/appkit\/nsbitmapimagerep\/1395506-cgimage","type":"link","titleInlineContent":[{"code":"cgImage","type":"codeVoice"}],"title":"cgImage"},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"titleInlineContent":[{"type":"text","text":"Contributions are welcome!"}],"url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","title":"Contributions are welcome!","type":"link","identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"zntfdr.jpeg":{"alt":null,"variants":[{"url":"\/images\/zntfdr.jpeg","traits":["1x","light"]}],"type":"image","identifier":"zntfdr.jpeg"},"https://developer.apple.com/library/archive/documentation/DeveloperTools/Reference/XcodeBuildSettingRef/1-Build_Setting_Reference/build_setting_ref.html":{"identifier":"https:\/\/developer.apple.com\/library\/archive\/documentation\/DeveloperTools\/Reference\/XcodeBuildSettingRef\/1-Build_Setting_Reference\/build_setting_ref.html","url":"https:\/\/developer.apple.com\/library\/archive\/documentation\/DeveloperTools\/Reference\/XcodeBuildSettingRef\/1-Build_Setting_Reference\/build_setting_ref.html","type":"link","titleInlineContent":[{"type":"text","text":"Build Setting Reference guide"}],"title":"Build Setting Reference guide"},"doc://WWDCNotes/documentation/WWDCNotes/zntfdr":{"kind":"article","url":"\/documentation\/wwdcnotes\/zntfdr","type":"topic","images":[{"identifier":"zntfdr.jpeg","type":"card"},{"identifier":"zntfdr.jpeg","type":"icon"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/zntfdr","title":"Federico Zanetello (332 notes)","abstract":[{"text":"Software engineer with a strong passion for well-written code, thought-out composable architectures, automation, tests, and more.","type":"text"}],"role":"sampleCode"},"https://developer.apple.com/documentation/appkit/nsview/1483532-isflipped":{"identifier":"https:\/\/developer.apple.com\/documentation\/appkit\/nsview\/1483532-isflipped","url":"https:\/\/developer.apple.com\/documentation\/appkit\/nsview\/1483532-isflipped","type":"link","titleInlineContent":[{"code":"isFlipped","type":"codeVoice"}],"title":"isFlipped"},"WWDCNotes.png":{"alt":null,"variants":[{"url":"\/images\/WWDCNotes.png","traits":["1x","light"]}],"type":"image","identifier":"WWDCNotes.png"},"zntfdr":{"alt":"Profile image of Federico Zanetello","variants":[{"url":"\/images\/zntfdr.jpeg","traits":["1x","light"]}],"type":"image","identifier":"zntfdr"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC14":{"images":[{"type":"icon","identifier":"WWDC14-Icon.png"},{"type":"card","identifier":"WWDC14.jpeg"}],"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC14","role":"collectionGroup","kind":"article","title":"WWDC14","type":"topic","url":"\/documentation\/wwdcnotes\/wwdc14","abstract":[{"type":"text","text":"Xcode 6, Swift 1.0, iOS 8, macOS 10.10 (Yosemite)."}]},"http://developer.apple.com/wwdc14/233":{"identifier":"http:\/\/developer.apple.com\/wwdc14\/233","checksum":null,"url":"http:\/\/developer.apple.com\/wwdc14\/233","type":"download"},"https://github.com/zntfdr":{"title":"GitHub","url":"https:\/\/github.com\/zntfdr","titleInlineContent":[{"text":"GitHub","type":"text"}],"type":"link","identifier":"https:\/\/github.com\/zntfdr"},"WWDC14.jpeg":{"variants":[{"traits":["1x","light"],"url":"\/images\/WWDC14.jpeg"}],"identifier":"WWDC14.jpeg","alt":null,"type":"image"},"WWDC14-Icon.png":{"identifier":"WWDC14-Icon.png","type":"image","alt":null,"variants":[{"traits":["1x","light"],"url":"\/images\/WWDC14-Icon.png"}]},"doc://WWDCNotes/documentation/WWDCNotes":{"title":"WWDC Notes","url":"\/documentation\/wwdcnotes","type":"topic","images":[{"identifier":"WWDCNotes.png","type":"icon"}],"abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"role":"collection","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","kind":"symbol"}}}