{"kind":"article","metadata":{"roleHeading":"WWDC19","title":"Introducing Multi-Camera Capture for iOS","modules":[{"name":"WWDC Notes"}],"role":"sampleCode"},"sections":[],"abstract":[{"type":"text","text":"In AVCapture on iOS 13 it is now possible to simultaneously capture photos and video from multiple cameras on iPhone XS, iPhone XS Max, iPhone XR, and the latest iPad Pro. It is also possible to configure the multiple microphones on the device to shape the sound that is captured. Learn how to leverage these powerful capabilities to bring creative new features like picture-in-picture and spatial audio to your camera apps. Gain a deeper understanding of the performance considerations that may influence your app design."}],"hierarchy":{"paths":[["doc:\/\/WWDCNotes\/documentation\/WWDCNotes","doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19"]]},"schemaVersion":{"major":0,"patch":0,"minor":3},"identifier":{"interfaceLanguage":"swift","url":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19-249-Introducing-MultiCamera-Capture-for-iOS"},"variants":[{"paths":["\/documentation\/wwdcnotes\/wwdc19-249-introducing-multicamera-capture-for-ios"],"traits":[{"interfaceLanguage":"swift"}]}],"primaryContentSections":[{"kind":"content","content":[{"anchor":"overview","type":"heading","level":2,"text":"Overview"},{"items":[{"content":[{"inlineContent":[{"type":"text","text":"Supported on iPhone "},{"type":"codeVoice","code":"XS, XS Max, XR, iPad Pro 3rd Gen"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"text":"AVCaptureMultiCamSession","type":"text"}]}],"type":"paragraph"},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"Multiple "},{"code":"AVCaptureDeiceInputs","type":"codeVoice"},{"type":"text","text":", "},{"code":"AVCaptureDeiceOutputs","type":"codeVoice"},{"type":"text","text":" of the same type, "},{"code":"AVCaptureVideoPreviewLayers","type":"codeVoice"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"Don’t use implicit connection forming but use ","type":"text"},{"type":"codeVoice","code":"addInputWithNoConnections"},{"text":", ","type":"text"},{"type":"codeVoice","code":"addOutputWithNoConnections"},{"text":" or ","type":"text"},{"type":"codeVoice","code":"AVCaptureVideoPreviewLayer.setSessionWithNoConnection"}]}]}]}]},{"content":[{"inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"AVCaptureSession"}]},{"type":"text","text":" is still the way to got for single cam session"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"Simultaneous photo shooting, movie recording, barcode scanning, etc.","type":"text"}]}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Limitiations"}]}]},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"only one input per camera in a session"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"connecting one camera to multiple video data outouts is not possible","type":"text"}]}]},{"content":[{"inlineContent":[{"type":"text","text":"no presets supported on session since different cams might run with different qualities"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"text","text":"multi-cam session has "},{"type":"codeVoice","code":"hardwareCost"},{"type":"text","text":" reporting. Session runnable when "},{"type":"codeVoice","code":"0 <= cost <= 1"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"lower cost by ","type":"text"},{"code":"lower resolution","type":"codeVoice"},{"text":", ","type":"text"},{"code":"choose binned format","type":"codeVoice"},{"text":", ","type":"text"},{"code":"deviceInput.videoMinFrameDurationOverride = CMTimeMake(1, 30) to set max framerate override \/* 30 FPS *\/","type":"codeVoice"}]}]},{"content":[{"inlineContent":[{"text":"lower system pressure like ","type":"text"},{"code":"temperature, power demands, infrared projector temperature","type":"codeVoice"},{"text":" by","type":"text"}],"type":"paragraph"},{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"lowering frame rates, throttle GPU\/CPU processing code, disable one camera","type":"text"}]}]}],"type":"unorderedList"}]}],"type":"unorderedList"}]},{"content":[{"items":[{"content":[{"type":"paragraph","inlineContent":[{"text":"run indefinitely with ","type":"text"},{"code":"multiSession.systemPressureCost < 1.0","type":"codeVoice"},{"text":"; device shutdown with ","type":"text"},{"code":"cost > 3.0","type":"codeVoice"}]}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"iOS can run only one session at a time (with mutli cams though)","type":"text"}]}]}],"type":"unorderedList"}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Virtual Camera"}],"type":"strong"},{"type":"text","text":" is the new name wor software cameras like "},{"type":"codeVoice","code":"True-Tone- or Dual-Camera"}]}]},{"content":[{"inlineContent":[{"type":"codeVoice","code":"device.isVirtualDevice"},{"type":"text","text":" - get its physical devices by "},{"type":"codeVoice","code":"device.constituentDevices"},{"type":"text","text":" for e.g. synchronized camera streaming"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"AVCaptureDataOutputSynchronizer"},{"type":"text","text":" ensures you get two outputs in one callback"}]}]},{"content":[{"inlineContent":[{"text":"virtual devices have ","type":"text"},{"inlineContent":[{"text":"secret ports","type":"text"}],"type":"strong"},{"text":" so you can get 2 streams - you need to explicitly query them","type":"text"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"type":"strong","inlineContent":[{"type":"text","text":"Dual Camera Hography Aids"}]}]},{"type":"unorderedList","items":[{"content":[{"type":"paragraph","inlineContent":[{"type":"codeVoice","code":"CameraIntrinsics"},{"type":"text","text":" (Optical center \/ focal length) and "},{"type":"codeVoice","code":"CameraExtrinsics"},{"type":"text","text":" (rotation matrix \/ translation vector for both wide- and tele cameras)"}]}]}]}]},{"content":[{"type":"paragraph","inlineContent":[{"inlineContent":[{"type":"text","text":"Multi-Microphone capture"}],"type":"strong"}]},{"type":"unorderedList","items":[{"content":[{"inlineContent":[{"type":"text","text":"By default front cam uses "},{"type":"codeVoice","code":"front mic"},{"type":"text","text":" and back cam uses "},{"type":"codeVoice","code":"back mic"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"actually "},{"code":"front mic","type":"codeVoice"},{"type":"text","text":" and "},{"code":"back mic","type":"codeVoice"},{"type":"text","text":" are a lie since different devices have multiple mics but not explicitly fron\/back ones. This is achieved by "},{"code":"Microphone Beam Forming","type":"codeVoice"},{"type":"text","text":" - done automatically by CoreAudio "},{"code":"micInput.ports(for: .audio, sourceDeviceType: micDevice.deviceType, sourceDevicePosition: .front).first","type":"codeVoice"}],"type":"paragraph"}]},{"content":[{"inlineContent":[{"type":"text","text":"Beam forming only works with built-in mics"}],"type":"paragraph"}]},{"content":[{"type":"paragraph","inlineContent":[{"text":"audio can be arbitrarily configured by creating custom ","type":"text"},{"code":"AVAudioSession","type":"codeVoice"}]}]}]}]}],"type":"unorderedList"},{"anchor":"Written-By","type":"heading","level":2,"text":"Written By"},{"type":"row","columns":[{"content":[{"type":"paragraph","inlineContent":[{"identifier":"Blackjacx","type":"image"}]}],"size":1},{"content":[{"type":"heading","level":3,"anchor":"Stefan-Herold","text":"Stefan Herold"},{"type":"paragraph","inlineContent":[{"identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/Blackjacx","overridingTitleInlineContent":[{"text":"Contributed Notes","type":"text"}],"isActive":true,"type":"reference","overridingTitle":"Contributed Notes"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/github.com\/Blackjacx","isActive":true,"type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/stherold.com","isActive":true,"type":"reference"},{"text":" ","type":"text"},{"text":"|","type":"text"},{"text":" ","type":"text"},{"identifier":"https:\/\/x.com\/blackjacxxx","isActive":true,"type":"reference"}]}],"size":4}],"numberOfColumns":5},{"type":"thematicBreak"},{"inlineContent":[{"text":"Missing anything? Corrections? ","type":"text"},{"isActive":true,"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"reference"}],"type":"paragraph"},{"anchor":"Related-Sessions","type":"heading","level":2,"text":"Related Sessions"},{"inlineContent":[{"type":"strong","inlineContent":[{"text":"Legal Notice","type":"text"}]}],"type":"small"},{"inlineContent":[{"text":"All content copyright © 2012 – 2024 Apple Inc. All rights reserved.","type":"text"},{"text":" ","type":"text"},{"text":"Swift, the Swift logo, Swift Playgrounds, Xcode, Instruments, Cocoa Touch, Touch ID, FaceID, iPhone, iPad, Safari, Apple Vision, Apple Watch, App Store, iPadOS, watchOS, visionOS, tvOS, Mac, and macOS are trademarks of Apple Inc., registered in the U.S. and other countries.","type":"text"},{"text":" ","type":"text"},{"text":"This website is not made by, affiliated with, nor endorsed by Apple.","type":"text"}],"type":"small"}]}],"sampleCodeDownload":{"kind":"sampleDownload","action":{"identifier":"https:\/\/developer.apple.com\/wwdc19\/249","isActive":true,"overridingTitle":"Watch Video (44 min)","type":"reference"}},"references":{"Blackjacx":{"identifier":"Blackjacx","type":"image","variants":[{"url":"\/images\/WWDCNotes\/Blackjacx.jpeg","traits":["1x","light"]}],"alt":"Profile image of Stefan Herold"},"https://x.com/blackjacxxx":{"url":"https:\/\/x.com\/blackjacxxx","type":"link","title":"X\/Twitter","titleInlineContent":[{"text":"X\/Twitter","type":"text"}],"identifier":"https:\/\/x.com\/blackjacxxx"},"Blackjacx.jpeg":{"identifier":"Blackjacx.jpeg","variants":[{"url":"\/images\/WWDCNotes\/Blackjacx.jpeg","traits":["1x","light"]}],"alt":null,"type":"image"},"WWDC19-Icon.png":{"identifier":"WWDC19-Icon.png","type":"image","variants":[{"url":"\/images\/WWDCNotes\/WWDC19-Icon.png","traits":["1x","light"]}],"alt":null},"https://wwdcnotes.com/documentation/wwdcnotes/contributing":{"url":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing","type":"link","title":"Contributions are welcome!","titleInlineContent":[{"text":"Contributions are welcome!","type":"text"}],"identifier":"https:\/\/wwdcnotes.com\/documentation\/wwdcnotes\/contributing"},"https://stherold.com":{"identifier":"https:\/\/stherold.com","title":"Blog","titleInlineContent":[{"type":"text","text":"Blog"}],"url":"https:\/\/stherold.com","type":"link"},"https://github.com/Blackjacx":{"identifier":"https:\/\/github.com\/Blackjacx","title":"GitHub","type":"link","titleInlineContent":[{"text":"GitHub","type":"text"}],"url":"https:\/\/github.com\/Blackjacx"},"doc://WWDCNotes/documentation/WWDCNotes":{"type":"topic","role":"collection","abstract":[{"type":"text","text":"Session notes shared by the community for the community."}],"images":[{"identifier":"WWDCNotes.png","type":"icon"}],"url":"\/documentation\/wwdcnotes","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes","title":"WWDC Notes","kind":"symbol"},"doc://WWDCNotes/documentation/WWDCNotes/WWDC19":{"title":"WWDC19","kind":"article","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/WWDC19","url":"\/documentation\/wwdcnotes\/wwdc19","role":"collectionGroup","type":"topic","abstract":[{"text":"Xcode 11, Swift 5.1, iOS 13, macOS 10.15 (Catalina), tvOS 13, watchOS 6.","type":"text"},{"text":" ","type":"text"},{"text":"New APIs: ","type":"text"},{"type":"codeVoice","code":"Combine"},{"text":", ","type":"text"},{"code":"Core Haptics","type":"codeVoice"},{"type":"text","text":", "},{"code":"Create ML","type":"codeVoice"},{"type":"text","text":", and more."}],"images":[{"type":"icon","identifier":"WWDC19-Icon.png"},{"type":"card","identifier":"WWDC19.jpeg"}]},"doc://WWDCNotes/documentation/WWDCNotes/Blackjacx":{"role":"sampleCode","kind":"article","images":[{"type":"card","identifier":"Blackjacx.jpeg"},{"type":"icon","identifier":"Blackjacx.jpeg"}],"type":"topic","title":"Stefan Herold (28 notes)","identifier":"doc:\/\/WWDCNotes\/documentation\/WWDCNotes\/Blackjacx","abstract":[{"type":"text","text":"iOS Engineer a.d. 2009 • iOS \/ OSX Enthusiast • WWDC19 • Passionate Mountainbiker"}],"url":"\/documentation\/wwdcnotes\/blackjacx"},"https://developer.apple.com/wwdc19/249":{"url":"https:\/\/developer.apple.com\/wwdc19\/249","type":"download","checksum":null,"identifier":"https:\/\/developer.apple.com\/wwdc19\/249"},"WWDC19.jpeg":{"identifier":"WWDC19.jpeg","variants":[{"url":"\/images\/WWDCNotes\/WWDC19.jpeg","traits":["1x","light"]}],"alt":null,"type":"image"},"WWDCNotes.png":{"type":"image","variants":[{"url":"\/images\/WWDCNotes\/WWDCNotes.png","traits":["1x","light"]}],"alt":null,"identifier":"WWDCNotes.png"}}}